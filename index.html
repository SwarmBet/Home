<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Golden Casino Audio Edition</title>
    <style>
        :root { --gold: #ffcc00; --felt: #1a472a; --bg: #0f0f0f; --glass: rgba(255, 255, 255, 0.1); }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; margin: 0; display: flex; justify-content: center; min-height: 100vh; }
        .casino-wrapper { width: 100%; max-width: 900px; background: radial-gradient(circle at center, var(--felt) 0%, #05140a 100%); margin: 20px; border-radius: 30px; border: 10px solid #2d1f16; box-shadow: 0 20px 60px rgba(0,0,0,0.8); padding: 25px; position: relative; }
        .shake { animation: shake 0.5s; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-10px); } 75% { transform: translateX(10px); } }
        header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 20px; border-bottom: 1px solid var(--glass); }
        .balance-card { background: linear-gradient(135deg, #222, #000); padding: 15px 30px; border-radius: 20px; border: 2px solid var(--gold); font-size: 28px; font-weight: bold; color: var(--gold); box-shadow: 0 0 20px rgba(255,204,0,0.2); }
        .btn-nav { background: var(--glass); color: white; margin: 5px; padding: 12px 20px; border-radius: 10px; cursor: pointer; border:none; font-weight:bold; }
        .btn-nav.active { background: var(--gold); color: black; }
        .btn-action { background: linear-gradient(to bottom, var(--gold), #b8860b); color: black; box-shadow: 0 4px 0 #7a5908; margin-top: 10px; padding: 12px 20px; border-radius: 10px; cursor: pointer; border:none; font-weight:bold; text-transform:uppercase; }
        .btn-action:active { transform: translateY(4px); box-shadow: none; }
        .btn-action:disabled { background: #555; box-shadow: none; color: #888; }
        .message-area { height: 50px; display: flex; align-items: center; justify-content: center; font-size: 1.3em; font-weight: bold; color: var(--gold); }
        .bj-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px; }
        .hand-box { background: rgba(0,0,0,0.3); padding: 15px; border-radius: 15px; border: 1px solid var(--glass); }
        .cards-display { display: flex; gap: 10px; justify-content: center; min-height: 120px; margin-top: 10px; }
        .card { width: 70px; height: 100px; background: white; color: black; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px; font-weight: bold; animation: cardIn 0.3s ease-out; }
        @keyframes cardIn { from { transform: translateY(-50px); opacity: 0; } }
        .wheel-box { position: relative; width: 280px; height: 280px; margin: 20px auto; border: 10px solid #2d1f16; border-radius: 50%; overflow: hidden; }
        .wheel-inner { width: 100%; height: 100%; background: conic-gradient(#27ae60 0deg 9.7deg, #e74c3c 9.7deg 19.4deg, #2c3e50 19.4deg 29.1deg, #e74c3c 29.1deg 38.8deg, #2c3e50 38.8deg 48.5deg, #e74c3c 48.5deg 58.2deg, #2c3e50 58.2deg 67.9deg, #e74c3c 67.9deg 77.6deg, #2c3e50 77.6deg 87.3deg, #e74c3c 87.3deg 97deg, #2c3e50 97deg 106.7deg, #e74c3c 106.7deg 116.4deg, #2c3e50 116.4deg 126.1deg, #e74c3c 126.1deg 135.8deg, #2c3e50 135.8deg 145.5deg, #e74c3c 145.5deg 155.2deg, #2c3e50 155.2deg 164.9deg, #e74c3c 164.9deg 174.6deg, #2c3e50 174.6deg 184.3deg, #e74c3c 184.3deg 194deg, #2c3e50 194deg 203.7deg, #e74c3c 203.7deg 213.4deg, #2c3e50 213.4deg 223.1deg, #e74c3c 223.1deg 232.8deg, #2c3e50 232.8deg 242.5deg, #e74c3c 242.5deg 252.2deg, #2c3e50 252.2deg 261.9deg, #e74c3c 261.9deg 271.6deg, #2c3e50 271.6deg 281.3deg, #e74c3c 281.3deg 291deg, #2c3e50 291deg 300.7deg, #e74c3c 300.7deg 310.4deg, #2c3e50 310.4deg 320.1deg, #e74c3c 320.1deg 329.8deg, #2c3e50 329.8deg 339.5deg, #e74c3c 339.5deg 349.2deg, #2c3e50 349.2deg 360deg); transition: transform 4s cubic-bezier(0.1, 0, 0.1, 1); }
        .pointer { position: absolute; top: 0; left: 50%; transform: translateX(-50%); width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent; border-top: 20px solid var(--gold); z-index: 10; }
        input { background: black; color: var(--gold); border: 1px solid var(--gold); padding: 8px; border-radius: 5px; width: 60px; text-align: center; }
        .hidden { display: none !important; }
    </style>
</head>
<body>

<div class="casino-wrapper" id="main-board">
    <header>
        <h2 style="margin:0">üé∞ GOLDEN STAKE</h2>
        <div class="balance-card">üí∞ <span id="balance">1000</span></div>
    </header>

    <div class="message-area" id="msg">Zapnƒõte hru!</div>

    <div class="game-nav">
        <button id="nav-bj" class="btn-nav active" onclick="setGame('bj')">Blackjack</button>
        <button id="nav-roulette" class="btn-nav" onclick="setGame('roulette')">Ruleta</button>
    </div>

    <div id="bj-ui">
        <div style="background: var(--glass); padding: 15px; border-radius: 15px;">
            S√°zka: <input type="number" id="bj-bet" value="50">
            <button class="btn-action" id="bj-start" onclick="bjStart()">Rozdat karty</button>
        </div>
        <div class="bj-grid">
            <div class="hand-box"><div>Dealer (<span id="d-val">?</span>)</div><div id="d-cards" class="cards-display"></div></div>
            <div class="hand-box"><div>Ty (<span id="p-val">0</span>)</div><div id="p-cards" class="cards-display"></div></div>
        </div>
        <div id="bj-actions" class="hidden" style="margin-top: 15px;">
            <button class="btn-action" onclick="bjPlay('hit')">HIT</button>
            <button class="btn-action" style="background:#ddd" onclick="bjPlay('stand')">STAND</button>
        </div>
    </div>

    <div id="roulette-ui" class="hidden">
        <div class="roulette-container">
            <div class="wheel-box"><div class="pointer"></div><div id="wheel" class="wheel-inner"></div></div>
            <div style="display: flex; justify-content: center; gap: 20px;">
                <div class="hand-box">ƒå√≠slo: <input type="number" id="r-num" value="7"><br>S√°zka: <input type="number" id="r-num-bet" value="10"><br><button class="btn-action" id="r-btn-n" onclick="rSpin('number')">Vsadit</button></div>
                <div class="hand-box">Barva: <select id="r-col" style="background:black; color:white; padding:5px;"><option value="red">ƒåerven√°</option><option value="black">ƒåern√°</option></select><br>S√°zka: <input type="number" id="r-col-bet" value="50"><br><button class="btn-action" id="r-btn-c" onclick="rSpin('color')">Vsadit</button></div>
            </div>
        </div>
    </div>
</div>

<script>
    // --- AUDIO GENER√ÅTOR (Syntetiz√°tor) ---
    const AudioCtx = window.AudioContext || window.webkitAudioContext;
    let audioCtx = null;

    function initAudio() { if (!audioCtx) audioCtx = new AudioCtx(); }

    function playSound(type) {
        initAudio();
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.connect(gain);
        gain.connect(audioCtx.destination);

        const now = audioCtx.currentTime;

        if (type === 'card') {
            osc.type = 'sine';
            osc.frequency.setValueAtTime(400, now);
            osc.frequency.exponentialRampToValueAtTime(800, now + 0.1);
            gain.gain.setValueAtTime(0.1, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
            osc.start(); osc.stop(now + 0.1);
        } else if (type === 'click') {
            osc.type = 'square';
            osc.frequency.setValueAtTime(150, now);
            gain.gain.setValueAtTime(0.05, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.05);
            osc.start(); osc.stop(now + 0.05);
        } else if (type === 'win') {
            osc.type = 'triangle';
            [523.25, 659.25, 783.99].forEach((f, i) => {
                const o = audioCtx.createOscillator();
                const g = audioCtx.createGain();
                o.type = 'triangle'; o.connect(g); g.connect(audioCtx.destination);
                o.frequency.setValueAtTime(f, now + i*0.1);
                g.gain.setValueAtTime(0.1, now + i*0.1);
                g.gain.exponentialRampToValueAtTime(0.01, now + i*0.1 + 0.3);
                o.start(now + i*0.1); o.stop(now + i*0.1 + 0.3);
            });
        } else if (type === 'lose') {
            osc.type = 'sawtooth';
            osc.frequency.setValueAtTime(110, now);
            osc.frequency.linearRampToValueAtTime(55, now + 0.4);
            gain.gain.setValueAtTime(0.1, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.4);
            osc.start(); osc.stop(now + 0.4);
        } else if (type === 'chip') {
            osc.type = 'sine';
            osc.frequency.setValueAtTime(1200, now);
            gain.gain.setValueAtTime(0.1, now);
            gain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
            osc.start(); osc.stop(now + 0.1);
        }
    }

    // --- LOGIKA HRY (Stejn√°, jen s vol√°n√≠m playSound) ---
    let chips = 1000;
    let playing = false;
    let deck = [], pHand = [], dHand = [], curBet = 0;
    const rOrder = [0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10, 5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26];

    function log(m, win = null) {
        const el = document.getElementById('msg');
        el.innerText = m;
        el.style.color = win === true ? '#76ff03' : (win === false ? '#ff5252' : '#ffcc00');
        if(win === true) playSound('win');
        if(win === false) { 
            playSound('lose');
            document.getElementById('main-board').classList.add('shake');
            setTimeout(() => document.getElementById('main-board').classList.remove('shake'), 500);
        }
    }

    function update() { document.getElementById('balance').innerText = chips; }

    function setGame(g) {
        if(playing) return;
        playSound('click');
        document.getElementById('bj-ui').classList.toggle('hidden', g !== 'bj');
        document.getElementById('roulette-ui').classList.toggle('hidden', g !== 'roulette');
        document.getElementById('nav-bj').classList.toggle('active', g === 'bj');
        document.getElementById('nav-roulette').classList.toggle('active', g === 'roulette');
    }

    async function bjStart() {
        let b = parseInt(document.getElementById('bj-bet').value);
        if(b > chips || b <= 0) return log("M√°≈° m√°lo ≈æeton≈Ø!", false);
        
        playSound('chip');
        playing = true; curBet = b; chips -= b; update();
        document.getElementById('bj-start').disabled = true;
        document.getElementById('d-cards').innerHTML = '';
        document.getElementById('p-cards').innerHTML = '';
        
        deck = []; 
        ['‚ô†','‚ô•','‚ô¶','‚ô£'].forEach(s => ['2','3','4','5','6','7','8','9','10','J','Q','K','A'].forEach(v => deck.push({v,s})));
        deck.sort(() => Math.random() - 0.5);

        pHand = [deck.pop(), deck.pop()];
        dHand = [deck.pop(), deck.pop()];
        
        await drawBJAnimated(false);
        document.getElementById('bj-actions').classList.remove('hidden');
        log("Tv≈Øj tah...");
    }

    async function drawBJAnimated(all) {
        const d = document.getElementById('d-cards'), p = document.getElementById('p-cards');
        d.innerHTML = ''; p.innerHTML = '';
        
        for(let i=0; i<pHand.length; i++) {
            const c = pHand[i];
            p.innerHTML += `<div class="card" style="color:${['‚ô•','‚ô¶'].includes(c.s)?'red':'black'}">${c.v}${c.s}</div>`;
            playSound('card');
            await new Promise(r => setTimeout(r, 200));
        }
        for(let i=0; i<dHand.length; i++) {
            const c = dHand[i];
            if(i === 1 && !all) d.innerHTML += `<div class="card" style="background:#222">?</div>`;
            else d.innerHTML += `<div class="card" style="color:${['‚ô•','‚ô¶'].includes(c.s)?'red':'black'}">${c.v}${c.s}</div>`;
            playSound('card');
            await new Promise(r => setTimeout(r, 200));
        }
        document.getElementById('p-val').innerText = getVal(pHand);
        document.getElementById('d-val').innerText = all ? getVal(dHand) : "?";
    }

    function getVal(h) {
        let s = 0, a = 0;
        h.forEach(c => { if(['J','Q','K'].includes(c.v)) s += 10; else if(c.v === 'A') { s += 11; a++; } else s += parseInt(c.v); });
        while(s > 21 && a > 0) { s -= 10; a--; }
        return s;
    }

    async function bjPlay(a) {
        if(a === 'hit') {
            pHand.push(deck.pop()); 
            const p = document.getElementById('p-cards');
            const c = pHand[pHand.length-1];
            p.innerHTML += `<div class="card" style="color:${['‚ô•','‚ô¶'].includes(c.s)?'red':'black'}">${c.v}${c.s}</div>`;
            playSound('card');
            document.getElementById('p-val').innerText = getVal(pHand);
            if(getVal(pHand) > 21) bjEnd(false, "P≈òET√ÅHL JSI!");
        } else {
            document.getElementById('bj-actions').classList.add('hidden');
            await drawBJAnimated(true);
            while(getVal(dHand) < 17) {
                await new Promise(r => setTimeout(r, 600));
                dHand.push(deck.pop()); 
                const d = document.getElementById('d-cards');
                const c = dHand[dHand.length-1];
                d.innerHTML += `<div class="card" style="color:${['‚ô•','‚ô¶'].includes(c.s)?'red':'black'}">${c.v}${c.s}</div>`;
                playSound('card');
                document.getElementById('d-val').innerText = getVal(dHand);
            }
            let ps = getVal(pHand), ds = getVal(dHand);
            if(ds > 21 || ps > ds) bjEnd(true, "V√ùHRA!");
            else if(ps < ds) bjEnd(false, "DEALER VYHR√ÅL");
            else bjEnd('draw', "REMIZA");
        }
    }

    function bjEnd(res, m) {
        if(res === true) chips += curBet * 2;
        if(res === 'draw') chips += curBet;
        update(); log(m, res === 'draw' ? null : res);
        playing = false;
        document.getElementById('bj-start').disabled = false;
    }

    let rRot = 0;
    function rSpin(t) {
        if(playing) return;
        let b = parseInt(document.getElementById(t === 'number' ? 'r-num-bet' : 'r-col-bet').value);
        if(b > chips || b <= 0) return log("Neplatn√° s√°zka", false);

        playSound('chip');
        playing = true; chips -= b; update();
        log("Toƒç√≠me...");

        const win = Math.floor(Math.random() * 37);
        const idx = rOrder.indexOf(win);
        const target = 360 - (idx * (360/37));
        rRot += (360 * 5) + (target - (rRot % 360));
        
        document.getElementById('wheel').style.transform = `rotate(${rRot}deg)`;

        // Cvak√°n√≠ rulety
        let clickInt = setInterval(() => playSound('click'), 150);
        setTimeout(() => clearInterval(clickInt), 3000);

        setTimeout(() => {
            playing = false;
            const col = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36].includes(win) ? 'red' : (win === 0 ? 'green' : 'black');
            let isW = false;
            if(t === 'number' && parseInt(document.getElementById('r-num').value) === win) { isW = true; chips += b * 36; }
            else if(t === 'color' && document.getElementById('r-col').value === col) { isW = true; chips += b * 2; }
            log(`Padla ${win} (${col})`, isW);
            update();
        }, 4000);
    }
</script>
</body>
</html>
