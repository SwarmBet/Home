<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SWARMBET ELITE | Online Casino 2026</title>
    
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <style>
        /* ========================================
           1. CSS STYLES - UI/UX DESIGN
           ========================================
        */
        :root {
            --gold: #ffb300;
            --gold-bright: #ffd700;
            --gold-glow: rgba(255, 179, 0, 0.4);
            --bg-deep: #050505;
            --bg-card: #0f0f0f;
            --bg-nav: #000000;
            --green: #27ae60;
            --red: #e74c3c;
            --text-main: #e0e0e0;
            --text-dim: #888888;
            --border: #1a1a1a;
            --font-main: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            outline: none;
        }

        body {
            background-color: var(--bg-deep);
            background-image: 
                radial-gradient(circle at 50% 0%, #0a1a0a 0%, transparent 50%),
                url('https://www.transparenttextures.com/patterns/carbon-fibre.png');
            color: var(--text-main);
            font-family: var(--font-main);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        /* Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #050505; }
        ::-webkit-scrollbar-thumb { background: #222; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--gold); }

        /* Navigation */
        nav {
            background: var(--bg-nav);
            height: 70px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 50px;
            border-bottom: 2px solid var(--gold);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        }

        .logo {
            font-size: 26px;
            font-weight: 900;
            color: var(--gold);
            letter-spacing: 2px;
            text-transform: uppercase;
            cursor: pointer;
            text-shadow: 0 0 10px var(--gold-glow);
        }

        .nav-links {
            display: flex;
            gap: 30px;
        }

        .nav-item {
            color: var(--text-dim);
            text-decoration: none;
            font-weight: bold;
            font-size: 14px;
            text-transform: uppercase;
            transition: var(--transition);
            cursor: pointer;
            position: relative;
        }

        .nav-item:hover, .nav-item.active {
            color: var(--gold);
        }

        .nav-item.active::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 2px;
            background: var(--gold);
        }

        .user-zone {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .balance-pill {
            background: #111;
            border: 1px solid var(--border);
            padding: 8px 18px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 900;
            color: var(--gold);
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
        }

        .btn-auth {
            background: var(--gold);
            color: #000;
            border: none;
            padding: 8px 20px;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn-auth:hover {
            background: var(--gold-bright);
            transform: scale(1.05);
        }

        /* Container & Layout */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px;
            width: 100%;
            flex: 1;
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Auth Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(5px);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .modal-card {
            background: var(--bg-card);
            width: 400px;
            padding: 40px;
            border-radius: 15px;
            border: 1px solid var(--border);
            text-align: center;
            box-shadow: 0 0 50px rgba(0,0,0,0.8);
        }

        .modal-card h2 {
            color: var(--gold);
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .input-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .input-group label {
            display: block;
            color: var(--text-dim);
            font-size: 12px;
            margin-bottom: 5px;
            text-transform: uppercase;
        }

        .input-group input {
            width: 100%;
            background: #000;
            border: 1px solid var(--border);
            padding: 12px;
            color: #fff;
            border-radius: 5px;
            transition: var(--transition);
        }

        .input-group input:focus {
            border-color: var(--gold);
            box-shadow: 0 0 10px var(--gold-glow);
        }

        .btn-main {
            width: 100%;
            background: var(--gold);
            color: #000;
            border: none;
            padding: 15px;
            font-weight: 900;
            text-transform: uppercase;
            cursor: pointer;
            border-radius: 5px;
            transition: var(--transition);
        }

        .btn-main:hover {
            background: var(--gold-bright);
            transform: translateY(-2px);
        }

        /* Games Grid */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .game-card {
            background: var(--bg-card);
            border-radius: 15px;
            border: 1px solid var(--border);
            overflow: hidden;
            transition: var(--transition);
            cursor: pointer;
            position: relative;
        }

        .game-card:hover {
            transform: translateY(-10px);
            border-color: var(--gold);
            box-shadow: 0 15px 30px rgba(0,0,0,0.6);
        }

        .game-img {
            height: 200px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .game-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(0deg, var(--bg-card) 10%, transparent 100%);
        }

        .game-info {
            padding: 20px;
        }

        .game-info h3 {
            color: #fff;
            margin-bottom: 10px;
            font-size: 20px;
        }

        .game-info p {
            color: var(--text-dim);
            font-size: 14px;
            line-height: 1.5;
        }

        .badge-live {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--red);
            color: #fff;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 900;
            text-transform: uppercase;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        /* Roulette UI */
        .roulette-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
        }

        .wheel-container {
            width: 100%;
            height: 140px;
            background: #000;
            border: 3px solid #1a1a1a;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            border-radius: 10px;
            box-shadow: inset 0 0 30px #000;
        }

        .wheel-track {
            display: flex;
            position: absolute;
            left: 0;
            will-change: transform;
        }

        .wheel-item {
            min-width: 80px;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 900;
            color: #fff;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .wheel-indicator {
            position: absolute;
            left: 50%;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--gold);
            z-index: 10;
            transform: translateX(-50%);
            box-shadow: 0 0 15px var(--gold);
        }

        .roulette-table {
            display: grid;
            grid-template-columns: 80px repeat(12, 1fr);
            grid-template-rows: repeat(3, 70px);
            gap: 5px;
            background: #0a0a0a;
            padding: 10px;
            border-radius: 8px;
            user-select: none;
        }

        .cell {
            background: #111;
            border: 1px solid #333;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            position: relative;
            transition: var(--transition);
        }

        .cell:hover {
            border-color: #fff;
            z-index: 5;
        }

        .cell.zero {
            grid-row: 1 / 4;
            background: var(--green);
        }

        .cell.red { background: var(--red); }
        .cell.black { background: #000; }

        .chip-display {
            position: absolute;
            width: 40px;
            height: 40px;
            background: radial-gradient(circle, #fff 0%, var(--gold) 100%);
            border: 2px dashed rgba(0,0,0,0.5);
            border-radius: 50%;
            color: #000;
            font-size: 10px;
            font-weight: 900;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
            animation: chipPop 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @keyframes chipPop {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .outside-bets {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            width: 100%;
            margin-top: 10px;
        }

        .outside-cell {
            background: #111;
            border: 1px solid #333;
            padding: 15px;
            text-align: center;
            text-transform: uppercase;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            position: relative;
            transition: var(--transition);
        }

        .outside-cell:hover { border-color: var(--gold); }

        .controls {
            display: flex;
            gap: 20px;
            align-items: center;
            margin-top: 20px;
            background: #0d0d0d;
            padding: 20px 40px;
            border-radius: 50px;
            border: 1px solid var(--border);
        }

        .bet-input {
            background: #000;
            border: 1px solid var(--border);
            padding: 12px;
            color: var(--gold);
            font-weight: 900;
            width: 120px;
            text-align: center;
            border-radius: 5px;
        }

        /* Coin Flip UI */
        .coinflip-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 50px;
            padding: 50px;
        }

        .coin-box {
            width: 200px;
            height: 200px;
            position: relative;
            perspective: 1000px;
        }

        .coin {
            width: 100%;
            height: 100%;
            position: absolute;
            transform-style: preserve-3d;
            transition: transform 3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .coin-side {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            font-weight: 900;
            border: 8px solid var(--gold-bright);
            box-shadow: 0 0 20px var(--gold-glow);
        }

        .coin-heads {
            background: radial-gradient(circle, #ffcc00, #996600);
            color: #fff;
        }

        .coin-tails {
            background: radial-gradient(circle, #333, #000);
            color: var(--gold);
            transform: rotateY(180deg);
        }

        .cf-bets {
            display: flex;
            gap: 30px;
        }

        .cf-bet-btn {
            padding: 20px 50px;
            background: #111;
            border: 2px solid #333;
            color: #fff;
            font-weight: bold;
            text-transform: uppercase;
            cursor: pointer;
            border-radius: 10px;
            transition: var(--transition);
        }

        .cf-bet-btn.active {
            border-color: var(--gold);
            box-shadow: 0 0 15px var(--gold-glow);
            background: #1a1500;
        }

        /* Discord Page */
        .discord-card {
            background: #2c2f33;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            max-width: 600px;
            margin: 50px auto;
            border-bottom: 5px solid #7289da;
        }

        .discord-card h2 { color: #fff; margin-bottom: 20px; }
        .discord-card p { color: #ccc; margin-bottom: 30px; }
        .btn-discord {
            background: #7289da;
            color: #fff;
            padding: 15px 40px;
            text-decoration: none;
            border-radius: 5px;
            font-weight: bold;
            display: inline-block;
            transition: var(--transition);
        }
        .btn-discord:hover { background: #5b70be; transform: scale(1.05); }

        /* Footer */
        footer {
            background: #000;
            padding: 50px;
            border-top: 1px solid var(--border);
            text-align: center;
            margin-top: auto;
        }

        .footer-logo { font-size: 20px; color: var(--gold); font-weight: 900; margin-bottom: 15px; }
        .footer-copy { color: #444; font-size: 12px; }

        /* Admin Panel */
        #admin-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(255,0,0,0.2);
            color: #ff5555;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            display: none;
            font-size: 10px;
            z-index: 100;
        }

        /* Notifications */
        .notification-container {
            position: fixed;
            top: 100px;
            right: 30px;
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .toast {
            background: #111;
            border-left: 5px solid var(--gold);
            padding: 15px 25px;
            color: #fff;
            border-radius: 5px;
            min-width: 250px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

    </style>
</head>
<body>

    <nav>
        <div class="logo" onclick="app.showPage('home')">SWARMBET</div>
        <div class="nav-links">
            <a class="nav-item active" id="nav-home" onclick="app.showPage('home')">Home</a>
            <a class="nav-item" id="nav-games" onclick="app.showPage('games')">Games</a>
            <a class="nav-item" id="nav-discord" onclick="app.showPage('discord')">Discord</a>
        </div>
        <div class="user-zone">
            <div id="logged-in-ui" style="display: none;">
                <div class="balance-pill">
                    <span id="user-balance">0.00</span>
                    <span style="color: #444">|</span>
                    <span style="font-size: 11px;">CHIPS</span>
                </div>
                <span id="user-name" style="margin-left: 15px; font-weight: bold; color: var(--gold);"></span>
                <span onclick="app.logout()" style="margin-left: 15px; cursor: pointer; font-size: 12px; color: var(--red);">Odhl√°sit</span>
            </div>
            <div id="logged-out-ui">
                <button class="btn-auth" onclick="app.openLogin()">Login / Register</button>
            </div>
        </div>
    </nav>

    <div class="container">
        
        <div id="page-home" class="page active">
            <div style="text-align: center; padding: 100px 0;">
                <h1 style="font-size: 60px; margin-bottom: 20px;">VYHRAJTE <span style="color:var(--gold)">V√çC</span></h1>
                <p style="color:var(--text-dim); font-size: 20px; max-width: 600px; margin: 0 auto 40px;">
                    V√≠tejte v nejpokroƒçilej≈°√≠m online casinu roku 2026. Provably fair hry, instantn√≠ v√Ωplaty a komunita na Discordu.
                </p>
                <button class="btn-main" style="width: 250px;" onclick="app.showPage('games')">Vstoupit do herny</button>
            </div>
        </div>

        <div id="page-games" class="page">
            <h2 style="color:var(--gold); margin-bottom: 30px; text-transform: uppercase;">V√Ωbƒõr her</h2>
            <div class="games-grid">
                <div class="game-card" onclick="app.showPage('roulette')">
                    <div class="badge-live">Live</div>
                    <div class="game-img" style="background-image: url('https://images.unsplash.com/photo-1596838132731-dd9d59044222?auto=format&fit=crop&q=80&w=800');">
                        <div class="game-overlay"></div>
                    </div>
                    <div class="game-info">
                        <h3>European Roulette</h3>
                        <p>Klasick√° evropsk√° ruleta s pln√Ωm spektrem s√°zek a plynulou animac√≠ kola.</p>
                    </div>
                </div>

                <div class="game-card" onclick="app.showPage('coinflip')">
                    <div class="game-img" style="background-image: url('https://images.unsplash.com/photo-1621504450181-5d356f63d3ee?auto=format&fit=crop&q=80&w=800');">
                        <div class="game-overlay"></div>
                    </div>
                    <div class="game-info">
                        <h3>3D Coin Flip</h3>
                        <p>Dvojn√°sobek nebo nic. Jednoduch√° a rychl√° hra zalo≈æen√° na hodu minc√≠.</p>
                    </div>
                </div>

                <div class="game-card" onclick="app.notify('Brzy k dispozici!', 'info')">
                    <div class="game-img" style="background-image: url('https://images.unsplash.com/photo-1518133835878-5a93cc3f89e5?auto=format&fit=crop&q=80&w=800');">
                        <div class="game-overlay"></div>
                    </div>
                    <div class="game-info">
                        <h3>Blackjack 21</h3>
                        <p>Porazte dealera. P≈ôipravujeme pro v√°s pr√©miov√© stoly s vysok√Ωmi limity.</p>
                    </div>
                </div>

                <div class="game-card" onclick="app.notify('Ve v√Ωvoji!', 'info')">
                    <div class="game-img" style="background-image: url('https://images.unsplash.com/photo-1614028674026-a65e31bfd27c?auto=format&fit=crop&q=80&w=800');">
                        <div class="game-overlay"></div>
                    </div>
                    <div class="game-info">
                        <h3>Space Crash</h3>
                        <p>Sledujte n√°sobitel a vyberte pen√≠ze vƒças, ne≈æ raketa exploduje.</p>
                    </div>
                </div>
            </div>
        </div>

        <div id="page-roulette" class="page">
            <div class="roulette-wrapper">
                <div class="wheel-container">
                    <div class="wheel-indicator"></div>
                    <div class="wheel-track" id="wheel-track"></div>
                </div>

                <h2 id="roulette-status" style="color:var(--gold); text-transform: uppercase; font-weight: 900;">P≈ôipravte s√°zky</h2>

                <div class="roulette-table" id="r-table-main">
                    </div>

                <div class="outside-bets">
                    <div class="outside-cell" onclick="gameRoulette.addOutsideBet('1-12')">1st 12</div>
                    <div class="outside-cell" onclick="gameRoulette.addOutsideBet('13-24')">2nd 12</div>
                    <div class="outside-cell" onclick="gameRoulette.addOutsideBet('25-36')">3rd 12</div>
                    <div class="outside-cell" onclick="gameRoulette.addOutsideBet('1-18')">1 to 18</div>
                    <div class="outside-cell" onclick="gameRoulette.addOutsideBet('even')">Even</div>
                    <div class="outside-cell" style="color:var(--red)" onclick="gameRoulette.addOutsideBet('red')">Red</div>
                    <div class="outside-cell" style="color:#666" onclick="gameRoulette.addOutsideBet('black')">Black</div>
                    <div class="outside-cell" onclick="gameRoulette.addOutsideBet('odd')">Odd</div>
                    <div class="outside-cell" onclick="gameRoulette.addOutsideBet('19-36')">19 to 36</div>
                </div>

                <div class="controls">
                    <div style="text-align: center;">
                        <span style="display: block; font-size: 10px; color: #555; text-transform: uppercase;">ƒå√°stka</span>
                        <input type="number" id="bet-amt-roulette" value="100" class="bet-input">
                    </div>
                    <button class="btn-main" style="width: 200px;" id="spin-btn" onclick="gameRoulette.spin()">Spin Wheel</button>
                    <button class="btn-main" style="width: 100px; background: #333; color: #fff;" onclick="gameRoulette.clearBets()">Smazat</button>
                </div>
            </div>
        </div>

        <div id="page-coinflip" class="page">
            <div class="coinflip-wrapper">
                <h2 style="color:var(--gold); font-size: 32px; text-transform: uppercase;">Coin Flip Battle</h2>
                
                <div class="coin-box">
                    <div class="coin" id="game-coin">
                        <div class="coin-side coin-heads">H</div>
                        <div class="coin-side coin-tails">T</div>
                    </div>
                </div>

                <div class="cf-bets">
                    <button class="cf-bet-btn active" id="btn-heads" onclick="gameCoinFlip.setChoice('heads')">Heads</button>
                    <button class="cf-bet-btn" id="btn-tails" onclick="gameCoinFlip.setChoice('tails')">Tails</button>
                </div>

                <div class="controls">
                    <input type="number" id="bet-amt-cf" value="100" class="bet-input">
                    <button class="btn-main" style="width: 200px;" onclick="gameCoinFlip.flip()">Hodit minc√≠</button>
                </div>
                
                <h3 id="cf-status" style="color: var(--gold-bright);">Vyberte stranu a vsaƒète!</h3>
            </div>
        </div>

        <div id="page-discord" class="page">
            <div class="discord-card">
                <div style="font-size: 50px; margin-bottom: 20px;">üí¨</div>
                <h2>P≈ôipojte se na n√°≈° Discord</h2>
                <p>Z√≠skejte p≈ô√≠stup k exkluzivn√≠m bonus≈Øm, daily giveaway akc√≠m a buƒète souƒç√°st√≠ komunity Swarmbet Elite.</p>
                <a href="https://discord.com" target="_blank" class="btn-discord">VSTOUPIT NA DISCORD</a>
                <div style="margin-top: 30px; font-size: 11px; color: #555;">5,234 aktivn√≠ch ƒçlen≈Ø online</div>
            </div>
        </div>

    </div>

    <footer>
        <div class="footer-logo">SWARMBET ELITE</div>
        <div class="footer-copy">
            &copy; 2026 Swarmbet Elite Global Operations. Hazard m≈Ø≈æe b√Ωt n√°vykov√Ω. Hrajte zodpovƒõdnƒõ.<br>
            Provably Fair System Verified.
        </div>
    </footer>

    <div class="modal-overlay" id="auth-modal">
        <div class="modal-card">
            <h2 id="modal-title">P≈ôihl√°≈°en√≠</h2>
            <div class="input-group">
                <label>U≈æivatelsk√© jm√©no</label>
                <input type="text" id="inp-user" placeholder="Zadejte jm√©no...">
            </div>
            <div class="input-group">
                <label>Heslo</label>
                <input type="password" id="inp-pass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            </div>
            <button class="btn-main" id="btn-submit-auth" onclick="app.processAuth()">Pokraƒçovat</button>
            <p id="auth-switch" onclick="app.toggleAuthMode()" style="margin-top: 20px; font-size: 13px; color: var(--gold); cursor: pointer;">
                Nem√°te √∫ƒçet? Zaregistrujte se.
            </p>
            <p id="auth-error" style="color: var(--red); font-size: 12px; margin-top: 10px;"></p>
        </div>
    </div>

    <div id="admin-btn" onclick="app.openAdmin()">ADMIN PANEL</div>
    <div class="notification-container" id="notif-box"></div>

    <script>
        // --- FIREBASE INITIALIZATION ---
        const firebaseConfig = {
            databaseURL: "https://casbss-c75a0-default-rtdb.europe-west1.firebasedatabase.app/"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // --- GLOBAL APP STATE ---
        const app = {
            currentUser: null,
            authMode: 'login', // 'login' or 'register'
            pages: ['home', 'games', 'roulette', 'coinflip', 'discord'],
            
            init() {
                // Persistent login check
                const savedUser = localStorage.getItem('casino_session');
                if (savedUser) {
                    this.verifyAndLogin(savedUser);
                }

                this.renderRouletteTable();
                this.initRouletteWheel();
                
                // Audio pre-loader (simulated)
                console.log("Casino System v2.6.0 Initialized...");
            },

            showPage(pageId) {
                this.pages.forEach(p => {
                    document.getElementById('page-' + p).classList.remove('active');
                    const nav = document.getElementById('nav-' + p);
                    if(nav) nav.classList.remove('active');
                });
                document.getElementById('page-' + pageId).classList.add('active');
                const activeNav = document.getElementById('nav-' + pageId);
                if(activeNav) activeNav.classList.add('active');
                window.scrollTo(0,0);
            },

            openLogin() {
                document.getElementById('auth-modal').style.display = 'flex';
                this.authMode = 'login';
                this.updateAuthUI();
            },

            toggleAuthMode() {
                this.authMode = (this.authMode === 'login' ? 'register' : 'login');
                this.updateAuthUI();
            },

            updateAuthUI() {
                const title = document.getElementById('modal-title');
                const btn = document.getElementById('btn-submit-auth');
                const switchTxt = document.getElementById('auth-switch');
                
                if(this.authMode === 'login') {
                    title.innerText = "P≈ôihl√°≈°en√≠";
                    btn.innerText = "Vstoupit";
                    switchTxt.innerText = "Nem√°te √∫ƒçet? Zaregistrujte se.";
                } else {
                    title.innerText = "Registrace";
                    btn.innerText = "Vytvo≈ôit √∫ƒçet";
                    switchTxt.innerText = "Ji≈æ m√°te √∫ƒçet? P≈ôihlaste se.";
                }
            },

            async processAuth() {
                const user = document.getElementById('inp-user').value.trim();
                const pass = document.getElementById('inp-pass').value.trim();
                const errBox = document.getElementById('auth-error');

                if(!user || !pass) {
                    errBox.innerText = "Vypl≈àte v≈°echna pole!";
                    return;
                }

                if(this.authMode === 'register') {
                    // Check if username exists
                    const snap = await db.ref('users/' + user).once('value');
                    if(snap.exists()) {
                        errBox.innerText = "U≈æivatel s t√≠mto jm√©nem ji≈æ existuje!";
                        return;
                    }

                    const userData = {
                        username: user,
                        password: pass,
                        balance: 1000,
                        role: 'player',
                        created: Date.now()
                    };

                    await db.ref('users/' + user).set(userData);
                    this.login(userData);
                } else {
                    const snap = await db.ref('users/' + user).once('value');
                    if(!snap.exists() || snap.val().password !== pass) {
                        errBox.innerText = "Nespr√°vn√© jm√©no nebo heslo!";
                        return;
                    }
                    this.login(snap.val());
                }
            },

            login(userData) {
                this.currentUser = userData;
                localStorage.setItem('casino_session', userData.username);
                document.getElementById('auth-modal').style.display = 'none';
                this.updateUserUI();
                this.notify("V√≠tejte zpƒõt, " + userData.username + "!", "success");
                
                // Admin check
                if(userData.role === 'admin') {
                    document.getElementById('admin-btn').style.display = 'block';
                }

                // Listen for balance changes
                db.ref('users/' + userData.username + '/balance').on('value', (snap) => {
                    this.currentUser.balance = snap.val();
                    document.getElementById('user-balance').innerText = this.currentUser.balance.toLocaleString();
                });
            },

            verifyAndLogin(username) {
                db.ref('users/' + username).once('value', (snap) => {
                    if(snap.exists()) {
                        this.login(snap.val());
                    } else {
                        localStorage.removeItem('casino_session');
                    }
                });
            },

            logout() {
                localStorage.removeItem('casino_session');
                location.reload();
            },

            updateUserUI() {
                document.getElementById('logged-out-ui').style.display = 'none';
                document.getElementById('logged-in-ui').style.display = 'flex';
                document.getElementById('user-name').innerText = this.currentUser.username;
            },

            notify(msg, type = 'gold') {
                const box = document.getElementById('notif-box');
                const t = document.createElement('div');
                t.className = 'toast';
                if(type === 'success') t.style.borderLeftColor = 'var(--green)';
                if(type === 'error') t.style.borderLeftColor = 'var(--red)';
                t.innerText = msg;
                box.appendChild(t);
                setTimeout(() => t.remove(), 4000);
            },

            openAdmin() {
                if(!this.currentUser || this.currentUser.role !== 'admin') return;
                const amt = prompt("Kolik chip≈Ø chce≈° p≈ôidat?");
                if(amt && !isNaN(amt)) {
                    db.ref('users/' + this.currentUser.username + '/balance').set(this.currentUser.balance + parseInt(amt));
                    this.notify("Chipy p≈ôid√°ny!", "success");
                }
            },

            // Roulette Logic
            renderRouletteTable() {
                const table = document.getElementById('r-table-main');
                table.innerHTML = '';
                
                // Zero
                const zero = document.createElement('div');
                zero.className = 'cell zero';
                zero.innerText = '0';
                zero.onclick = () => gameRoulette.addStraightBet(0);
                table.appendChild(zero);

                const reds = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
                
                // Standard numbers 1-36
                // Column based layout
                for(let col = 0; col < 12; col++) {
                    const colContainer = document.createElement('div');
                    colContainer.style.display = 'contents';
                    
                    for(let row = 3; row >= 1; row--) {
                        const num = col * 3 + row;
                        const cell = document.createElement('div');
                        const isRed = reds.includes(num);
                        cell.className = `cell ${isRed ? 'red' : 'black'}`;
                        cell.id = `cell-${num}`;
                        cell.innerText = num;
                        cell.onclick = () => gameRoulette.addStraightBet(num);
                        table.appendChild(cell);
                    }
                }
            },

            initRouletteWheel() {
                const track = document.getElementById('wheel-track');
                const sequence = [0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10, 5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26];
                const reds = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
                
                // Create multiple sets for smooth looping
                let html = "";
                for(let i = 0; i < 20; i++) {
                    sequence.forEach(num => {
                        let colorClass = num === 0 ? "item-green" : (reds.includes(num) ? "item-red" : "item-black");
                        html += `<div class="wheel-item ${colorClass}">${num}</div>`;
                    });
                }
                track.innerHTML = html;
            }
        };

        // --- GAME: ROULETTE ENGINE ---
        const gameRoulette = {
            bets: {}, // { "straight-0": 100, "red": 50 }
            isSpinning: false,
            wheelOrder: [0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10, 5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26],
            reds: [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36],

            addStraightBet(num) {
                this.placeBet("straight-" + num, "cell-" + num);
            },

            addOutsideBet(type) {
                this.placeBet(type, null); // Outside bets are handled differently visually
            },

            placeBet(betKey, cellId) {
                if(this.isSpinning) return;
                if(!app.currentUser) {
                    app.openLogin();
                    return;
                }

                const amt = parseInt(document.getElementById('bet-amt-roulette').value);
                if(isNaN(amt) || amt <= 0) {
                    app.notify("Neplatn√° ƒç√°stka s√°zky!", "error");
                    return;
                }

                if(app.currentUser.balance < amt) {
                    app.notify("Nedostateƒçn√Ω balance!", "error");
                    return;
                }

                // Update Local & DB Balance
                const newBal = app.currentUser.balance - amt;
                db.ref('users/' + app.currentUser.username + '/balance').set(newBal);

                // Add to bet set
                if(!this.bets[betKey]) this.bets[betKey] = 0;
                this.bets[betKey] += amt;

                // Visual Chip
                this.renderChip(betKey, cellId);
                this.playSound('chip');
            },

            renderChip(betKey, cellId) {
                let parent;
                if(cellId) {
                    parent = document.getElementById(cellId);
                    if(betKey === "straight-0") parent = document.querySelector('.cell.zero');
                } else {
                    // Search for outside bet cell by text
                    const cells = document.querySelectorAll('.outside-cell');
                    const normalizedKey = betKey.replace('-', ' to ');
                    cells.forEach(c => {
                        if(c.innerText.toLowerCase() === normalizedKey.toLowerCase() || 
                           c.innerText.toLowerCase() === betKey.toLowerCase()) {
                            parent = c;
                        }
                    });
                }

                if(!parent) return;

                let chip = parent.querySelector('.chip-display');
                if(!chip) {
                    chip = document.createElement('div');
                    chip.className = 'chip-display';
                    parent.appendChild(chip);
                }
                chip.innerText = this.bets[betKey];
            },

            clearBets() {
                if(this.isSpinning) return;
                
                // Refund all bets
                let total = 0;
                for(let key in this.bets) total += this.bets[key];
                
                if(total > 0) {
                    db.ref('users/' + app.currentUser.username + '/balance').set(app.currentUser.balance + total);
                }

                this.bets = {};
                document.querySelectorAll('.chip-display').forEach(c => c.remove());
                app.notify("S√°zky smaz√°ny a vr√°ceny.", "info");
            },

            async spin() {
                if(this.isSpinning) return;
                if(Object.keys(this.bets).length === 0) {
                    app.notify("Nejprve vsaƒète!", "error");
                    return;
                }

                this.isSpinning = true;
                document.getElementById('spin-btn').disabled = true;
                document.getElementById('roulette-status').innerText = "KOLO SE TOƒå√ç...";
                this.playSound('spin');

                // Determine Result (Server-side simulation)
                const winNum = this.wheelOrder[Math.floor(Math.random() * 37)];
                
                // Animation Logic
                const track = document.getElementById('wheel-track');
                const itemWidth = 80;
                const fullLap = 37 * itemWidth;
                const extraLaps = 5 + Math.floor(Math.random() * 5);
                
                const targetIdx = this.wheelOrder.indexOf(winNum);
                const stopPosition = (extraLaps * fullLap) + (targetIdx * itemWidth);
                
                track.style.transition = 'none';
                track.style.transform = `translateX(0)`;
                
                // Force Reflow
                track.offsetHeight;

                track.style.transition = 'transform 6s cubic-bezier(0.15, 0, 0.15, 1)';
                // We calculate the center offset
                const containerWidth = document.querySelector('.wheel-container').offsetWidth;
                const centerOffset = (containerWidth / 2) - (itemWidth / 2);
                
                track.style.transform = `translateX(-${stopPosition - centerOffset}px)`;

                setTimeout(() => {
                    this.resolve(winNum);
                }, 6500);
            },

            resolve(winNum) {
                let totalWin = 0;
                const isWinRed = this.reds.includes(winNum);
                const isWinEven = winNum !== 0 && winNum % 2 === 0;
                const isWinLow = winNum >= 1 && winNum <= 18;
                const isWinDoz1 = winNum >= 1 && winNum <= 12;
                const isWinDoz2 = winNum >= 13 && winNum <= 24;
                const isWinDoz3 = winNum >= 25 && winNum <= 36;

                for(let betKey in this.bets) {
                    const amt = this.bets[betKey];
                    let multiplier = 0;

                    if(betKey === "straight-" + winNum) multiplier = 36;
                    else if(betKey === "red" && isWinRed) multiplier = 2;
                    else if(betKey === "black" && !isWinRed && winNum !== 0) multiplier = 2;
                    else if(betKey === "even" && isWinEven) multiplier = 2;
                    else if(betKey === "odd" && !isWinEven && winNum !== 0) multiplier = 2;
                    else if(betKey === "1-18" && isWinLow) multiplier = 2;
                    else if(betKey === "19-36" && !isWinLow && winNum !== 0) multiplier = 2;
                    else if(betKey === "1-12" && isWinDoz1) multiplier = 3;
                    else if(betKey === "13-24" && isWinDoz2) multiplier = 3;
                    else if(betKey === "25-36" && isWinDoz3) multiplier = 3;

                    totalWin += amt * multiplier;
                }

                document.getElementById('roulette-status').innerText = "PADLO ƒå√çSLO: " + winNum;
                
                if(totalWin > 0) {
                    db.ref('users/' + app.currentUser.username + '/balance').set(app.currentUser.balance + totalWin);
                    app.notify("VYHR√ÅV√ÅTE " + totalWin.toLocaleString() + " CHIPS!", "success");
                    this.playSound('win');
                } else {
                    app.notify("≈Ω√°dn√° v√Ωhern√≠ s√°zka.", "error");
                    this.playSound('lose');
                }

                // Cleanup
                this.isSpinning = false;
                document.getElementById('spin-btn').disabled = false;
                this.bets = {};
                document.querySelectorAll('.chip-display').forEach(c => c.remove());
            },

            playSound(type) {
                // In a real app, load actual MP3s. Here we simulate.
                console.log("SFX: " + type);
            }
        };

        // --- GAME: COIN FLIP ENGINE ---
        const gameCoinFlip = {
            choice: 'heads',
            isFlipping: false,

            setChoice(side) {
                if(this.isFlipping) return;
                this.choice = side;
                document.getElementById('btn-heads').classList.remove('active');
                document.getElementById('btn-tails').classList.remove('active');
                document.getElementById('btn-' + side).classList.add('active');
            },

            async flip() {
                if(this.isFlipping) return;
                if(!app.currentUser) { app.openLogin(); return; }

                const amt = parseInt(document.getElementById('bet-amt-cf').value);
                if(isNaN(amt) || amt <= 0 || amt > app.currentUser.balance) {
                    app.notify("Neplatn√° s√°zka!", "error");
                    return;
                }

                this.isFlipping = true;
                document.getElementById('cf-status').innerText = "Mince ve vzduchu...";
                
                // Deduct Balance
                db.ref('users/' + app.currentUser.username + '/balance').set(app.currentUser.balance - amt);

                const coin = document.getElementById('game-coin');
                const result = Math.random() < 0.5 ? 'heads' : 'tails';
                
                // Animation degrees
                const baseSpin = 1800; // 5 full rotations
                const extraSpin = (result === 'tails' ? 180 : 0);
                const totalRotation = baseSpin + extraSpin;

                coin.style.transition = 'none';
                coin.style.transform = 'rotateY(0)';
                coin.offsetHeight; // trigger reflow
                
                coin.style.transition = 'transform 3s cubic-bezier(0.4, 0, 0.2, 1)';
                coin.style.transform = `rotateY(${totalRotation}deg)`;

                setTimeout(() => {
                    this.isFlipping = false;
                    if(this.choice === result) {
                        const win = amt * 2;
                        db.ref('users/' + app.currentUser.username + '/balance').set(app.currentUser.balance + win);
                        document.getElementById('cf-status').innerText = "V√çTƒöZSTV√ç! PADLO " + result.toUpperCase();
                        app.notify("Vyhr√°v√°te " + win + " chips!", "success");
                    } else {
                        document.getElementById('cf-status').innerText = "PROHRA. PADLO " + result.toUpperCase();
                        app.notify("Zkuste to znovu!", "error");
                    }
                }, 3100);
            }
        };

        // --- BOOTSTRAP ---
        window.onload = () => app.init();

    </script>
</body>
</html>
