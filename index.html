<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Golden Stake - Admin skibiditoilet</title>
    <style>
        body { background: #0a0a0a; color: white; font-family: 'Segoe UI', sans-serif; display: flex; justify-content: center; margin: 0; }
        .game-container { width: 450px; background: #1a1a1a; border: 4px solid #d4af37; border-radius: 20px; padding: 20px; margin-top: 20px; box-shadow: 0 0 50px rgba(0,0,0,0.8); }
        
        /* Auth System */
        #auth-box { text-align: center; padding: 20px; }
        input { background: #000; color: #ffd700; border: 1px solid #d4af37; padding: 10px; margin: 5px; border-radius: 5px; width: 85%; }
        .btn-gold { background: #d4af37; border: none; padding: 10px 20px; border-radius: 5px; font-weight: bold; cursor: pointer; color: black; transition: 0.2s; }
        .btn-gold:hover { background: #fff; }
        .btn-gold:disabled { background: #555; color: #888; cursor: not-allowed; }

        /* Game UI */
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 15px; }
        .balance { font-size: 24px; color: #ffd700; font-weight: bold; }
        .hidden { display: none !important; }
        
        /* Admin Console - Tajn√° */
        #admin-panel { margin-top: 20px; padding: 10px; border: 2px dashed #00ff00; background: rgba(0, 255, 0, 0.05); border-radius: 10px; }
        #admin-input { width: 90%; border: none; outline: none; background: #000; color: #0f0; padding: 8px; font-family: monospace; }
        
        /* Blackjack Visuals */
        .card-area { display: flex; justify-content: center; gap: 8px; min-height: 100px; margin: 10px 0; }
        .card { width: 60px; height: 90px; background: white; color: black; border-radius: 5px; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.5); }
        .status { text-align: center; color: #ffd700; margin: 10px 0; font-weight: bold; min-height: 24px; }
    </style>
</head>
<body>

<div class="game-container">
    <div id="auth-box">
        <h2 style="color: #d4af37;">GOLDEN STAKE</h2>
        <div id="auth-msg" style="margin-bottom:10px;">P≈ôihlas se nebo vytvo≈ô √∫ƒçet</div>
        <input type="text" id="username" placeholder="U≈æivatelsk√© jm√©no">
        <input type="password" id="password" placeholder="Heslo">
        <br><br>
        <button class="btn-gold" onclick="handleAuth('login')">P≈òIHL√ÅSIT</button>
        <button class="btn-gold" style="background:#444; color:white;" onclick="handleAuth('register')">REGISTROVAT</button>
    </div>

    <div id="game-box" class="hidden">
        <div class="header">
            <div id="user-display" style="color:#aaa; font-weight:bold;"></div>
            <div class="balance">üí∞ <span id="chips-val">0</span></div>
            <button onclick="logout()" style="background:none; border:none; color:#ff4444; cursor:pointer; font-weight:bold;">Odhl√°sit</button>
        </div>

        <div class="status" id="msg">P≈ôipraven ke h≈ôe?</div>

        <div id="bj-ui">
            <div id="bj-setup" style="text-align:center">
                S√°zka: <input type="number" id="bj-bet" value="10" style="width:70px; display:inline-block;">
                <button class="btn-gold" id="bj-start" onclick="bjStart()">ROZDAT</button>
            </div>

            <div id="cards-ui" class="hidden">
                <div style="text-align:center;">
                    <p>Dealer: <span id="d-val" style="color:#ff4444">?</span></p>
                    <div class="card-area" id="d-cards"></div>
                    <p>Ty: <span id="p-val" style="color:#44ff44">0</span></p>
                    <div class="card-area" id="p-cards"></div>
                </div>
                
                <div id="bj-actions" class="hidden" style="text-align:center; margin-top:15px;">
                    <button class="btn-gold" onclick="bjPlay('hit')">DAL≈†√ç KARTU (HIT)</button>
                    <button class="btn-gold" style="background:#eee" onclick="bjPlay('stand')">ST√ÅT (STAND)</button>
                </div>
            </div>
        </div>

        <div id="admin-panel" class="hidden">
            <div style="color:#0f0; font-size:12px; margin-bottom:5px; font-weight:bold;">üöΩ ADMIN PANEL (skibiditoilet)</div>
            <input type="text" id="admin-input" placeholder="p≈ô√≠kaz: /give jm√©no ƒç√°stka" onkeypress="checkAdminCommand(event)">
        </div>
    </div>
</div>

<script>
    // --- KONFIGURACE A DATA ---
    const ADMIN_NAME = "skibiditoilet"; 
    let currentUser = null;
    let users = JSON.parse(localStorage.getItem('casino_db')) || {};

    // --- SYST√âM √öƒåT≈Æ ---
    function handleAuth(type) {
        const u = document.getElementById('username').value.trim();
        const p = document.getElementById('password').value;

        if(!u || !p) return alert("Zadej jm√©no a heslo!");

        if(type === 'register') {
            if(users[u]) return alert("Tento u≈æivatel u≈æ existuje!");
            users[u] = { password: p, chips: 0 };
            saveData();
            alert("Registrace √∫spƒõ≈°n√°! Teƒè se p≈ôihlas.");
        } else {
            if(users[u] && users[u].password === p) {
                currentUser = u;
                loginSuccess();
            } else {
                alert("≈†patn√© jm√©no nebo heslo!");
            }
        }
    }

    function loginSuccess() {
        document.getElementById('auth-box').classList.add('hidden');
        document.getElementById('game-box').classList.remove('hidden');
        document.getElementById('user-display').innerText = "Hr√°ƒç: " + currentUser;
        
        // Zobrazen√≠ admin panelu pouze pro skibiditoilet
        if(currentUser === ADMIN_NAME) {
            document.getElementById('admin-panel').classList.remove('hidden');
        } else {
            document.getElementById('admin-panel').classList.add('hidden');
        }
        updateUI();
    }

    function logout() {
        currentUser = null;
        document.getElementById('auth-box').classList.remove('hidden');
        document.getElementById('game-box').classList.add('hidden');
        document.getElementById('username').value = "";
        document.getElementById('password').value = "";
    }

    function saveData() {
        localStorage.setItem('casino_db', JSON.stringify(users));
    }

    function updateUI() {
        if(currentUser) {
            document.getElementById('chips-val').innerText = users[currentUser].chips;
        }
    }

    // --- ADMIN GIVE SYST√âM ---
    function checkAdminCommand(e) {
        if(e.key === 'Enter') {
            const val = document.getElementById('admin-input').value;
            const parts = val.split(' '); // /give jmeno 100

            if(parts[0] === '/give' && parts.length === 3) {
                const target = parts[1];
                const amount = parseInt(parts[2]);

                if(users[target] && !isNaN(amount)) {
                    users[target].chips += amount;
                    saveData();
                    updateUI();
                    alert(`√öspƒõch! P≈ôid√°no ${amount} ≈æeton≈Ø u≈æivateli ${target}.`);
                } else {
                    alert("Chyba: U≈æivatel neexistuje nebo ≈°patn√° ƒç√°stka.");
                }
            } else {
                alert("Pou≈æij form√°t: /give jm√©no ƒç√°stka");
            }
            document.getElementById('admin-input').value = '';
        }
    }

    // --- BLACKJACK LOGIC (FIXED) ---
    let playing = false, curBet = 0, deck = [], pHand = [], dHand = [];

    async function bjStart() {
        curBet = parseInt(document.getElementById('bj-bet').value);
        if(curBet > users[currentUser].chips || curBet <= 0) return alert("Nem√°≈° dost ≈æeton≈Ø!");
        
        users[currentUser].chips -= curBet;
        playing = true;
        updateUI();
        saveData();

        document.getElementById('bj-start').disabled = true;
        document.getElementById('cards-ui').classList.remove('hidden');
        document.getElementById('bj-actions').classList.add('hidden');
        document.getElementById('msg').innerText = "Hra o " + curBet;
        
        deck = []; 
        ['‚ô†','‚ô•','‚ô¶','‚ô£'].forEach(s => ['2','3','4','5','6','7','8','9','10','J','Q','K','A'].forEach(v => deck.push({v,s})));
        deck.sort(() => Math.random() - 0.5);

        pHand = [deck.pop(), deck.pop()];
        dHand = [deck.pop(), deck.pop()];
        
        await renderBJ(false);

        if(getVal(pHand) === 21) {
            bjEnd(true, "BLACKJACK! üí∞");
        } else {
            document.getElementById('bj-actions').classList.remove('hidden');
        }
    }

    async function renderBJ(all) {
        const p = document.getElementById('p-cards'), d = document.getElementById('d-cards');
        p.innerHTML = ''; d.innerHTML = '';
        
        pHand.forEach(c => p.innerHTML += `<div class="card">${c.v}${c.s}</div>`);
        dHand.forEach((c, i) => {
            d.innerHTML += `<div class="card" style="${!all && i===1 ? 'background:#333; color:#333':''}">${!all && i===1 ? '?':c.v+c.s}</div>`;
        });

        document.getElementById('p-val').innerText = getVal(pHand);
        document.getElementById('d-val').innerText = all ? getVal(dHand) : "?";
    }

    function getVal(h) {
        let s = 0, a = 0;
        h.forEach(c => { 
            if(['J','Q','K'].includes(c.v)) s += 10; 
            else if(c.v === 'A') { s += 11; a++; } 
            else s += parseInt(c.v); 
        });
        while(s > 21 && a > 0) { s -= 10; a--; }
        return s;
    }

    async function bjPlay(a) {
        if(!playing) return;

        if(a === 'hit') {
            pHand.push(deck.pop());
            await renderBJ(false);
            if(getVal(pHand) > 21) {
                document.getElementById('bj-actions').classList.add('hidden'); // OKAM≈ΩITƒö SCHOVAT
                bjEnd(false, "P≈òET√ÅHL JSI (BUST)!");
            }
        } else {
            document.getElementById('bj-actions').classList.add('hidden');
            await renderBJ(true);
            
            while(getVal(dHand) < 17) {
                await new Promise(r => setTimeout(r, 600));
                dHand.push(deck.pop());
                await renderBJ(true);
            }
            
            let ps = getVal(pHand), ds = getVal(dHand);
            if(ds > 21 || ps > ds) bjEnd(true, "V√ùHRA!");
            else if(ps < ds) bjEnd(false, "PROHR√ÅL JSI");
            else bjEnd('draw', "REMIZA (PUSH)");
        }
    }

    function bjEnd(res, m) {
        playing = false;
        document.getElementById('bj-actions').classList.add('hidden');
        document.getElementById('bj-start').disabled = false;

        if(res === true) users[currentUser].chips += curBet * 2;
        if(res === 'draw') users[currentUser].chips += curBet;
        
        saveData();
        updateUI();
        document.getElementById('msg').innerText = m;
    }
</script>
</body>
</html>
