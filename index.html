 <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SwarmBet - Star Premium 2026</title>
    <style>
        :root { 
            --orange: #ff9900; 
            --dark: #0a0a0a; 
            --panel: #151515; 
            --green: #27ae60; 
            --red: #e74c3c; 
            --black: #2c3e50; 
            --gold: #f1c40f;
            --sidebar: #111111;
        }
        body { 
            background-color: var(--dark); 
            color: white; 
            font-family: 'Inter', 'Segoe UI', sans-serif; 
            margin: 0; 
            display: flex; 
            height: 100vh; 
            overflow: hidden;
            background-image: radial-gradient(circle at center, rgba(255, 153, 0, 0.03) 0%, transparent 80%);
        }

        /* Sidebar & Layout */
        .sidebar {
            width: 240px;
            background: var(--sidebar);
            border-right: 1px solid #222;
            display: flex;
            flex-direction: column;
            padding: 20px 0;
            flex-shrink: 0;
        }
        .logo { padding: 0 25px 30px; font-size: 24px; font-weight: 900; color: white; text-decoration: none; }
        .logo span { color: var(--orange); }

        .nav-item {
            padding: 12px 25px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: 0.2s;
            color: #888;
        }
        .nav-item:hover, .nav-item.active {
            background: rgba(255, 153, 0, 0.1);
            color: var(--orange);
            border-left: 3px solid var(--orange);
        }

        .main-wrapper { flex: 1; display: flex; flex-direction: column; overflow-y: auto; }
        .top-nav {
            height: 70px;
            background: #000;
            border-bottom: 2px solid var(--orange);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding: 0 40px;
            gap: 20px;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .balance-box {
            background: #1a1a1a;
            padding: 8px 18px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid #333;
        }

        .container { padding: 40px; max-width: 1100px; margin: 0 auto; width: 100%; box-sizing: border-box; }
        .card { background: var(--panel); border: 1px solid #222; border-radius: 15px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }

        /* UI Elements */
        .hidden { display: none !important; }
        .btn-play { background: var(--orange); color: black; border: none; padding: 12px 20px; border-radius: 8px; font-weight: 900; cursor: pointer; }
        .btn-back { background: #333; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-bottom: 20px; font-weight: bold; }
        input, select { background: #000; border: 1px solid #333; color: var(--orange); padding: 10px; border-radius: 8px; text-align: center; outline: none; }

        /* Games Grid */
        .section-title { font-size: 20px; font-weight: 900; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .section-title::before { content: ''; width: 4px; height: 20px; background: var(--orange); border-radius: 2px; }
        .section-title.bee-section::before { background: #f1c40f; }
        .section-title.bee-section { color: #f1c40f; margin-top: 32px; }
        .bee-section + .games-grid .game-card:hover { border-color: #f1c40f; box-shadow: 0 0 18px rgba(241,196,15,0.18); }
        .games-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
        .game-card { background: #111; border-radius: 16px; padding: 30px 15px; text-align: center; transition: 0.3s; cursor: pointer; border: 1px solid #222; }
        .game-card:hover { transform: translateY(-5px); background: #181818; border-color: var(--orange); }
        .icon-box { width: 80px; height: 80px; background: rgba(0,0,0,0.3); border-radius: 16px; margin: 0 auto 18px; display: flex; align-items: center; justify-content: center; font-size: 42px; border: 1px solid rgba(255,255,255,0.05); }
        .icon-box svg { width: 60px; height: 60px; filter: drop-shadow(0 0 8px rgba(255,153,0,0.3)); }
        .btn-card-play { background: #222; color: var(--orange); border: 1px solid #333; padding: 6px 0; width: 100%; border-radius: 6px; font-size: 12px; font-weight: bold; }

        /* History Table */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { text-align: left; color: #666; font-size: 12px; padding: 10px; border-bottom: 1px solid #333; text-transform: uppercase; }
        td { padding: 15px 10px; border-bottom: 1px solid #222; font-size: 14px; color: white; }
        .status-win { color: var(--green); font-weight: bold; }
        .status-loss { color: var(--red); }

        /* --- GAME SPECIFIC CSS (FROM SOURCE) --- */
        .win-announcement { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 9999; text-align: center; pointer-events: none; animation: winPop 3s forwards cubic-bezier(0.175, 0.885, 0.32, 1.275); text-shadow: 0 0 20px rgba(241, 196, 15, 0.5); }
        .win-mult { font-size: 80px; font-weight: 900; color: var(--gold); margin: 0; line-height: 1; }
        .win-amt { font-size: 40px; font-weight: bold; color: white; margin: 0; }
        @keyframes winPop { 0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; } 15% { transform: translate(-50%, -50%) scale(1.1); opacity: 1; } 100% { transform: translate(-50%, -70%) scale(0.8); opacity: 0; } }

        .m-grid { display: grid; gap: 8px; justify-content: center; margin-top: 16px; }
        .m-grid.g25 { grid-template-columns: repeat(5, 54px); }
        .m-grid.g36 { grid-template-columns: repeat(6, 50px); }
        .m-grid.g49 { grid-template-columns: repeat(7, 46px); }
        .m-grid.g64 { grid-template-columns: repeat(8, 42px); }
        .tile { background: linear-gradient(145deg, #1e2a3a, #16202d); border: 1px solid #2a3a4a; border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 22px; transition: 0.15s; aspect-ratio:1; }
        .tile:hover { background: linear-gradient(145deg, #253346, #1e2d3d); border-color: #4a7a9b; transform: scale(1.05); }
        .tile.gem { background: linear-gradient(145deg, #0d3320, #0a2518); border-color: #27ae60; }
        .tile.bomb { background: linear-gradient(145deg, #3a0d0d, #2a0808); border-color: #e74c3c; }
        /* Mines control panel */
        .m-panel { display:flex; gap:20px; padding:20px; flex-wrap:wrap; }
        .m-controls { width:220px; flex-shrink:0; background:#0d1117; border:1px solid #1e2a3a; border-radius:12px; padding:18px; }
        .m-board-wrap { flex:1; display:flex; flex-direction:column; align-items:center; }
        .m-label { font-size:11px; color:#888; text-transform:uppercase; letter-spacing:1px; margin-bottom:6px; margin-top:14px; }
        .m-bet-row { display:flex; align-items:center; background:#0a0e14; border:1px solid #1e2a3a; border-radius:8px; overflow:hidden; }
        .m-bet-row input { border:none; background:transparent; color:white; padding:10px 12px; font-size:14px; font-weight:600; flex:1; width:0; }
        .m-bet-btn { background:#1e2a3a; border:none; color:#aaa; padding:8px 12px; cursor:pointer; font-size:12px; font-weight:700; }
        .m-bet-btn:hover { background:#253346; color:white; }
        .m-grid-btns { display:grid; grid-template-columns:repeat(4,1fr); gap:6px; }
        .m-grid-btn { background:#1e2a3a; border:1px solid #2a3a4a; border-radius:6px; color:#aaa; padding:8px 4px; font-size:13px; font-weight:700; cursor:pointer; text-align:center; transition:0.15s; }
        .m-grid-btn.active, .m-grid-btn:hover { background:#1a3a5c; border-color:#4a7a9b; color:white; }
        /* Risk dropdown */
        .m-risk-select { width:100%; background:#0a0e14; border:1px solid #1e2a3a; border-radius:8px; color:white; padding:10px 12px; font-size:13px; cursor:pointer; appearance:none; }
        .m-risk-wrap { position:relative; }
        .m-risk-wrap::after { content:'‚ñº'; position:absolute; right:12px; top:50%; transform:translateY(-50%); color:#888; font-size:10px; pointer-events:none; }
        .m-start-btn { width:100%; background:linear-gradient(135deg, #1db954, #17a044); border:none; color:white; padding:14px; border-radius:8px; font-size:15px; font-weight:900; cursor:pointer; margin-top:16px; letter-spacing:1px; transition:0.2s; }
        .m-start-btn:hover { background:linear-gradient(135deg, #21d05e, #1ab84c); }
        .m-cash-btn { width:100%; background:linear-gradient(135deg, #f39c12, #e67e22); border:none; color:white; padding:14px; border-radius:8px; font-size:15px; font-weight:900; cursor:pointer; margin-top:8px; letter-spacing:1px; }
        .m-mult-disp { text-align:center; font-size:28px; font-weight:900; color:#f1c40f; margin-bottom:8px; }
        .m-info { display:flex; justify-content:space-between; font-size:12px; color:#888; margin-top:8px; }
        /* Profit counter */
        .profit-bar { background:#0d1117; border:1px solid #1e2a3a; border-radius:8px; padding:8px 16px; display:flex; align-items:center; justify-content:space-between; margin-bottom:12px; font-size:13px; }
        .profit-val.pos { color:#27ae60; font-weight:900; }
        .profit-val.neg { color:#e74c3c; font-weight:900; }
        .profit-val.zero { color:#888; font-weight:700; }
        .coin { width: 100px; height: 100px; margin: 20px auto; background: var(--gold); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 40px; border: 5px solid #d4af37; }
        .coin.flipping { animation: flip 0.6s infinite linear; }
        @keyframes flip { 0% { transform: rotateY(0deg); } 100% { transform: rotateY(360deg); } }

        /* Roulette Slider */
        .r-slider-wrap { position: relative; width: 100%; height: 80px; background: #111; border: 2px solid #333; overflow: hidden; border-radius: 10px; margin-bottom: 20px; }
        .r-slider-inner { display: flex; position: absolute; left: 0; align-items: center; height: 100%; will-change: transform; }
        .r-num { min-width: 80px; width: 80px; height: 80px; display: flex; align-items: center; justify-content: center; font-weight: bold; border-right: 1px solid rgba(0,0,0,0.5); font-size: 24px; }
        .r-pointer { position: absolute; left: 50%; top: 0; bottom: 0; width: 4px; background: var(--orange); z-index: 10; transform: translateX(-50%); box-shadow: 0 0 15px var(--orange); }
        .r-grid { display: grid; grid-template-columns: 80px repeat(12, 1fr); gap: 5px; }
        .cell { height: 50px; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; border-radius: 4px; border: 2px solid transparent; font-size: 12px; position: relative; }
        .cell.nula { background: var(--green); grid-row: span 3; height: 160px; font-size: 24px; }
        .cell.red { background: var(--red); }
        .cell.black { background: var(--black); }
        .cell.active { border-color: white !important; box-shadow: 0 0 12px #fff; }
        .btn-extra { position: relative; }
        .chip-overlay { position: absolute; width: 24px; height: 24px; background: var(--orange); border-radius: 50%; border: 2px dashed white; color: black; font-size: 9px; display: flex; align-items: center; justify-content: center; font-weight: bold; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 5; }

        /* Blackjack & Baccarat */
        .bj-area { display: flex; flex-direction: column; align-items: center; gap: 20px; padding: 20px; }
        .bj-hand { display: flex; gap: 10px; min-height: 120px; align-items: center; }
        .card-ui { width: 70px; height: 100px; background: white; border-radius: 8px; color: black; display: flex; flex-direction: column; justify-content: center; align-items: center; font-weight: bold; font-size: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.5); border: 1px solid #ddd; }
        .card-ui.red { color: #e74c3c; }
        .card-anim { animation: cardDeal 0.35s ease-out forwards; }
        .card-flip-anim { animation: cardFlip 0.35s ease-out forwards; }

        /* Card deal animation */
        @keyframes cardDeal {
            0%   { transform: translateY(-120px) translateX(60px) rotate(-15deg) scale(0.6); opacity: 0; }
            60%  { transform: translateY(6px) translateX(-2px) rotate(1deg) scale(1.05); opacity: 1; }
            80%  { transform: translateY(-3px) rotate(-0.5deg) scale(0.98); }
            100% { transform: translateY(0) rotate(0deg) scale(1); opacity: 1; }
        }
        @keyframes cardFlip {
            0%   { transform: rotateY(90deg) scale(0.8); opacity: 0.3; }
            50%  { transform: rotateY(30deg) scale(1.05); opacity: 0.8; }
            100% { transform: rotateY(0deg) scale(1); opacity: 1; }
        }
        .card-ui.dealing {
            animation: cardDeal 0.45s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            transform-origin: top center;
        }
        .card-ui.flipping {
            animation: cardFlip 0.35s ease-out forwards;
            transform-style: preserve-3d;
        }
        .bj-score { font-size: 14px; color: var(--orange); font-weight: bold; margin-top: 5px; }
        .site-footer {
            width: 100%;
            background: var(--dark);
            border-top: 1px solid #1e1e1e;
            padding: 14px 0 12px;
            text-align: center;
            flex-shrink: 0;
        }
        .site-footer .footer-brand { color: #3a3a3a; font-size: 10px; margin-bottom: 3px; }
        .site-footer .footer-links a { color: #4a4a4a; font-size: 10px; text-decoration: underline; cursor: pointer; }
        .site-footer .footer-links a:hover { color: #777; }
        .site-footer .footer-disclaimer { color: #2e2e2e; font-size: 9px; margin-top: 2px; }

        /* ‚îÄ‚îÄ Provably Fair ‚îÄ‚îÄ */
        .pf-overlay { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.78); z-index:5000; justify-content:center; align-items:center; }
        .pf-overlay.open { display:flex; }
        .pf-modal { background:#0d0f12; border:1px solid #1f2937; border-radius:16px; width:520px; max-width:95vw; max-height:90vh; overflow-y:auto; font-family:'Courier New',monospace; }
        .pf-header { display:flex; align-items:center; gap:10px; padding:18px 22px 14px; border-bottom:1px solid #1f2937; position:sticky; top:0; background:#0d0f12; z-index:2; }
        .pf-shield { font-size:20px; color:#22c55e; }
        .pf-title { font-size:18px; font-weight:800; color:#f0fdf4; flex:1; letter-spacing:-0.5px; }
        .pf-close { background:none; border:none; color:#6b7280; cursor:pointer; font-size:20px; line-height:1; padding:0 4px; }
        .pf-close:hover { color:#e2e8f0; }
        .pf-tabs { display:flex; border-bottom:1px solid #1f2937; }
        .pf-tab { flex:1; background:none; border:none; color:#6b7280; padding:11px 0; cursor:pointer; font-size:12px; letter-spacing:1px; border-bottom:2px solid transparent; transition:all .2s; text-transform:uppercase; font-family:inherit; }
        .pf-tab.active { color:#22c55e; border-bottom:2px solid #22c55e; }
        .pf-panel { padding:18px 22px; }
        .pf-label { display:block; font-size:10px; font-weight:700; letter-spacing:1.5px; color:#4b5563; margin-bottom:6px; text-transform:uppercase; }
        .pf-hint { font-size:12px; color:#6b7280; margin:0 0 10px; line-height:1.5; }
        .pf-hash-box { background:#111827; border:1px solid #1f2937; border-radius:8px; padding:10px 12px; display:flex; align-items:center; justify-content:space-between; margin-bottom:10px; }
        .pf-hash-text { flex:1; color:#9ca3af; font-size:12px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
        .pf-copy-btn { background:none; border:none; cursor:pointer; color:#6b7280; padding:2px 6px; border-radius:4px; font-size:13px; transition:color .2s; }
        .pf-copy-btn:hover { color:#22c55e; }
        .pf-nonce-row { display:flex; justify-content:space-between; align-items:center; background:#0a0c10; border:1px solid #1f2937; border-radius:8px; padding:8px 14px; margin-bottom:12px; font-size:12px; }
        .pf-nonce-label { color:#6b7280; }
        .pf-nonce-badge { background:#14532d; color:#4ade80; font-size:13px; font-weight:700; padding:2px 10px; border-radius:99px; }
        .pf-btn { width:100%; padding:11px; background:#111827; border:1px solid #1f2937; color:#e2e8f0; border-radius:8px; cursor:pointer; font-size:13px; transition:all .2s; font-family:inherit; margin-bottom:8px; }
        .pf-btn:hover { border-color:#374151; }
        .pf-btn-green { width:100%; padding:11px; background:#15803d; border:none; color:#fff; border-radius:8px; cursor:pointer; font-size:13px; font-weight:700; transition:all .2s; font-family:inherit; box-shadow:0 0 18px rgba(34,197,94,.18); }
        .pf-btn-green:hover { background:#16a34a; }
        .pf-input { width:100%; background:#111827; border:1px solid #1f2937; border-radius:8px; padding:10px 12px; color:#e2e8f0; font-family:inherit; font-size:12px; outline:none; box-sizing:border-box; margin-bottom:10px; }
        .pf-input-row { display:flex; gap:8px; align-items:center; margin-bottom:10px; }
        .pf-input-row .pf-input { margin-bottom:0; }
        .pf-icon-btn { background:#111827; border:1px solid #1f2937; border-radius:8px; color:#6b7280; width:36px; height:36px; cursor:pointer; font-size:15px; flex-shrink:0; }
        .pf-divider { height:1px; background:#1f2937; margin:4px 0 18px; }
        .pf-result-box { background:#0a0c10; border:1px solid #14532d; border-radius:10px; padding:14px 16px; margin-top:12px; }
        .pf-reveal-box { background:#0a0c10; border:1px solid #1d4ed8; border-radius:10px; padding:14px 16px; margin-top:12px; }
        .pf-result-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
        .pf-result-title { font-size:13px; font-weight:700; color:#4ade80; }
        .pf-roll-badge { background:#14532d; color:#4ade80; font-size:12px; font-weight:900; padding:3px 10px; border-radius:99px; }
        .pf-row { display:flex; gap:10px; align-items:flex-start; margin-bottom:5px; }
        .pf-rl { font-size:10px; color:#4b5563; width:50px; flex-shrink:0; padding-top:1px; text-transform:uppercase; }
        .pf-rv { font-size:11px; color:#9ca3af; word-break:break-all; }
        .pf-history-row { display:flex; justify-content:space-between; align-items:center; padding:9px 0; border-bottom:1px solid #111827; }
        .pf-section { margin-bottom:18px; }
        .pf-footer { padding:10px 22px; border-top:1px solid #111827; background:#0a0c10; }
        .pf-footer-code { font-size:10px; color:#374151; }
        .nav-item.pf-nav { color:#22c55e !important; }
        .nav-item.pf-nav:hover { border-color:#22c55e !important; }

        /* ‚îÄ‚îÄ Floating PF Button ‚îÄ‚îÄ */
        .pf-float-btn {
            position: fixed;
            bottom: 18px;
            right: 18px;
            z-index: 4000;
            background: #0d0f12;
            border: 1px solid #22c55e;
            border-radius: 10px;
            padding: 7px 13px;
            display: flex;
            align-items: center;
            gap: 7px;
            cursor: pointer;
            box-shadow: 0 0 16px rgba(34,197,94,0.18);
            transition: all .2s;
            text-decoration: none;
        }
        .pf-float-btn:hover {
            background: #111827;
            box-shadow: 0 0 28px rgba(34,197,94,0.35);
            transform: translateY(-1px);
        }
        .pf-float-dot {
            width: 7px; height: 7px;
            background: #22c55e;
            border-radius: 50%;
            animation: pfPulse 2s infinite;
        }
        @keyframes pfPulse {
            0%,100% { opacity:1; transform:scale(1); }
            50% { opacity:.5; transform:scale(1.3); }
        }
        .pf-float-label {
            font-size: 11px;
            font-weight: 700;
            color: #22c55e;
            letter-spacing: 0.5px;
            font-family: 'Courier New', monospace;
        }
        .pf-float-shield { font-size: 14px; }

        /* ‚îÄ‚îÄ Toast Notifications ‚îÄ‚îÄ */
        #toast-container { position:fixed; bottom:80px; right:18px; z-index:9000; display:flex; flex-direction:column; gap:8px; pointer-events:none; }
        .toast { background:#1a1a1a; border:1px solid #333; border-radius:10px; padding:12px 18px; font-size:13px; font-weight:600; color:white; max-width:280px; display:flex; align-items:center; gap:10px; animation:toastIn .3s ease; box-shadow:0 4px 20px rgba(0,0,0,0.5); pointer-events:all; }
        .toast.toast-success { border-color:#27ae60; }
        .toast.toast-error   { border-color:#e74c3c; }
        .toast.toast-warn    { border-color:#f39c12; }
        .toast.toast-info    { border-color:#3498db; }
        .toast.toast-exit    { animation:toastOut .3s ease forwards; }
        @keyframes toastIn  { from { opacity:0; transform:translateX(60px); } to { opacity:1; transform:translateX(0); } }
        @keyframes toastOut { from { opacity:1; transform:translateX(0); } to { opacity:0; transform:translateX(60px); } }

        /* ‚îÄ‚îÄ Anticheat warning overlay ‚îÄ‚îÄ */
        #ac-warning { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.97); z-index:99999; align-items:center; justify-content:center; flex-direction:column; color:white; text-align:center; }
        #ac-warning.show { display:flex; }
        #ac-warning h1 { color:#e74c3c; font-size:36px; margin-bottom:12px; }
        #ac-warning p  { color:#888; font-size:14px; max-width:400px; line-height:1.6; }

        /* ‚îÄ‚îÄ Balance pulse animation ‚îÄ‚îÄ */
        @keyframes balPulse { 0%{transform:scale(1)} 40%{transform:scale(1.25)} 100%{transform:scale(1)} }
        .bal-pulse { animation: balPulse 0.4s ease; }
    </style>
</head>
<body onclick="initAudio()">

<div id="auth-screen" style="display:flex; justify-content:center; align-items:center; width: 100vw; height: 100vh; background: var(--dark); position:fixed; z-index: 1000;">
    <div class="card" style="width: 360px; text-align: center; border: 2px solid var(--orange);">
        <h1 style="color:var(--orange); margin:0; font-size:32px; letter-spacing:2px;">SWARMBET</h1>
        <p style="color:#555; font-size:12px; margin-bottom:28px;">EST. 2026 ¬∑ STAR PREMIUM</p>
        <button id="discord-login-btn" onclick="discordLogin()" style="width:100%; padding:14px; border-radius:10px; border:none; background:#5865F2; color:white; font-size:16px; font-weight:900; cursor:pointer; display:flex; align-items:center; justify-content:center; gap:12px; margin-bottom:16px; transition:0.2s; letter-spacing:0.5px; box-shadow: 0 4px 20px rgba(88,101,242,0.4);" onmouseover="this.style.background='#4752C4'" onmouseout="this.style.background='#5865F2'">
            <svg width="22" height="22" viewBox="0 0 71 55" fill="white" xmlns="http://www.w3.org/2000/svg"><path d="M60.1045 4.8978C55.5792 2.8214 50.7265 1.2916 45.6527 0.41542C45.5603 0.39851 45.468 0.44077 45.4204 0.52529C44.7963 1.6353 44.105 3.0834 43.6209 4.2216C38.1637 3.4046 32.7345 3.4046 27.3892 4.2216C26.905 3.0581 26.1886 1.6353 25.5617 0.52529C25.5141 0.44359 25.4218 0.40133 25.3294 0.41542C20.2584 1.2888 15.4057 2.8186 10.8776 4.8978C10.8384 4.9147 10.8048 4.9429 10.7825 4.9795C1.57795 18.7309 -0.943561 32.1443 0.293408 45.3914C0.299005 45.4562 0.335386 45.5182 0.385761 45.5576C6.45866 50.0174 12.3413 52.7249 18.1147 54.5195C18.2071 54.5477 18.305 54.5139 18.3638 54.4378C19.7295 52.5728 20.9469 50.6063 21.9907 48.5383C22.0523 48.4172 21.9935 48.2735 21.8676 48.2256C19.9366 47.4931 18.0979 46.6 16.3292 45.5858C16.1893 45.5041 16.1781 45.304 16.3068 45.2082C16.679 44.9293 17.0513 44.6391 17.4067 44.3461C17.471 44.2926 17.5606 44.2813 17.6362 44.3151C29.2558 49.6202 41.8354 49.6202 53.3179 44.3151C53.3935 44.2785 53.4831 44.2898 53.5502 44.3433C53.9057 44.6363 54.2779 44.9293 54.6529 45.2082C54.7816 45.304 54.7732 45.5041 54.6333 45.5858C52.8646 46.6197 51.0259 47.4931 49.0921 48.2228C48.9662 48.2707 48.9102 48.4172 48.9718 48.5383C50.038 50.6034 51.2554 52.5699 52.5959 54.435C52.6519 54.5139 52.7526 54.5477 52.845 54.5195C58.6464 52.7249 64.529 50.0174 70.6019 45.5576C70.6551 45.5182 70.6887 45.459 70.6943 45.3942C72.1747 30.0791 68.2147 16.7757 60.1968 4.9823C60.1772 4.9429 60.1437 4.9147 60.1045 4.8978Z"/></svg>
            Login with Discord
        </button>
        <p style="color:#666; font-size:12px; margin-top:8px;">P≈ôihlas se sv√Ωm Discord √∫ƒçtem</p>
        <div id="discord-status" style="margin-top:10px; font-size:12px; color:#666;"></div>
        <!-- hidden inputs kept for legacy login compatibility -->
        <input type="text" id="user" style="display:none;">
        <input type="password" id="pass" style="display:none;">
    </div>
</div>

<!-- Discord OAuth2 Config Modal -->
<div id="discord-config-modal" style="display:none; position:fixed; inset:0; z-index:9999; background:rgba(0,0,0,0.85); justify-content:center; align-items:center;">
    <div class="card" style="width:400px; border:2px solid #5865F2; text-align:center;">
        <div style="font-size:36px; margin-bottom:10px;"><svg width="40" height="32" viewBox="0 0 71 55" fill="#5865F2" xmlns="http://www.w3.org/2000/svg"><path d="M60.1045 4.8978C55.5792 2.8214 50.7265 1.2916 45.6527 0.41542C45.5603 0.39851 45.468 0.44077 45.4204 0.52529C44.7963 1.6353 44.105 3.0834 43.6209 4.2216C38.1637 3.4046 32.7345 3.4046 27.3892 4.2216C26.905 3.0581 26.1886 1.6353 25.5617 0.52529C25.5141 0.44359 25.4218 0.40133 25.3294 0.41542C20.2584 1.2888 15.4057 2.8186 10.8776 4.8978C10.8384 4.9147 10.8048 4.9429 10.7825 4.9795C1.57795 18.7309 -0.943561 32.1443 0.293408 45.3914C0.299005 45.4562 0.335386 45.5182 0.385761 45.5576C6.45866 50.0174 12.3413 52.7249 18.1147 54.5195C18.2071 54.5477 18.305 54.5139 18.3638 54.4378C19.7295 52.5728 20.9469 50.6063 21.9907 48.5383C22.0523 48.4172 21.9935 48.2735 21.8676 48.2256C19.9366 47.4931 18.0979 46.6 16.3292 45.5858C16.1893 45.5041 16.1781 45.304 16.3068 45.2082C16.679 44.9293 17.0513 44.6391 17.4067 44.3461C17.471 44.2926 17.5606 44.2813 17.6362 44.3151C29.2558 49.6202 41.8354 49.6202 53.3179 44.3151C53.3935 44.2785 53.4831 44.2898 53.5502 44.3433C53.9057 44.6363 54.2779 44.9293 54.6529 45.2082C54.7816 45.304 54.7732 45.5041 54.6333 45.5858C52.8646 46.6197 51.0259 47.4931 49.0921 48.2228C48.9662 48.2707 48.9102 48.4172 48.9718 48.5383C50.038 50.6034 51.2554 52.5699 52.5959 54.435C52.6519 54.5139 52.7526 54.5477 52.845 54.5195C58.6464 52.7249 64.529 50.0174 70.6019 45.5576C70.6551 45.5182 70.6887 45.459 70.6943 45.3942C72.1747 30.0791 68.2147 16.7757 60.1968 4.9823C60.1772 4.9429 60.1437 4.9147 60.1045 4.8978Z"/></svg></div>
        <h2 style="color:#5865F2; margin:0 0 8px;">Discord OAuth2 Setup</h2>
        <p style="color:#888; font-size:13px; margin-bottom:20px;">Zadej sv≈Øj Discord Application Client ID a Redirect URI z <a href="https://discord.com/developers/applications" target="_blank" style="color:#5865F2;">Discord Developer Portal</a></p>
        <div style="text-align:left; margin-bottom:12px;">
            <label style="color:#aaa; font-size:12px; display:block; margin-bottom:5px;">CLIENT ID</label>
            <input type="text" id="dc-client-id" placeholder="npr. 1234567890123456789" style="width:100%; box-sizing:border-box; background:#0a0a0a; border:1px solid #5865F2; color:white; padding:10px; border-radius:8px; font-size:14px;">
        </div>
        <div style="text-align:left; margin-bottom:20px;">
            <label style="color:#aaa; font-size:12px; display:block; margin-bottom:5px;">REDIRECT URI</label>
            <input type="text" id="dc-redirect" placeholder="https://tvojastranka.com/" style="width:100%; box-sizing:border-box; background:#0a0a0a; border:1px solid #5865F2; color:white; padding:10px; border-radius:8px; font-size:14px;">
            <small style="color:#555;">Auto-detekov√°no: <span id="dc-auto-redirect" style="color:#f39c12;"></span></small>
        </div>
        <div style="display:flex; gap:10px;">
            <button onclick="saveDiscordConfig()" style="flex:1; background:#5865F2; color:white; border:none; padding:12px; border-radius:8px; font-weight:900; cursor:pointer; font-size:14px;">ULO≈ΩIT & P≈òIHL√ÅSIT</button>
            <button onclick="document.getElementById('discord-config-modal').style.display='none'" style="background:#333; color:white; border:none; padding:12px 16px; border-radius:8px; cursor:pointer;">‚úï</button>
        </div>
    </div>
</div>

<div id="main-app" class="hidden" style="display: flex; width: 100%;">
    <div class="sidebar">
        <div class="logo">S<span>B</span></div>
        <div class="nav-item active" id="nav-games" onclick="showPage('games')">üéÆ Games</div>
        <div class="nav-item" id="nav-history" onclick="showPage('history')">üìú Bet History</div>
        <div class="nav-item" id="nav-rakeback" onclick="showPage('rakeback')">üéÅ Promo Codes</div>
        <div id="link-admin" class="nav-item hidden" onclick="showPage('admin')">‚öôÔ∏è Admin Panel</div>
        <div style="margin-top: auto;">
            <div class="nav-item" onclick="logout()">üö™ Logout</div>
        </div>
    </div>

    <div class="main-wrapper">
        <div class="top-nav">
            <div class="balance-box">
                <span style="color:var(--orange)">‚≠ê</span>
                <span id="display-chips">0</span>
            </div>
            <div style="font-weight: 900; color: var(--orange);" id="display-name">---</div>
        </div>

        <div class="container">
            <div id="page-games">
                <div id="selection-menu">
                    <!-- BEE SWARM SECTION -->
                    <div class="section-title bee-section">üêù BEE SWARM SIMULATOR</div>
                    <div class="games-grid" style="grid-template-columns: repeat(4, 1fr);">
                        <div class="game-card" onclick="selectGame('killabug')" style="border-color: #2a1a00;">
                            <div class="icon-box" style="background: linear-gradient(135deg, #1a0a00, #3d1500); border: 1px solid rgba(231,76,60,0.18);">
                                <img src="image_2.png" alt="Kill a Bug" width="60" height="60" style="object-fit:contain;">
                            </div>
                            <h3 style="color:#e74c3c;">Kill a Bug</h3>
                            <p style="color:#888;">select ¬∑ bet ¬∑ eliminate</p>
                            <button class="btn-card-play" style="border-color:#e74c3c; color:#e74c3c;">Play</button>
                        </div>
                        <div class="game-card" onclick="selectGame('royaljelly')" style="border-color: #2a2200;">
                            <div class="icon-box" style="background: linear-gradient(135deg, #1a1000, #3d2800); border: 1px solid rgba(241,196,15,0.15);">
                                <img src="image_6.png" alt="Royal Jelly" width="60" height="60" style="object-fit:contain;">
                            </div>
                            <h3 style="color:#f1c40f;">Royal Jelly</h3>
                            <p style="color:#888;">bee vs bee battle</p>
                            <button class="btn-card-play" style="border-color:#f1c40f; color:#f1c40f;">Play</button>
                        </div>
                    </div>


                    <div class="section-title" style="margin-top:32px;">üé∞ CLASSIC GAMES</div>
                    <div class="games-grid">
                        <div class="game-card" onclick="selectGame('mines')">
                            <div class="icon-box" style="background:linear-gradient(135deg,#1a0010,#3d0020);">
                                <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                    <circle cx="24" cy="26" r="14" fill="#cc1f4a" stroke="#ff4d7a" stroke-width="1.5"/>
                                    <rect x="21" y="10" width="6" height="8" rx="2" fill="#ff4d7a"/>
                                    <line x1="24" y1="10" x2="24" y2="6" stroke="#ff4d7a" stroke-width="2" stroke-linecap="round"/>
                                    <line x1="8" y1="26" x2="4" y2="26" stroke="#ff4d7a" stroke-width="2" stroke-linecap="round"/>
                                    <line x1="40" y1="26" x2="44" y2="26" stroke="#ff4d7a" stroke-width="2" stroke-linecap="round"/>
                                    <line x1="12" y1="14" x2="9" y2="11" stroke="#ff4d7a" stroke-width="2" stroke-linecap="round"/>
                                    <line x1="36" y1="14" x2="39" y2="11" stroke="#ff4d7a" stroke-width="2" stroke-linecap="round"/>
                                    <circle cx="24" cy="26" r="5" fill="#ff4d7a" opacity="0.4"/>
                                </svg>
                            </div>
                            <h3>Mines</h3>
                            <p>avoid the bombs</p>
                            <button class="btn-card-play">Play</button>
                        </div>
                        <div class="game-card" onclick="selectGame('dice')">
                            <div class="icon-box" style="background:linear-gradient(135deg,#001a3d,#003d8a);">
                                <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                    <rect x="6" y="6" width="36" height="36" rx="8" fill="#1a4db5" stroke="#4d80ff" stroke-width="1.5"/>
                                    <circle cx="15" cy="15" r="3.5" fill="#4d80ff"/>
                                    <circle cx="33" cy="15" r="3.5" fill="#4d80ff"/>
                                    <circle cx="15" cy="33" r="3.5" fill="#4d80ff"/>
                                    <circle cx="33" cy="33" r="3.5" fill="#4d80ff"/>
                                    <circle cx="24" cy="24" r="3.5" fill="#4d80ff"/>
                                </svg>
                            </div>
                            <h3>Dice Roll</h3>
                            <p>roll vs robot</p>
                            <button class="btn-card-play">Play</button>
                        </div>
                        <div class="game-card" onclick="selectGame('coinflip')">
                            <div class="icon-box" style="background:linear-gradient(135deg,#1a1400,#3d3000);">
                                <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                    <circle cx="24" cy="24" r="18" fill="#c9a800" stroke="#f1c40f" stroke-width="2"/>
                                    <circle cx="24" cy="24" r="13" fill="none" stroke="#f1c40f" stroke-width="1" opacity="0.5"/>
                                    <text x="24" y="30" text-anchor="middle" fill="#f1c40f" font-size="16" font-weight="900" font-family="Arial">$</text>
                                </svg>
                            </div>
                            <h3>Coin Flip</h3>
                            <p>heads or tails</p>
                            <button class="btn-card-play">Play</button>
                        </div>
                        <div class="game-card" onclick="selectGame('roulette')">
                            <div class="icon-box" style="background:linear-gradient(135deg,#001a15,#003d2e);">
                                <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                    <circle cx="24" cy="24" r="18" fill="#0a2e24" stroke="#1abc9c" stroke-width="2"/>
                                    <circle cx="24" cy="24" r="12" fill="none" stroke="#1abc9c" stroke-width="1" opacity="0.6"/>
                                    <circle cx="24" cy="24" r="4" fill="#1abc9c"/>
                                    <line x1="24" y1="6" x2="24" y2="12" stroke="#e74c3c" stroke-width="3" stroke-linecap="round"/>
                                    <line x1="24" y1="36" x2="24" y2="42" stroke="#2c3e50" stroke-width="3" stroke-linecap="round"/>
                                    <line x1="6" y1="24" x2="12" y2="24" stroke="#e74c3c" stroke-width="3" stroke-linecap="round"/>
                                    <line x1="36" y1="24" x2="42" y2="24" stroke="#2c3e50" stroke-width="3" stroke-linecap="round"/>
                                    <line x1="24" y1="24" x2="24" y2="13" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                            </div>
                            <h3>Roulette</h3>
                            <p>spin the wheel</p>
                            <button class="btn-card-play">Play</button>
                        </div>
                        <div class="game-card" onclick="selectGame('blackjack')">
                            <div class="icon-box" style="background:linear-gradient(135deg,#1a0f00,#3d2500);">
                                <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                    <rect x="6" y="8" width="22" height="32" rx="4" fill="#1a1a1a" stroke="#f39c12" stroke-width="1.5"/>
                                    <rect x="20" y="8" width="22" height="32" rx="4" fill="#222" stroke="#f39c12" stroke-width="1.5"/>
                                    <text x="14" y="28" text-anchor="middle" fill="#f39c12" font-size="14" font-weight="900" font-family="Arial">A</text>
                                    <text x="34" y="28" text-anchor="middle" fill="#e74c3c" font-size="14" font-weight="900" font-family="Arial">K</text>
                                    <text x="10" y="20" text-anchor="middle" fill="#f39c12" font-size="9" font-family="Arial">‚ô†</text>
                                    <text x="38" y="20" text-anchor="middle" fill="#e74c3c" font-size="9" font-family="Arial">‚ô•</text>
                                </svg>
                            </div>
                            <h3>Blackjack</h3>
                            <p>beat the dealer</p>
                            <button class="btn-card-play">Play</button>
                        </div>
                        <div class="game-card" onclick="selectGame('baccarat')">
                            <div class="icon-box" style="background:linear-gradient(135deg,#0f001a,#250040);">
                                <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                    <rect x="4" y="10" width="18" height="28" rx="4" fill="#1a0030" stroke="#9b59b6" stroke-width="1.5"/>
                                    <rect x="14" y="10" width="18" height="28" rx="4" fill="#1a0030" stroke="#9b59b6" stroke-width="1.5"/>
                                    <rect x="26" y="10" width="18" height="28" rx="4" fill="#1a0030" stroke="#9b59b6" stroke-width="1.5"/>
                                    <text x="13" y="29" text-anchor="middle" fill="#9b59b6" font-size="13" font-weight="900" font-family="Arial">B</text>
                                    <text x="23" y="29" text-anchor="middle" fill="#9b59b6" font-size="13" font-weight="900" font-family="Arial">A</text>
                                    <text x="35" y="29" text-anchor="middle" fill="#9b59b6" font-size="13" font-weight="900" font-family="Arial">C</text>
                                </svg>
                            </div>
                            <h3>Baccarat</h3>
                            <p>P, B or Tie</p>
                            <button class="btn-card-play">Play</button>
                        </div>
                        <div class="game-card" onclick="selectGame('crash')">
                            <div class="icon-box" style="background:linear-gradient(135deg,#001a08,#003d15);">
                                <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                    <polyline points="6,38 16,28 24,20 34,10" stroke="#2ecc71" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                                    <circle cx="34" cy="10" r="4" fill="#2ecc71"/>
                                    <polyline points="34,10 44,16 38,20" fill="#2ecc71"/>
                                    <line x1="6" y1="38" x2="42" y2="38" stroke="#2ecc71" stroke-width="1" opacity="0.3"/>
                                    <line x1="6" y1="10" x2="6" y2="38" stroke="#2ecc71" stroke-width="1" opacity="0.3"/>
                                    <text x="10" y="35" fill="#2ecc71" font-size="8" font-family="Arial" opacity="0.6">1x</text>
                                    <text x="28" y="20" fill="#2ecc71" font-size="8" font-family="Arial" opacity="0.6">5x</text>
                                </svg>
                            </div>
                            <h3>Crash</h3>
                            <p>cash out in time</p>
                            <button class="btn-card-play">Play</button>
                        </div>
                        <div class="game-card" onclick="selectGame('tower')">
                            <div class="icon-box" style="background:linear-gradient(135deg,#1a1500,#3d3200);">
                                <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                    <rect x="16" y="36" width="16" height="6" rx="2" fill="#f1c40f" opacity="0.9"/>
                                    <rect x="13" y="28" width="22" height="7" rx="2" fill="#f1c40f" opacity="0.75"/>
                                    <rect x="10" y="20" width="28" height="7" rx="2" fill="#f1c40f" opacity="0.6"/>
                                    <rect x="7" y="12" width="34" height="7" rx="2" fill="#f1c40f" opacity="0.4"/>
                                    <polygon points="24,4 30,12 18,12" fill="#f1c40f"/>
                                </svg>
                            </div>
                            <h3>Tower</h3>
                            <p>climb to top</p>
                            <button class="btn-card-play">Play</button>
                        </div>

                    </div>

                                    </div>

                <div id="game-active-page" class="hidden">
                    <button class="btn-back" onclick="backToMenu()">‚Üê BACK TO MENU</button>
                    <div class="card" style="background:#0c0c0c;">
                        <div id="game-mines" class="hidden">
                            <div class="m-panel">
                                <div class="m-controls">
                                    <div class="m-label">Bet Amount</div>
                                    <div class="m-bet-row">
                                        <span style="color:#888;padding:0 8px;">‚≠ê</span>
                                        <input type="number" id="m-bet" value="50" min="50" max="1000">
                                        <button class="m-bet-btn" onclick="document.getElementById('m-bet').value=Math.max(50,Math.floor(parseInt(document.getElementById('m-bet').value)/2))">¬Ω</button>
                                        <button class="m-bet-btn" onclick="document.getElementById('m-bet').value=Math.min(1000,parseInt(document.getElementById('m-bet').value)*2)">2√ó</button>
                                    </div>
                                    <div class="m-label">Grid Size</div>
                                    <div class="m-grid-btns">
                                        <div class="m-grid-btn active" id="mg-25" onclick="setMGrid(25)">25</div>
                                        <div class="m-grid-btn" id="mg-36" onclick="setMGrid(36)">36</div>
                                        <div class="m-grid-btn" id="mg-49" onclick="setMGrid(49)">49</div>
                                        <div class="m-grid-btn" id="mg-64" onclick="setMGrid(64)">64</div>
                                    </div>
                                    <div class="m-label">Risk Level</div>
                                    <div class="m-risk-wrap">
                                        <select class="m-risk-select" id="m-risk">
                                            <option value="easy">Easy</option>
                                            <option value="medium">Medium</option>
                                            <option value="hard">Hard</option>
                                            <option value="expert">Expert</option>
                                            <option value="master">Master</option>
                                        </select>
                                    </div>
                                    <div class="m-info" id="m-mine-info">
                                        <span>üíé <span id="m-gem-count">22</span> Gems</span>
                                        <span>üí£ <span id="m-bomb-count">3</span> Mines</span>
                                    </div>
                                    <button class="m-start-btn" id="m-start" onclick="startMines()">‚ñ∂ START GAME</button>
                                    <button id="m-cash" class="m-cash-btn hidden" onclick="cashoutMines()">üí∞ CASH OUT</button>
                                    <div class="profit-bar" style="margin-top:12px;margin-bottom:0;">
                                        <span style="color:#888;">Session Profit</span>
                                        <span class="profit-val zero" id="m-profit">+0 ‚≠ê</span>
                                    </div>
                                </div>
                                <div class="m-board-wrap">
                                    <div class="m-mult-disp" id="m-mult-disp">1.00√ó</div>
                                    <div class="m-grid g25" id="m-board"></div>
                                </div>
                            </div>
                        </div>

                        <div id="game-dice" class="hidden" style="text-align:center;">
                            <h2 style="color:#3498db;">DICE ROLL</h2>
                            <div class="profit-bar" style="max-width:400px;margin:0 auto 16px;">
                                <span style="color:#888;">Session Profit</span>
                                <span class="profit-val zero" id="d-profit">+0 ‚≠ê</span>
                            </div>
                            Guess (1-6): <input type="number" id="d-num" value="1" min="1" max="6">
                            Bet: <input type="number" id="d-bet" value="50" style="width:80px;">
                            <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('d-bet').value=Math.max(50,Math.floor(parseInt(document.getElementById('d-bet').value||50)/2))">¬Ω</button>
                            <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('d-bet').value=Math.min(1000,parseInt(document.getElementById('d-bet').value||50)*2)">2√ó</button>
                            <button class="btn-play" onclick="playDice()">ROLL</button>
                            <div id="d-res" style="font-size:100px; margin:20px;">üé≤</div>
                        </div>

                        <div id="game-coinflip" class="hidden" style="text-align:center;">
                            <h2 style="color:var(--gold);">COIN FLIP</h2>
                            <div class="profit-bar" style="max-width:360px;margin:0 auto 16px;">
                                <span style="color:#888;">Session Profit</span>
                                <span class="profit-val zero" id="cf-profit">+0 ‚≠ê</span>
                            </div>
                            <div id="coin-obj" class="coin">‚≠ê</div>
                            Side: <select id="cf-choice">
                                <option value="H">HEADS (‚≠ê)</option>
                                <option value="T">TAILS (üíé)</option>
                            </select>
                            Bet: <input type="number" id="cf-bet" value="50" min="50" max="1000" style="width:80px;">
                            <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('cf-bet').value=Math.max(50,Math.floor(parseInt(document.getElementById('cf-bet').value||50)/2))">¬Ω</button>
                            <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('cf-bet').value=Math.min(1000,parseInt(document.getElementById('cf-bet').value||50)*2)">2√ó</button>
                            <button class="btn-play" id="cf-btn" onclick="playCoinFlip()">FLIP</button>
                        </div>

                        <div id="game-roulette" class="hidden">
                            <h2 style="color:#1abc9c; text-align:center;">ROULETTE</h2>
                            <div class="profit-bar" style="max-width:600px;margin:0 auto 10px;">
                                <span style="color:#888;">Session Profit</span>
                                <span class="profit-val zero" id="r-profit">+0 ‚≠ê</span>
                            </div>
                            <div id="r-status" style="text-align:center; color:var(--orange); font-weight:bold; margin-bottom:10px; height:20px;">PLACE YOUR BETS</div>
                            <div class="r-slider-wrap" id="r-wrap">
                                <div class="r-pointer"></div>
                                <div id="r-slider" class="r-slider-inner"></div>
                            </div>
                            <div class="r-grid" id="r-board"></div>
                            <div class="r-dozen-bets" style="display:grid; grid-template-columns: repeat(3, 1fr); gap:5px; margin-top:5px; margin-left:85px;">
                                <button class="btn-extra" style="background:#222; border:1px solid #444; color:white; padding:10px; cursor:pointer;" onclick="setExtraBet('1st12', this)">1st 12</button>
                                <button class="btn-extra" style="background:#222; border:1px solid #444; color:white; padding:10px; cursor:pointer;" onclick="setExtraBet('2nd12', this)">2nd 12</button>
                                <button class="btn-extra" style="background:#222; border:1px solid #444; color:white; padding:10px; cursor:pointer;" onclick="setExtraBet('3rd12', this)">3rd 12</button>
                            </div>
                            <div class="r-extra-bets" style="display:grid; grid-template-columns: repeat(6, 1fr); gap:5px; margin-top:10px; margin-left:85px;">
                                <button class="btn-extra" style="background:#222; border:1px solid #444; color:white; padding:10px; cursor:pointer;" onclick="setExtraBet('1-18', this)">1 - 18</button>
                                <button class="btn-extra" style="background:#222; border:1px solid #444; color:white; padding:10px; cursor:pointer;" onclick="setExtraBet('even', this)">EVEN</button>
                                <button class="btn-extra" style="background:var(--red); border:none; color:white; padding:10px; cursor:pointer;" onclick="setExtraBet('red', this)">RED</button>
                                <button class="btn-extra" style="background:var(--black); border:none; color:white; padding:10px; cursor:pointer;" onclick="setExtraBet('black', this)">BLACK</button>
                                <button class="btn-extra" style="background:#222; border:1px solid #444; color:white; padding:10px; cursor:pointer;" onclick="setExtraBet('odd', this)">ODD</button>
                                <button class="btn-extra" style="background:#222; border:1px solid #444; color:white; padding:10px; cursor:pointer;" onclick="setExtraBet('19-36', this)">19 - 36</button>
                            </div>
                            <div style="display:flex; gap:10px; margin-top:20px; justify-content:center; align-items:center;">
                                BET PER CELL: <input type="number" id="r-bet" value="50" min="50" max="1000" style="width:80px;">
                                <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('r-bet').value=Math.max(50,Math.floor(parseInt(document.getElementById('r-bet').value||50)/2))">¬Ω</button>
                                <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('r-bet').value=Math.min(1000,parseInt(document.getElementById('r-bet').value||50)*2)">2√ó</button>
                                <button class="btn-play" id="r-spin" onclick="spinRoulette()">SPIN</button>
                                <button class="btn-play" style="background:#444; color:white;" onclick="clearRouletteBets()">CLEAR</button>
                            </div>
                        </div>

                        <div id="game-blackjack" class="hidden">
                            <div class="bj-area">
                                <div class="profit-bar" style="margin-bottom:12px;">
                                    <span style="color:#888;">Session Profit</span>
                                    <span class="profit-val zero" id="bj-profit">+0 ‚≠ê</span>
                                </div>
                                <div class="bj-hand-wrap">
                                    <div style="text-align:center; font-size:12px; color:#666;">DEALER <span id="bj-dealer-count" style="color:#888; font-size:11px;"></span></div>
                                    <div id="bj-dealer-hand" class="bj-hand"></div>
                                    <div id="bj-dealer-score" class="bj-score" style="text-align:center;"></div>
                                </div>
                                <div id="bj-status" style="font-size:24px; font-weight:900; color:var(--orange);">VS</div>
                                <div class="bj-hand-wrap">
                                    <div id="bj-player-hand" class="bj-hand"></div>
                                    <div id="bj-player-score" class="bj-score" style="text-align:center;"></div>
                                    <div style="text-align:center; font-size:12px; color:#666;">YOU <span id="bj-player-count" style="color:#888; font-size:11px;"></span></div>
                                </div>
                                <!-- Deck counter -->
                                <div style="background:#111; border:1px solid #333; border-radius:8px; padding:8px 16px; display:flex; gap:20px; font-size:12px; margin:4px 0;">
                                    <span>üÉè Deck: <strong id="bj-deck-remaining" style="color:var(--orange);">52</strong> cards</span>
                                    <span>Your value: <strong id="bj-player-value" style="color:#2ecc71;">‚Äî</strong></span>
                                    <span>Dealer shows: <strong id="bj-dealer-value" style="color:#e74c3c;">‚Äî</strong></span>
                                </div>
                                <div id="bj-controls" style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap; justify-content:center;">
                                    Bet: <input type="number" id="bj-bet" value="100" min="50" max="1000" style="width:80px;">
                                    <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('bj-bet').value=Math.max(50,Math.floor(parseInt(document.getElementById('bj-bet').value||100)/2))">¬Ω</button>
                                    <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('bj-bet').value=Math.min(1000,parseInt(document.getElementById('bj-bet').value||100)*2)">2√ó</button>
                                    <button class="btn-play" id="bj-deal-btn" onclick="startBlackjack()">DEAL</button>
                                    <button class="btn-play hidden" id="bj-hit-btn" onclick="bjHit()" style="background:#3498db; color:white;">HIT</button>
                                    <button class="btn-play hidden" id="bj-stand-btn" onclick="bjStand()" style="background:#9b59b6; color:white;">STAND</button>
                                    <button class="btn-play hidden" id="bj-gamble-btn" onclick="bjGamble()" style="background:var(--gold); color:black;">üé≤ GAMBLE</button>
                                </div>
                                <div id="bj-gamble-area" class="hidden" style="text-align:center; margin-top:10px;">
                                    <div style="color:#f1c40f; font-size:13px; margin-bottom:8px;">Gamble your winnings ‚Äî guess card color!</div>
                                    <div style="display:flex; gap:10px; justify-content:center;">
                                        <button class="btn-play" onclick="bjGambleColor('red')" style="background:#e74c3c;">‚ô• RED (2x)</button>
                                        <button class="btn-play" onclick="bjGambleColor('black')" style="background:#333;">‚ô† BLACK (2x)</button>
                                        <button class="btn-play" onclick="bjGambleCollect()" style="background:#555; color:white;">Collect</button>
                                    </div>
                                    <div id="bj-gamble-status" style="margin-top:8px; font-weight:bold;"></div>
                                </div>
                            </div>
                        </div>

                        <div id="game-baccarat" class="hidden">
                            <div class="bj-area">
                                <h2 style="color:#9b59b6;">BACCARAT</h2>
                                <div id="bac-status" style="font-size:18px; color:var(--orange); font-weight:bold;">CHOOSE A SIDE</div>
                                <!-- Deck + value counter -->
                                <div style="background:#111; border:1px solid #333; border-radius:8px; padding:8px 16px; display:flex; gap:20px; font-size:12px;">
                                    <span>üÉè Deck: <strong id="bac-deck-remaining" style="color:var(--orange);">52</strong> cards</span>
                                    <span>Player value: <strong id="bac-pval" style="color:#3498db;">‚Äî</strong></span>
                                    <span>Banker value: <strong id="bac-bval" style="color:#e74c3c;">‚Äî</strong></span>
                                </div>
                                <div style="display:flex; gap:40px;">
                                    <div style="text-align:center;">
                                        <div style="font-size:12px; color:#666;">PLAYER <span id="bac-player-count" style="color:#888; font-size:11px;"></span></div>
                                        <div id="bac-player-hand" class="bj-hand"></div>
                                        <div id="bac-player-score" class="bj-score"></div>
                                    </div>
                                    <div style="text-align:center;">
                                        <div style="font-size:12px; color:#666;">BANKER <span id="bac-banker-count" style="color:#888; font-size:11px;"></span></div>
                                        <div id="bac-banker-hand" class="bj-hand"></div>
                                        <div id="bac-banker-score" class="bj-score"></div>
                                    </div>
                                </div>
                                <div id="bac-controls" style="text-align:center;">
                                    <div class="profit-bar" style="max-width:400px;margin:0 auto 12px;">
                                        <span style="color:#888;">Session Profit</span>
                                        <span class="profit-val zero" id="bac-profit">+0 ‚≠ê</span>
                                    </div>
                                    Bet: <input type="number" id="bac-bet" value="100" min="50" max="1000" style="width:80px;">
                                    <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('bac-bet').value=Math.max(50,Math.floor(parseInt(document.getElementById('bac-bet').value||100)/2))">¬Ω</button>
                                    <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('bac-bet').value=Math.min(1000,parseInt(document.getElementById('bac-bet').value||100)*2)">2√ó</button><br><br>
                                    <button class="btn-play" onclick="playBaccarat('P')" style="background:#3498db; color:white;">PLAYER (2x)</button>
                                    <button class="btn-play" onclick="playBaccarat('T')" style="background:#95a5a6; color:white;">TIE (9x)</button>
                                    <button class="btn-play" onclick="playBaccarat('B')" style="background:#e74c3c; color:white;">BANKER (1.95x)</button>
                                </div>
                                <!-- Gamble feature -->
                                <div id="bac-gamble-area" class="hidden" style="text-align:center; margin-top:10px;">
                                    <div style="color:#f1c40f; font-size:13px; margin-bottom:8px;">üé≤ Gamble winnings ‚Äî guess card color!</div>
                                    <div style="display:flex; gap:10px; justify-content:center;">
                                        <button class="btn-play" onclick="bacGambleColor('red')" style="background:#e74c3c;">‚ô• RED (2x)</button>
                                        <button class="btn-play" onclick="bacGambleColor('black')" style="background:#333;">‚ô† BLACK (2x)</button>
                                        <button class="btn-play" onclick="bacGambleCollect()" style="background:#555; color:white;">Collect</button>
                                    </div>
                                    <div id="bac-gamble-status" style="margin-top:8px; font-weight:bold;"></div>
                                </div>
                            </div>
                        </div>

                        <div id="game-crash" class="hidden" style="text-align:center;">
                            <h2 style="color:#2ecc71;">CRASH</h2>
                            <div class="profit-bar" style="max-width:400px;margin:0 auto 16px;">
                                <span style="color:#888;">Session Profit</span>
                                <span class="profit-val zero" id="c-profit">+0 ‚≠ê</span>
                            </div>
                            <div id="crash-display" style="font-size: 80px; font-weight: 900; margin: 30px 0;">1.00x</div>
                            Bet: <input type="number" id="c-bet" value="50" min="50" max="1000" style="width:80px;">
                            <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('c-bet').value=Math.max(50,Math.floor(parseInt(document.getElementById('c-bet').value||50)/2))">¬Ω</button>
                            <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('c-bet').value=Math.min(1000,parseInt(document.getElementById('c-bet').value||50)*2)">2√ó</button>
                            <button class="btn-play" id="c-start" onclick="startCrash()">START</button>
                            <button id="c-cash" class="hidden btn-play" style="background:#2ecc71;" onclick="cashoutCrash()">CASH OUT</button>
                            <div id="crash-history" style="display:flex; justify-content:center; gap:10px; color:#555; margin-top:20px;"></div>
                        </div>

                        <div id="game-tower" class="hidden">
                            <style>
                                /* ===== TOWER LAYOUT ===== */
                                /* ===== TOWER - SWARMBET ORANGE/BLACK THEME ===== */
                                .tw-wrap { display:flex; height:calc(100vh - 130px); min-height:560px; overflow:hidden; }

                                /* Left panel */
                                .tw-panel { width:300px; flex-shrink:0; background:#111; border-right:1px solid #222; padding:24px 20px; display:flex; flex-direction:column; gap:16px; overflow-y:auto; }
                                .tw-panel-title { font-size:18px; font-weight:800; color:var(--orange); display:flex; align-items:center; gap:8px; margin-bottom:4px; }
                                .tw-label { font-size:11px; color:#666; text-transform:uppercase; letter-spacing:1px; margin-bottom:6px; font-weight:600; }

                                /* Bet row */
                                .tw-bet-row { display:flex; align-items:center; background:#000; border:1px solid #333; border-radius:8px; overflow:hidden; }
                                .tw-bet-row input { border:none; background:transparent; color:var(--orange); padding:11px 14px; font-size:15px; font-weight:600; flex:1; width:0; outline:none; }
                                .tw-bet-half-2x { display:flex; border-left:1px solid #333; }
                                .tw-bet-half-2x button { background:#1a1a1a; border:none; color:#888; padding:11px 14px; cursor:pointer; font-size:13px; font-weight:700; border-right:1px solid #222; transition:0.15s; }
                                .tw-bet-half-2x button:last-child { border-right:none; }
                                .tw-bet-half-2x button:hover { background:#2a2a2a; color:var(--orange); }

                                /* Risk dropdown */
                                .tw-risk-wrap { position:relative; }
                                .tw-risk-wrap::after { content:'‚ñº'; position:absolute; right:14px; top:50%; transform:translateY(-50%); color:var(--orange); font-size:10px; pointer-events:none; }
                                .tw-risk-dropdown { position:absolute; top:100%; left:0; right:0; background:#1a1a1a; border:1px solid var(--orange); border-radius:8px; z-index:200; overflow:hidden; display:none; margin-top:4px; box-shadow:0 8px 32px rgba(0,0,0,0.8),0 0 20px rgba(255,153,0,0.1); }
                                .tw-risk-dropdown.open { display:block; }
                                .tw-risk-option { display:flex; align-items:center; justify-content:space-between; padding:10px 14px; cursor:pointer; font-size:14px; font-weight:700; color:white; transition:background 0.15s; }
                                .tw-risk-option:hover, .tw-risk-option.selected { background:rgba(255,153,0,0.15); color:var(--orange); }
                                .tw-risk-icons { display:flex; gap:4px; align-items:center; }
                                .tw-icon-gem { width:14px; height:14px; background:#27ae60; clip-path:polygon(50% 0%,100% 40%,50% 100%,0% 40%); flex-shrink:0; }
                                .tw-icon-bomb { width:13px; height:13px; background:#e74c3c; clip-path:polygon(50% 0%,100% 40%,50% 100%,0% 40%); flex-shrink:0; }

                                /* Buttons */
                                .tw-start-btn { width:100%; background:var(--orange); border:none; color:black; padding:14px; border-radius:8px; font-size:15px; font-weight:900; cursor:pointer; transition:0.2s; letter-spacing:0.5px; }
                                .tw-start-btn:hover { background:#ffaa22; }
                                .tw-start-btn:disabled { background:#333; color:#666; cursor:default; }
                                .tw-cash-btn { width:100%; background:linear-gradient(135deg,#ff9900,#cc7700); border:none; color:black; padding:14px; border-radius:8px; font-size:15px; font-weight:900; cursor:pointer; letter-spacing:0.5px; transition:0.2s; }
                                .tw-cash-btn:hover { background:linear-gradient(135deg,#ffaa22,#ff9900); }

                                /* Profit box */
                                .tw-profit-box { background:#000; border:1px solid #333; border-radius:8px; padding:10px 14px; display:flex; justify-content:space-between; align-items:center; font-size:13px; }
                                .tw-mult-big { font-size:32px; font-weight:900; color:var(--orange); text-align:center; line-height:1; }
                                .tw-sub-status { text-align:center; font-size:12px; color:#666; margin-top:4px; }

                                /* Arena */
                                .tw-arena { flex:1; background:radial-gradient(ellipse at center,#1a0d00 0%,#0a0500 60%,#000 100%); display:flex; align-items:center; justify-content:center; padding:20px; overflow:hidden; position:relative; }
                                .tw-arena::before, .tw-arena::after { content:''; position:absolute; top:0; bottom:0; width:55px; background:linear-gradient(180deg,#1a0d00 0%,#120900 40%,#0a0500 100%); border:2px solid #3a2000; border-top:none; border-bottom:none; box-shadow:inset 0 0 20px rgba(255,153,0,0.05); }
                                .tw-arena::before { left:30px; border-radius:6px 6px 0 0; }
                                .tw-arena::after  { right:30px; border-radius:6px 6px 0 0; }

                                /* Board */
                                .tw-board-outer { position:relative; z-index:2; background:#0d0800; border:2px solid #3a2000; border-radius:6px; padding:6px; box-shadow:0 0 60px rgba(0,0,0,0.9),0 0 30px rgba(255,153,0,0.05); width:min(500px,calc(100% - 140px)); height:min(590px,calc(100% - 20px)); display:flex; flex-direction:column; gap:4px; box-sizing:border-box; }

                                /* Rows */
                                .tw-row { display:flex; gap:4px; flex:1; min-height:0; }

                                /* Tiles */
                                .tw-tile { flex:1; min-width:0; min-height:0; border-radius:5px; display:flex; align-items:flex-end; justify-content:center; padding-bottom:5px; font-size:20px; cursor:default; position:relative; overflow:hidden; transition:transform 0.12s,border-color 0.12s,box-shadow 0.12s,opacity 0.2s; border:1.5px solid #3a2000; }
                                .tw-tile::before { content:''; position:absolute; inset:0; background:repeating-linear-gradient(0deg,transparent,transparent 18px,rgba(0,0,0,0.35) 18px,rgba(0,0,0,0.35) 19px),repeating-linear-gradient(90deg,transparent,transparent 28px,rgba(0,0,0,0.25) 28px,rgba(0,0,0,0.25) 29px); pointer-events:none; border-radius:4px; }
                                .tw-tile-badge { position:relative; z-index:2; font-size:10px; font-weight:800; color:var(--orange); background:rgba(20,10,0,0.85); border:1px solid rgba(255,153,0,0.35); border-radius:20px; padding:2px 8px; letter-spacing:0.2px; pointer-events:none; white-space:nowrap; }
                                .tw-tile.tw-inactive { background:linear-gradient(160deg,#1a0e00 0%,#110900 100%); border-color:#2a1500; opacity:0.6; }
                                .tw-tile.tw-active { background:linear-gradient(160deg,#231200 0%,#1a0d00 100%); border-color:#4a2800; opacity:1; cursor:pointer; }
                                .tw-tile.tw-active .tw-tile-badge { color:#ffcc44; background:rgba(30,15,0,0.9); border-color:rgba(255,153,0,0.7); box-shadow:0 0 8px rgba(255,153,0,0.3); }
                                .tw-tile.tw-active:hover { background:linear-gradient(160deg,#3a2000 0%,#2a1500 100%); border-color:var(--orange); box-shadow:0 0 16px rgba(255,153,0,0.4); transform:scale(1.03); }
                                .tw-tile.tw-gem { background:linear-gradient(160deg,#0d3a20 0%,#0a2818 100%); border-color:#27ae60; box-shadow:0 0 14px rgba(39,174,96,0.4); cursor:default; animation:twReveal 0.25s ease; }
                                .tw-tile.tw-gem .tw-tile-badge { color:#4ade80; background:rgba(5,30,15,0.85); border-color:rgba(39,174,96,0.5); }
                                .tw-tile.tw-bomb { background:linear-gradient(160deg,#3a0d0d 0%,#280808 100%); border-color:#e74c3c; box-shadow:0 0 14px rgba(231,76,60,0.4); cursor:default; animation:twReveal 0.25s ease; }
                                .tw-tile.tw-safe { background:linear-gradient(160deg,#110900 0%,#0a0500 100%); border-color:#1a0a00; opacity:0.25; cursor:default; }
                                @keyframes twReveal { from { transform:scale(0.85); opacity:0; } to { transform:scale(1); opacity:1; } }
                            </style>

                            <div class="tw-wrap">
                                <!-- ‚îÄ‚îÄ Left panel ‚îÄ‚îÄ -->
                                <div class="tw-panel">
                                    <div class="tw-panel-title">üè∞ Tower</div>

                                    <div class="tw-profit-box">
                                        <span style="color:#888; font-size:12px;">Session Profit</span>
                                        <span class="profit-val zero" id="t-profit" style="font-weight:700;">+0 ‚≠ê</span>
                                    </div>

                                    <div>
                                        <div class="tw-label">Bet Amount</div>
                                        <div class="tw-bet-row">
                                            <input type="number" id="t-bet" value="50" min="50" max="1000">
                                            <div class="tw-bet-half-2x">
                                                <button onclick="document.getElementById('t-bet').value=Math.max(50,Math.floor(parseInt(document.getElementById('t-bet').value||50)/2))">¬Ω</button>
                                                <button onclick="document.getElementById('t-bet').value=Math.min(1000,parseInt(document.getElementById('t-bet').value||50)*2)">2√ó</button>
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <div class="tw-label">Risk</div>
                                        <div class="tw-risk-wrap" id="tw-risk-wrap">
                                            <div id="tw-risk-display" onclick="toggleRiskDropdown()" style="display:flex;align-items:center;justify-content:space-between;background:#1a1a1a;border:1px solid #333;border-radius:8px;padding:11px 14px;cursor:pointer;font-weight:700;color:white;font-size:14px;">
                                                <span id="tw-risk-label">Medium</span>
                                                <span style="color:#ff9900;font-size:10px;" id="tw-risk-arrow">‚ñº</span>
                                            </div>
                                            <div class="tw-risk-dropdown" id="tw-risk-dropdown">
                                                <div class="tw-risk-option" onclick="selectRisk('easy','Easy')">
                                                    <span>Easy</span>
                                                    <span class="tw-risk-icons"><div class="tw-icon-gem"></div><div class="tw-icon-gem"></div><div class="tw-icon-gem"></div><div class="tw-icon-bomb"></div></span>
                                                </div>
                                                <div class="tw-risk-option selected" id="tw-opt-medium" onclick="selectRisk('medium','Medium')">
                                                    <span>Medium</span>
                                                    <span class="tw-risk-icons"><div class="tw-icon-gem"></div><div class="tw-icon-gem"></div><div class="tw-icon-bomb"></div></span>
                                                </div>
                                                <div class="tw-risk-option" onclick="selectRisk('hard','Hard')">
                                                    <span>Hard</span>
                                                    <span class="tw-risk-icons"><div class="tw-icon-gem"></div><div class="tw-icon-bomb"></div></span>
                                                </div>
                                                <div class="tw-risk-option" onclick="selectRisk('expert','Expert')">
                                                    <span>Expert</span>
                                                    <span class="tw-risk-icons"><div class="tw-icon-gem"></div><div class="tw-icon-bomb"></div><div class="tw-icon-bomb"></div></span>
                                                </div>
                                                <div class="tw-risk-option" onclick="selectRisk('master','Master')">
                                                    <span>Master</span>
                                                    <span class="tw-risk-icons"><div class="tw-icon-gem"></div><div class="tw-icon-bomb"></div><div class="tw-icon-bomb"></div><div class="tw-icon-bomb"></div></span>
                                                </div>
                                            </div>
                                            <!-- hidden select for compatibility -->
                                            <select id="t-risk" style="display:none;">
                                                <option value="easy">Easy</option>
                                                <option value="medium" selected>Medium</option>
                                                <option value="hard">Hard</option>
                                                <option value="expert">Expert</option>
                                                <option value="master">Master</option>
                                            </select>
                                        </div>
                                    </div>

                                    <button class="tw-start-btn" id="t-start" onclick="startTower()">‚ñ∂ Bet</button>
                                    <button id="t-cash" class="tw-cash-btn hidden" onclick="cashoutTower()">üí∞ Cash Out</button>

                                    <div>
                                        <div class="tw-label">Total Profit (<span id="t-mult-disp">1.00√ó</span>)</div>
                                        <div class="tw-bet-row" style="pointer-events:none;">
                                            <input type="text" id="t-profit-disp" value="0.00 ‚≠ê" style="color:var(--orange);" readonly>
                                        </div>
                                    </div>

                                    <div class="tw-sub-status" id="tower-status">Place your bet and start</div>
                                </div>

                                <!-- ‚îÄ‚îÄ Arena ‚îÄ‚îÄ -->
                                <div class="tw-arena">
                                    <div class="tw-board-outer" id="tower-board"></div>
                                </div>
                            </div>
                        </div>

                        <div id="game-royaljelly" class="hidden">
                            <style>
                                .rj-wrap { display:flex; gap:20px; flex-wrap:wrap; padding:10px; justify-content:center; }
                                .rj-card { background:#111; border:2px solid #333; border-radius:16px; padding:20px; text-align:center; min-width:180px; flex:1; max-width:220px; position:relative; }
                                .rj-bee-icon { font-size:48px; margin-bottom:8px; display:flex; align-items:center; justify-content:center; min-height:56px; }
                                .rj-bee-icon img { width:56px; height:56px; object-fit:contain; image-rendering:pixelated; }
                                .rj-bee-name { font-size:16px; font-weight:900; color:#f1c40f; }
                                .rj-bee-rarity { font-size:11px; text-transform:uppercase; letter-spacing:1px; margin:4px 0; }
                                .rj-bee-coins { font-size:20px; font-weight:bold; }
                                .rj-vs { display:flex; flex-direction:column; align-items:center; justify-content:center; font-size:28px; font-weight:900; color:var(--orange); }
                                .rj-result { text-align:center; margin-top:16px; padding:12px; border-radius:8px; font-weight:900; font-size:18px; }
                                .rj-result.win { background:#0d3320; border:2px solid #27ae60; color:#2ecc71; }
                                .rj-result.lose { background:#3a0d0d; border:2px solid #e74c3c; color:#e74c3c; }
                                .rarity-rare { color:#3498db; }
                                .rarity-epic { color:#9b59b6; }
                                .rarity-legendary { color:#f1c40f; }
                                .rarity-mythic { color:#e91e8c; }
                                .rj-spin-btn { background:linear-gradient(135deg,#f1c40f,#e67e22); border:none; color:#000; padding:14px 30px; border-radius:10px; font-size:16px; font-weight:900; cursor:pointer; margin-top:16px; width:100%; max-width:300px; letter-spacing:1px; }
                                .rj-spin-btn:disabled { opacity:0.5; cursor:not-allowed; }
                                .rj-bee-card-anim { transition:transform 0.3s; }
                                .rj-bee-card-anim.spinning { animation: beeSpin 0.6s ease-in-out; }
                                @keyframes beeSpin { 0%{transform:scale(0.8) rotateY(0)} 50%{transform:scale(1.1) rotateY(180deg)} 100%{transform:scale(1) rotateY(360deg)} }
                            </style>
                            <div style="text-align:center; margin-bottom:16px;">
                                <h2 style="color:#f1c40f; margin:0;">üêù ROYAL JELLY</h2>
                                <p style="color:#888; font-size:13px; margin:4px 0;">Your bee vs Bot bee ‚Äî highest coins wins! 1 coin = 0.01√ó multiplier</p>
                                <div class="profit-bar" style="max-width:400px;margin:8px auto;">
                                    <span style="color:#888;">Session Profit</span>
                                    <span class="profit-val zero" id="rj-profit">+0 ‚≠ê</span>
                                </div>
                            </div>
                            <div style="text-align:center; margin-bottom:12px;">
                                Bet: <input type="number" id="rj-bet" value="50" min="50" max="1000" style="width:90px; display:inline-block;">
                                <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('rj-bet').value=Math.max(50,Math.floor(parseInt(document.getElementById('rj-bet').value||50)/2))">¬Ω</button>
                                <button class="m-bet-btn" style="background:#1e2a3a;border:none;color:#aaa;padding:8px 12px;cursor:pointer;font-size:12px;font-weight:700;border-radius:4px;" onclick="document.getElementById('rj-bet').value=Math.min(1000,parseInt(document.getElementById('rj-bet').value||50)*2)">2√ó</button>
                            </div>
                            <div class="rj-wrap">
                                <div class="rj-card rj-bee-card-anim" id="rj-player-card">
                                    <div style="font-size:11px; color:#888; margin-bottom:8px;">YOUR BEE</div>
                                    <div class="rj-bee-icon" id="rj-p-icon">üêù</div>
                                    <div class="rj-bee-name" id="rj-p-name">???</div>
                                    <div class="rj-bee-rarity" id="rj-p-rarity">‚Äî</div>
                                    <div class="rj-bee-coins" id="rj-p-coins">‚Äî coins</div>
                                </div>
                                <div class="rj-vs">VS</div>
                                <div class="rj-card rj-bee-card-anim" id="rj-bot-card">
                                    <div style="font-size:11px; color:#888; margin-bottom:8px;">BOT BEE</div>
                                    <div class="rj-bee-icon" id="rj-b-icon">ü§ñ</div>
                                    <div class="rj-bee-name" id="rj-b-name">???</div>
                                    <div class="rj-bee-rarity" id="rj-b-rarity">‚Äî</div>
                                    <div class="rj-bee-coins" id="rj-b-coins">‚Äî coins</div>
                                </div>
                            </div>
                            <div id="rj-result" style="display:none;" class="rj-result"></div>
                            <div style="text-align:center;">
                                <button class="rj-spin-btn" id="rj-spin-btn" onclick="playRoyalJelly()">üçØ USE ROYAL JELLY</button>
                            </div>
                            <div style="text-align:center; margin-top:20px;">
                                <div style="font-size:11px; color:#555; max-width:500px; margin:0 auto; line-height:1.6;">
                                    Rarity chances: Rare 20% ¬∑ Epic 7% ¬∑ Legendary 3% ¬∑ Mythic 0.05%<br>
                                    Win = bet √ó (yourBee.coins √ó 0.01) ‚≠ê ¬∑ Lose = nothing back üíî
                                </div>
                            </div>
                        </div>

                        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê KILL A BUG GAME ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                        <div id="game-killabug" class="hidden">
                            <style>
                                .kab-container { max-width: 860px; margin: 0 auto; padding: 10px; }
                                .kab-title { font-size: 36px; font-weight: 900; text-align: center; letter-spacing: 4px; color: white; margin-bottom: 4px; }
                                .kab-title span { color: #e74c3c; }
                                .kab-subtitle { text-align: center; color: #555; font-size: 13px; letter-spacing: 3px; text-transform: uppercase; margin-bottom: 32px; }
                                .kab-section-label { font-size: 11px; letter-spacing: 4px; text-transform: uppercase; color: #555; margin-bottom: 14px; display: flex; align-items: center; gap: 12px; }
                                .kab-section-label::after { content: ''; flex: 1; height: 1px; background: #1e1e1e; }
                                .kab-bug-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 14px; margin-bottom: 28px; }
                                .kab-bug-card { background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 14px; padding: 24px 14px 20px; text-align: center; cursor: pointer; transition: all 0.25s; position: relative; overflow: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; }
                                .kab-bug-card[data-bug="ladybug"]:hover, .kab-bug-card[data-bug="ladybug"].kab-active { border-color: #e74c3c; box-shadow: 0 0 20px rgba(231,76,60,0.2); transform: translateY(-3px); }
                                .kab-bug-card[data-bug="spider"]:hover, .kab-bug-card[data-bug="spider"].kab-active { border-color: #9b59b6; box-shadow: 0 0 20px rgba(155,89,182,0.2); transform: translateY(-3px); }
                                .kab-bug-card[data-bug="beetle"]:hover, .kab-bug-card[data-bug="beetle"].kab-active { border-color: #f39c12; box-shadow: 0 0 20px rgba(243,156,18,0.2); transform: translateY(-3px); }
                                .kab-bug-emoji { width: 80px; height: 80px; margin: 0 auto 10px auto; display: block; transition: transform 0.3s; object-fit: contain; }
                                .kab-bug-card:hover .kab-bug-emoji, .kab-bug-card.kab-active .kab-bug-emoji { transform: scale(1.1) rotate(-5deg); }
                                .kab-bug-name { font-size: 17px; font-weight: 900; letter-spacing: 2px; margin-bottom: 5px; }
                                .kab-bug-card[data-bug="ladybug"] .kab-bug-name { color: #e74c3c; }
                                .kab-bug-card[data-bug="spider"] .kab-bug-name { color: #9b59b6; }
                                .kab-bug-card[data-bug="beetle"] .kab-bug-name { color: #f39c12; }
                                .kab-bug-meta { font-size: 12px; color: #555; line-height: 1.6; }
                                .kab-bug-meta span { color: #ccc; font-weight: 600; }
                                .kab-bug-badge { position: absolute; top: 9px; right: 9px; font-size: 9px; letter-spacing: 1px; padding: 3px 7px; border-radius: 4px; font-weight: 700; }
                                .kab-bug-card[data-bug="ladybug"] .kab-bug-badge { background: rgba(231,76,60,0.2); color: #e74c3c; border: 1px solid rgba(231,76,60,0.3); }
                                .kab-bug-card[data-bug="spider"] .kab-bug-badge { background: rgba(155,89,182,0.2); color: #9b59b6; border: 1px solid rgba(155,89,182,0.3); }
                                .kab-bug-card[data-bug="beetle"] .kab-bug-badge { background: rgba(243,156,18,0.2); color: #f39c12; border: 1px solid rgba(243,156,18,0.3); }
                                .kab-sel-check { position: absolute; top: 9px; left: 9px; width: 18px; height: 18px; border-radius: 50%; background: #2ecc71; display: flex; align-items: center; justify-content: center; font-size: 10px; opacity: 0; transform: scale(0); transition: all 0.2s; }
                                .kab-bug-card.kab-active .kab-sel-check { opacity: 1; transform: scale(1); }
                                .kab-bet-area { background: #1a1a1a; border: 1px solid #2a2a2a; border-radius: 14px; padding: 22px; margin-bottom: 20px; display: grid; grid-template-columns: 1fr auto; gap: 16px; align-items: end; }
                                .kab-bet-label-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; }
                                .kab-bet-label { font-size: 11px; letter-spacing: 3px; text-transform: uppercase; color: #555; }
                                .kab-min-badge { font-size: 11px; color: #555; background: #151515; padding: 3px 8px; border-radius: 4px; border: 1px solid #222; }
                                .kab-min-badge span { color: var(--orange); }
                                .kab-input-wrap { display: flex; align-items: center; background: #050505; border: 1px solid #2a2a2a; border-radius: 9px; overflow: hidden; transition: border-color 0.2s; }
                                .kab-input-wrap:focus-within { border-color: var(--orange); box-shadow: 0 0 0 2px rgba(255,153,0,0.1); }
                                .kab-currency { padding: 0 12px; color: #f1c40f; font-size: 17px; font-weight: 700; }
                                .kab-input { flex: 1; background: transparent; border: none; outline: none; color: white; font-size: 20px; padding: 12px 0; min-width: 0; }
                                .kab-quickbtns { display: flex; gap: 5px; padding-right: 8px; }
                                .kab-qbtn { background: #1a1a1a; border: 1px solid #2a2a2a; color: #555; font-size: 11px; font-weight: 700; padding: 5px 8px; border-radius: 5px; cursor: pointer; transition: all 0.15s; }
                                .kab-qbtn:hover { background: rgba(255,153,0,0.1); border-color: var(--orange); color: var(--orange); }
                                .kab-kill-btn { background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; border: none; border-radius: 11px; padding: 0 36px; height: 54px; font-size: 16px; font-weight: 900; letter-spacing: 2px; cursor: pointer; transition: all 0.2s; white-space: nowrap; }
                                .kab-kill-btn:hover:not(:disabled) { transform: scale(1.04); box-shadow: 0 6px 20px rgba(231,76,60,0.4); }
                                .kab-kill-btn:disabled { opacity: 0.4; cursor: not-allowed; transform: none; }
                                .kab-error { font-size: 12px; color: #e74c3c; margin-top: 6px; display: none; }
                                .kab-error.visible { display: block; }
                                .kab-arena { background: #071a07; border: 1px solid #1a3d1a; border-radius: 14px; min-height: 130px; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; transition: border-color 0.3s, box-shadow 0.3s; position: relative; overflow: hidden; }
                                .kab-arena-idle { text-align: center; color: #333; }
                                .kab-arena-idle .idle-icon { font-size: 40px; display: block; margin-bottom: 8px; }
                                .kab-arena-idle p { font-size: 13px; letter-spacing: 1px; }
                                .kab-arena-live { display: flex; align-items: center; gap: 20px; padding: 20px; }
                                .kab-arena-bug { animation: kabBugFloat 2s ease-in-out infinite; }
                                @keyframes kabBugFloat { 0%,100% { transform: translateY(0) rotate(-5deg); } 50% { transform: translateY(-8px) rotate(5deg); } }
                                .kab-arena-bug-name { font-size: 22px; font-weight: 900; letter-spacing: 3px; }
                                .kab-arena-bug-desc { font-size: 12px; color: #555; margin-top: 4px; }
                                .kab-arena-kill { text-align: center; padding: 20px; }
                                .kab-splat { font-size: 52px; animation: kabSplat 0.4s cubic-bezier(0.175,0.885,0.32,1.275); }
                                @keyframes kabSplat { 0% { transform: scale(0) rotate(-20deg); } 100% { transform: scale(1) rotate(0deg); } }
                                .kab-kill-text { font-size: 22px; font-weight: 900; letter-spacing: 4px; color: #e74c3c; margin-top: 8px; animation: kabPulse 0.5s ease; }
                                @keyframes kabPulse { 0%,100% { opacity: 1; } 50% { opacity: 0.5; } }
                                .kab-arena-elim { text-align: center; padding: 20px; }
                                .kab-elim-emoji { width: 64px; height: 64px; display: block; margin: 0 auto; animation: kabElimShake 0.55s ease; }
                                @keyframes kabElimShake { 0%,100%{transform:rotate(0) scale(1)} 20%{transform:rotate(-15deg) scale(1.25)} 45%{transform:rotate(18deg) scale(1.3)} 65%{transform:rotate(-10deg) scale(1.15)} 80%{transform:rotate(8deg) scale(1.05)} }
                                .kab-elim-text { font-size: 22px; font-weight: 900; letter-spacing: 4px; color: #e74c3c; margin-top: 10px; animation: kabPulse 0.5s ease; }
                                .kab-elim-sub { font-size: 11px; color: #555; margin-top: 6px; letter-spacing: 2px; text-transform: uppercase; }
                                .kab-tokens-area { margin-bottom: 20px; }
                                .kab-tokens-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
                                .kab-tokens-title { font-size: 13px; font-weight: 700; color: var(--orange); letter-spacing: 1px; }
                                .kab-tokens-total { font-size: 13px; color: #555; }
                                .kab-tokens-total span { color: #f1c40f; font-weight: 700; }
                                .kab-tokens-grid { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 16px; }
                                .kab-token { width: 68px; height: 68px; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; background: var(--kab-tok-color, #ff9900); border: 3px solid rgba(0,0,0,0.3); box-shadow: 0 4px 14px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.15); animation: kabTokenPop 0.35s cubic-bezier(0.175,0.885,0.32,1.275); }
                                @keyframes kabTokenPop { 0% { transform: scale(0) rotate(-15deg); opacity: 0; } 80% { transform: scale(1.12) rotate(3deg); } 100% { transform: scale(1) rotate(0); opacity: 1; } }
                                .kab-token .tok-mult { font-size: 14px; font-weight: 900; color: #000; font-family: monospace; line-height: 1; }
                                .kab-token .tok-label { font-size: 7px; color: rgba(0,0,0,0.55); letter-spacing: 1px; font-weight: 700; margin-top: 2px; }
                                .kab-result-banner { background: #0f0f0f; border: 1px solid #1e1e1e; border-radius: 12px; padding: 18px 22px; display: flex; justify-content: space-between; align-items: center; }
                                .kab-result-banner.kab-win { border-color: #2ecc71; background: #091a0f; }
                                .kab-result-banner.kab-loss { border-color: #e74c3c; background: #1a0909; }
                                .kab-result-label { font-size: 11px; color: #555; letter-spacing: 2px; margin-bottom: 4px; }
                                .kab-result-amount { font-size: 26px; font-weight: 900; }
                                .kab-result-banner.kab-win .kab-result-amount { color: #2ecc71; }
                                .kab-result-banner.kab-loss .kab-result-amount { color: #e74c3c; }
                                .kab-result-mult { font-size: 12px; color: #555; margin-top: 2px; }
                                .kab-result-mult span { color: #ccc; }
                                .kab-history { margin-top: 20px; }
                                .kab-history-header { font-size: 13px; font-weight: 700; color: #555; letter-spacing: 2px; text-transform: uppercase; margin-bottom: 10px; }
                                .kab-history-table { width: 100%; border-collapse: collapse; font-size: 12px; }
                                .kab-history-table th { padding: 6px 10px; color: #333; text-align: left; font-size: 10px; letter-spacing: 1px; border-bottom: 1px solid #1a1a1a; }
                                .kab-history-table td { padding: 6px 10px; border-bottom: 1px solid #111; }
                                .kab-col-win { color: #2ecc71; font-weight: 700; font-family: monospace; }
                                .kab-col-loss { color: #e74c3c; font-weight: 700; font-family: monospace; }
                                .kab-col-mult { font-family: monospace; color: #3498db; }
                                .kab-history-empty { color: #333; font-size: 12px; padding: 16px 10px; }
                            </style>
                            <div class="kab-container">
                                <h2 class="kab-title">Kill A <span>Bug</span></h2>
                                <p class="kab-subtitle">Select ¬∑ Bet ¬∑ Eliminate ¬∑ Collect</p>

                                <p class="kab-section-label">Choose your target</p>
                                <div class="kab-bug-grid">
                                    <div class="kab-bug-card" data-bug="ladybug" onclick="kabSelectBug('ladybug')">
                                        <div class="kab-sel-check">‚úì</div>
                                        <span class="kab-bug-badge">EASY</span>
                                        <img class="kab-bug-emoji" src="data:image/png;base64,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" alt="Ladybug" width="80" height="80" style="object-fit:contain;">
                                        <div class="kab-bug-name">Ladybug</div>
                                        <div class="kab-bug-meta"><span>5</span> tokens/kill<br>Min bet: <span>50</span> ‚≠ê<br><span style="color:#e74c3c">20%</span> elim ¬∑ <span style="color:#888">5%</span> zero token</div>
                                    </div>
                                    <div class="kab-bug-card" data-bug="spider" onclick="kabSelectBug('spider')">
                                        <div class="kab-sel-check">‚úì</div>
                                        <span class="kab-bug-badge">MEDIUM</span>
                                        <img class="kab-bug-emoji" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAHSUlEQVR4nO3dP3IbNxTH8XUmKawmRdQ6VSamy7j2JXIH5Q45Qu4Q3SGXUO2Ukj2p4lYp0tCFMqMUHox2oAUWfx6wDw/fT6OxRZHAA34ESO4ulwUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKC3q9PF49FtwLyk59/Xknfm+I28vju/aPE4o/vl7bfJg/n7+3+p4YbWT8jiRU9p8MyByQlFyMxh6T2/mheawMRD8eN3+4v4x3/+C/7OeliOnj/di3t0h3vzw5ESiD1+YCyFRNv8OLyw2goipUUwfBaCon381RVUe8FSrMPRIhi+dVC0h2S08VXTkJBRCvrX5btn7fzjp9tuj//zn2+e/d8P9zeH12WU8QtR27AQbQXfCoavZVC2guHrGRRt41NrmIaGHDkgKeFwWoQkJRxOq5BYC4Rv2IaH9BqwnHA4kiHJCYcjERLrgfCZ6UhIiwEtCYcjEZKScDi5IZktEL72b7EczB+8rQHn0JgnswfCN01HQ3InRM3q4dSsIjWrh7NeRQhE3LQdD0mZML/ev616jCMD8tvl+93bzBwIn/ktVq6ULZk/yWoD0xKBqENAdowWGAIhi4Bk8if/1oTsGZiUQPiPf73ctGqOOTyTFIi9UE+ZsK9fvSx+7A+fPu/eJhZIDYefjIRiFch5J6s2MLWB8BGQPBSrUOkn6SkTfs/rVy8P+yR9NhSsgsSxWCmBCa0wGo7Fso6iVZI+mvfDp89Zr1G0Hc1rDYUTwvkgNlFAQe5Mwh5nEYa4swu1n1k4CooorPfpts5Ip92O5KujG2DNenLGLtcjiXC0QzEb4aomNlDQxrgu1tgobAdcWXFcycW9Ol08chRoPa7Nq0PqfM4KSMrtCFG6d9+nX5n85m/qmkpyroq/cuQUzricUIT+buaw9P7+GdFCSzbeUohioXhz+c3u39/ePwR/ZyksGuePyqu7p9Ieoq1gpARiz1ZgtAdl1HFXWdRRi7nmh0MiGD4/KEeFxMJ4hahqTA6tg9IjGL6WQdFa516Ga3CO3oO7DkePYPjWQUkJyeyTP4XJTuWQnCR35y8/jwiH40JyupC7T6uTP8W0Hc8hGaIXF/XheTyH39XKNfPkT0FxKrltleQzthS3oml/h0szClfBhSN1SyX5zJ+6ErktFyEpQ9EK5YYj1eP5QWQbtkZIynHCVIHSw0VSSIdjrWW7rSIgFY58tyrHKO3UiIBkarW1as21l1UkDwHJYGVyWelHDwSkwGirhzNqu49EQBKNurXysdXKQ0CACAKSwMrq4bCKpCMgQAQBASIIyA5r2yuHbVYaAgJEEBAggoBEWN1eOWyz9hEQIIKAABEEBIggIAHWX384vA6JIyBABAEBIggIEEFAgAgCAkQQECCCgAARBASIICBABAFRRvIC16gn/jXQyOeHYv3vltfqxT4CcqCU1cLdhqAcg8vhR7Q4YDEUiq0A5Ny2FF+NEMcK0kFspYhNdvc7tmDHISANSa0A69uHwkJQ2iAgwlpvi0JhYVVpg33njpTXIaVbKCmlj8/rj32sIBV6vIhOwRasHQKSSUsoQtiCyWJpTXB1Cp+vPcJki23Bru/YXsVQnIhQMEYIRUgoLARlG0XxhEJxd7Z1hZPb+4fldLH9O8LyhEIs8S2UmyyWLgPkv3uV0v9ZTf0iPTQxZpsU6/76NXH/nq0mznSdrgmFhVUk57MPnkAmCYjUFmJ99cERQ+LCsSx5Hw7OvAUz3bkWz4AjryISn5zPtqqY61SPARwxJC0OK5khLCY60nsLMNpWq3RrlcryFmzoxh/5DNZqFXk8P4h/ENnzoERrq8pwjdY0AFIhaXk08JFH7Goaq1JDNFTzEl4akpKrl+SGRcvh7JrHb4/qxo3yDJQaktyVomZl0RIO3yhj6qhr1GgFdEIv3KW2T6n30/oFuaQRxlpFQ0ZegtdcSEIHAS6LzJHAsbDcnb/81B6ONc3jr3JvenRRShx1zoi1cz20zQne2agQC4V7JndafF6y3k4tS3zlslTfnn3p8kCal9BcOX3Z+uZYiaD4wViW51uqWWsuremda3gGkFA7QLGvWE4JzFYgnJqjcpfFzli06ke3ww6sDMSyyBzsWKPFwYbLYmeMJPvRPCAjFf3IY7r2cAxVWMs516ToIxd3baR+1LJSB+n5N0zHJVmZDK1QnyfTdJZBLzN73Ux3cPbBlTZjPc11asZBPMIsdTbRkVkGSyvL9R+28ZYHZWTWxmWoBlsrvnUWxkt9Iy0UGeOOo8qGjVpMpBlpfNU0ZqSiQY72cVd5wtSy6CgO+tI4H9ScMLUshAJPtMwTTpiCeiZPmCIUaKH3vBK9Q0KBnnrMt+o7IRTQoNU8LPpDQgHNJOcn3zIE02rnbfGXeBIKjCD2BaWimt450BnzGQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAbf8DrAxhwmv7OAcAAAAASUVORK5CYII=" alt="Spider" width="80" height="80" style="object-fit:contain;">
                                        <div class="kab-bug-name">Spider</div>
                                        <div class="kab-bug-meta"><span>7</span> tokens/kill<br>Min bet: <span>100</span> ‚≠ê<br><span style="color:#e74c3c">40%</span> elim ¬∑ <span style="color:#888">10%</span> zero token</div>
                                    </div>
                                    <div class="kab-bug-card" data-bug="beetle" onclick="kabSelectBug('beetle')">
                                        <div class="kab-sel-check">‚úì</div>
                                        <span class="kab-bug-badge">HARD</span>
                                        <img class="kab-bug-emoji" src="data:image/png;base64,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" alt="Beetle" width="80" height="80" style="object-fit:contain;">
                                        <div class="kab-bug-name">King Beetle</div>
                                        <div class="kab-bug-meta"><span>10</span> tokens/kill<br>Min bet: <span>300</span> ‚≠ê<br><span style="color:#e74c3c">60%</span> elim ¬∑ <span style="color:#888">15%</span> zero token</div>
                                    </div>
                                </div>

                                <p class="kab-section-label">Place your bet</p>
                                <div class="kab-bet-area">
                                    <div>
                                        <div class="kab-bet-label-row">
                                            <span class="kab-bet-label">Bet Amount</span>
                                            <span class="kab-min-badge" id="kabMinBet">Min: <span>50</span> ‚≠ê</span>
                                        </div>
                                        <div class="kab-input-wrap" id="kabInputWrap">
                                            <span class="kab-currency">‚≠ê</span>
                                            <input class="kab-input" id="kabBetInput" type="number" value="50" min="1">
                                            <div class="kab-quickbtns">
                                                <button class="kab-qbtn" onclick="kabMultBet(2)">√ó2</button>
                                                <button class="kab-qbtn" onclick="kabMultBet(0.5)">¬Ω</button>
                                                <button class="kab-qbtn" onclick="kabMaxBet()">MAX</button>
                                            </div>
                                        </div>
                                        <div class="kab-error" id="kabError"></div>
                                    </div>
                                    <button class="kab-kill-btn" id="kabKillBtn" onclick="kabKill()" disabled>‚ò†Ô∏è KILL IT</button>
                                </div>

                                <p class="kab-section-label">Arena</p>
                                <div class="kab-arena" id="kabArena">
                                    <div class="kab-arena-idle" id="kabArenaIdle">
                                        <span class="idle-icon">üéØ</span>
                                        <p>Select a bug target above to begin</p>
                                    </div>
                                    <div class="kab-arena-live hidden" id="kabArenaLive">
                                        <div class="kab-arena-bug" id="kabArenaBug">
                                            <img id="kabArenaBugImg" src="data:image/png;base64,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" alt="Bug" width="72" height="72" style="object-fit:contain;">
                                        </div>
                                        <div>
                                            <div class="kab-arena-bug-name" id="kabArenaBugName">LADYBUG</div>
                                            <div class="kab-arena-bug-desc">Ready to be eliminated</div>
                                        </div>
                                    </div>
                                    <div class="kab-arena-kill hidden" id="kabArenaKill">
                                        <div class="kab-splat">üíÄ</div>
                                        <div class="kab-kill-text">ELIMINATED!</div>
                                    </div>
                                    <div class="kab-arena-elim hidden" id="kabArenaElim">
                                        <span class="kab-elim-emoji" id="kabElimEmoji">
                                            <img src="image_3.png" alt="Eliminated" width="64" height="64" style="object-fit:contain;">
                                        </span>
                                        <div class="kab-elim-text">YOU GOT ELIMINATED!</div>
                                        <div class="kab-elim-sub" id="kabElimSub">The bug fought back ‚Äî bet lost</div>
                                    </div>
                                </div>

                                <div class="kab-tokens-area hidden" id="kabTokensArea">
                                    <div class="kab-tokens-header">
                                        <span class="kab-tokens-title">‚ö° Tokens Collected</span>
                                        <span class="kab-tokens-total" id="kabTokensTotal">Total multiplier: <span>0√ó</span></span>
                                    </div>
                                    <div class="kab-tokens-grid" id="kabTokensGrid"></div>
                                    <div class="kab-result-banner" id="kabResultBanner">
                                        <div>
                                            <div class="kab-result-label" id="kabResultLabel">REWARD</div>
                                            <div class="kab-result-amount" id="kabResultAmount">+0</div>
                                            <div class="kab-result-mult" id="kabResultMult"></div>
                                        </div>
                                        <div style="text-align:right;">
                                            <div style="font-size:11px;color:#555;letter-spacing:1px;margin-bottom:6px;">NEW BALANCE</div>
                                            <div style="font-family:monospace;font-size:18px;color:#f1c40f" id="kabNewBalance">0</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="kab-history">
                                    <div class="kab-history-header">Recent Kills</div>
                                    <table class="kab-history-table">
                                        <thead><tr><th>Bug</th><th>Bet</th><th>Total √ó</th><th>Reward</th><th>Balance</th></tr></thead>
                                        <tbody id="kabHistoryBody"><tr><td colspan="5" class="kab-history-empty">No kills yet. Select a bug and start hunting!</td></tr></tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê END KILL A BUG ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

                        <div id="game-beequip" class="hidden">
                            <style>
                                .bw-wrap { display:flex; gap:30px; padding:10px; flex-wrap:wrap; }
                                .bw-left { flex:1; min-width:280px; }
                                .bw-right { flex:1; min-width:280px; }
                                .bw-title { font-size:28px; font-weight:900; color:#f1c40f; text-align:center; letter-spacing:2px; margin-bottom:4px; }
                                .bw-sub { color:#aaa; text-align:center; font-size:12px; margin-bottom:20px; }
                                .bq-select-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-bottom:20px; }
                                .bq-card { background:#111; border:2px solid #333; border-radius:12px; padding:12px 8px; text-align:center; cursor:pointer; transition:0.2s; }
                                .bq-card:hover, .bq-card.selected { border-color:#f1c40f; background:#1a1a00; }
                                .bq-card .bq-icon { font-size:30px; margin-bottom:6px; }
                                .bq-card .bq-name { font-size:11px; font-weight:bold; color:#f1c40f; }
                                .bq-card .bq-cost { font-size:10px; color:#888; }
                                .bq-active { background:#111; border:2px solid #f1c40f; border-radius:14px; padding:16px; margin-bottom:16px; }
                                .bq-active-header { display:flex; align-items:center; gap:14px; margin-bottom:12px; }
                                .bq-active-icon { font-size:40px; background:#000; border-radius:10px; padding:8px 12px; border:1px solid #333; }
                                .bq-active-name { font-size:20px; font-weight:900; color:white; }
                                .bq-active-pot { font-size:12px; color:#f1c40f; }
                                .bq-slots { display:flex; gap:6px; margin-bottom:10px; }
                                .bq-slot { width:36px; height:36px; background:#222; border:1px solid #444; border-radius:6px; display:flex; align-items:center; justify-content:center; font-size:16px; }
                                .bq-slot.used-soft { background:#1a3a00; border-color:#27ae60; }
                                .bq-slot.used-hard { background:#1a1a3a; border-color:#3498db; }
                                .bq-slot.used-caustic { background:#2a0000; border-color:#e74c3c; }
                                .bq-slot.used-swirled { background:#1a002a; border-color:#9b59b6; }
                                .bq-stats { background:#0a0a1a; border-radius:8px; padding:10px 14px; font-size:13px; }
                                .bq-stat-pos { color:#2ecc71; margin:3px 0; }
                                .bq-stat-neg { color:#e74c3c; margin:3px 0; }
                                .bq-stat-neutral { color:#f1c40f; margin:3px 0; }
                                .wax-grid { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-bottom:16px; }
                                .wax-btn { background:#111; border:2px solid #333; border-radius:12px; padding:14px 10px; text-align:center; cursor:pointer; transition:0.2s; }
                                .wax-btn:hover { border-color:#f1c40f; }
                                .wax-btn.wax-soft { border-color:#27ae60; }
                                .wax-btn.wax-hard { border-color:#3498db; }
                                .wax-btn.wax-caustic { border-color:#e74c3c; }
                                .wax-btn.wax-swirled { border-color:#9b59b6; }
                                .wax-icon { font-size:28px; margin-bottom:4px; }
                                .wax-name { font-weight:900; font-size:13px; }
                                .wax-desc { font-size:10px; color:#888; margin:3px 0; }
                                .wax-cost { font-size:11px; color:#f1c40f; font-weight:bold; }
                                .bw-log { background:#000; border:1px solid #222; border-radius:8px; padding:12px; font-size:12px; color:#aaa; min-height:80px; max-height:160px; overflow-y:auto; }
                                .bw-log .log-good { color:#2ecc71; }
                                .bw-log .log-bad { color:#e74c3c; }
                                .bw-log .log-info { color:#f1c40f; }
                                .bw-log .log-purple { color:#9b59b6; }
                                .bq-destroyed { opacity:0.4; pointer-events:none; }
                                .bw-inv { display:flex; gap:10px; margin-bottom:12px; flex-wrap:wrap; align-items:center; }
                                .bw-inv-item { background:#111; border:1px solid #333; border-radius:8px; padding:6px 12px; font-size:12px; color:white; }
                            </style>

                            <div class="bw-title">üêù BEEQUIP WAXING</div>
                            <div class="bw-sub">Wax your beequip to boost its stats ¬∑ Max 5 waxes per beequip</div>

                            <div id="bw-shop" class="">
                                <div style="text-align:center; color:#888; font-size:13px; margin-bottom:12px;">Choose a Beequip to wax (Cost in ‚≠ê Stars)</div>
                                <div class="bq-select-grid" id="bq-shop-grid"></div>
                            </div>

                            <div id="bw-main" class="hidden">
                                <div class="bw-wrap">
                                    <div class="bw-left">
                                        <div class="bq-active" id="bq-active-card">
                                            <div class="bq-active-header">
                                                <div class="bq-active-icon" id="bq-disp-icon">ü•Å</div>
                                                <div>
                                                    <div class="bq-active-name" id="bq-disp-name">Toy Drum</div>
                                                    <div class="bq-active-pot" id="bq-disp-pot">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ ¬∑ Potential: 0/10</div>
                                            <div id="bq-hive-bonus" style="font-size:11px; color:#9b59b6; margin-top:2px;">üè† Hive Bonus: 0 ¬∑ Sell Mult: 1.00x</div>
                                                </div>
                                            </div>
                                            <div style="font-size:11px; color:#666; margin-bottom:6px;">Waxes Used: <span id="bq-wax-count">0</span>/5</div>
                                            <div class="bq-slots" id="bq-slots"></div>
                                            <div class="bq-stats" id="bq-stats-display"></div>
                                        </div>
                                        <button class="btn-play" style="background:#444; color:white; width:100%; margin-bottom:10px;" onclick="bwSellBeequip()">üí∞ Sell Beequip</button>
                                        <button class="btn-play" style="background:#222; color:#888; width:100%; margin-bottom:10px;" onclick="bwBack()">‚Üê Back to Shop</button>
                                    </div>
                                    <div class="bw-right">

                                        <div class="wax-grid">
                                            <div class="wax-btn wax-soft" onclick="applyWax('soft')">
                                                <img src="image_9__1_.png" alt="Soft Wax" width="48" height="48" style="object-fit:contain;">
                                                <div class="wax-name" style="color:#c8b400;">Soft Wax</div>
                                                <div class="wax-desc">100% improve ¬∑ +1 potential</div>
                                                <div class="wax-cost">Free</div>
                                            </div>
                                            <div class="wax-btn wax-hard" onclick="applyWax('hard')">
                                                <img src="image_7.png" alt="Hard Wax" width="48" height="48" style="object-fit:contain;">
                                                <div class="wax-name" style="color:#c0622a;">Hard Wax</div>
                                                <div class="wax-desc">30% improve ¬∑ +2 potential</div>
                                                <div class="wax-cost">Cost: 2 ‚≠ê</div>
                                            </div>
                                            <div class="wax-btn wax-caustic" onclick="applyWax('caustic')">
                                                <img src="image_8.png" alt="Caustic Wax" width="48" height="48" style="object-fit:contain;">
                                                <div class="wax-name" style="color:#27ae60;">Caustic Wax</div>
                                                <div class="wax-desc">20% GREAT ¬∑ 80% DESTROY</div>
                                                <div class="wax-cost" style="color:#e74c3c;">Cost: 20 ‚≠ê</div>
                                            </div>
                                            <div class="wax-btn wax-swirled" onclick="applyWax('swirled')">
                                                <svg width="48" height="48" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><circle cx="24" cy="24" r="16" fill="none" stroke="#9b59b6" stroke-width="2"/><path d="M16 24 Q24 16 32 24 Q24 32 16 24" fill="#9b59b6" opacity="0.6"/><circle cx="24" cy="24" r="3" fill="#9b59b6"/></svg>
                                                <div class="wax-name" style="color:#9b59b6;">Swirled Wax</div>
                                                <div class="wax-desc">Reroll all stats</div>
                                                <div class="wax-cost" style="color:#9b59b6;">Cost: 20 ‚≠ê</div>
                                            </div>
                                        </div>
                                        <div class="bw-log" id="bw-log"><span class="log-info">Select a wax to apply...</span></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="page-history" class="hidden">
                <div class="card">
                    <h2 style="color:var(--orange)">Live Bet History</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>GAME</th>
                                <th>BET</th>
                                <th>MULTIPLIER</th>
                                <th>PAYOUT</th>
                            </tr>
                        </thead>
                        <tbody id="history-body"></tbody>
                    </table>
                </div>
            </div>

            <div id="page-rakeback" class="hidden">
                <div class="card" style="text-align: center;">
                    <h2 style="color:var(--orange)">Promo Codes</h2>
                    <input type="text" id="promo-input" placeholder="ENTER CODE HERE..." style="width:300px;"><br><br>
                    <button class="btn-play" onclick="redeemCode()">Redeem Reward</button>
                </div>
            </div>

            <div id="page-admin" class="hidden">
                <div class="card">
                    <h2 style="color:var(--orange); margin-bottom:20px;">‚öôÔ∏è Admin Dashboard</h2>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
                        <div style="background:#111; padding:20px; border-radius:10px; border:1px solid #222;">
                            <h3 style="color:var(--orange); margin-top:0;">‚≠ê Give Stars</h3>
                            <input type="text" id="adm-target" placeholder="Discord ID or username" style="width:100%; box-sizing:border-box;"><br><br>
                            <input type="number" id="adm-amount" placeholder="Amount" style="width:100%; box-sizing:border-box;"><br><br>
                            <button class="btn-play" onclick="adminGiveChips()" style="width:100%;">SEND ‚≠ê</button>
                        </div>
                        <div style="background:#111; padding:20px; border-radius:10px; border:1px solid #e74c3c44;">
                            <h3 style="color:#e74c3c; margin-top:0;">üîÑ Reset Currency</h3>
                            <input type="text" id="adm-reset-target" placeholder="Discord ID or username" style="width:100%; box-sizing:border-box;"><br><br>
                            <input type="number" id="adm-reset-amount" placeholder="Set balance to (default: 0)" style="width:100%; box-sizing:border-box;"><br><br>
                            <button onclick="adminResetChips()" style="width:100%; background:#e74c3c; color:white; border:none; padding:12px 20px; border-radius:8px; font-weight:900; cursor:pointer;">RESET üíÄ</button>
                        </div>
                        <div style="background:#111; padding:20px; border-radius:10px; border:1px solid #222;">
                            <h3 style="color:var(--green); margin-top:0;">üéÅ Create Promo Code</h3>
                            <input type="text" id="new-code" placeholder="CODE" style="width:100%; box-sizing:border-box;"><br><br>
                            <input type="number" id="code-val" placeholder="Value (‚≠ê)" style="width:100%; box-sizing:border-box;"><br><br>
                            <button class="btn-play" onclick="createPromo()" style="width:100%; background:var(--green);">CREATE üéÅ</button>
                        </div>
                        <div style="background:#111; padding:20px; border-radius:10px; border:1px solid #222;">
                            <h3 style="color:#888; margin-top:0;">üìã Action Log</h3>
                            <div id="adm-log" style="background:#0a0a0a; border:1px solid #333; border-radius:8px; padding:10px; height:120px; overflow-y:auto; font-size:12px; color:#aaa; font-family:monospace;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    <footer class="site-footer">
        <div class="footer-brand">&#169; 2026 https://swarmbet.github.io/Home</div>
        <div class="footer-links"><a href="#" onclick="document.getElementById('tc-modal').style.display='flex'; return false;">Terms &amp; Conditions</a></div>
        <div class="footer-disclaimer">For entertainment purposes only. No real money involved.</div>
    </footer>
    </div>
</div>

<div id="win-container"></div>

<script>
    const DB_URL = "https://casbss-c75a0-default-rtdb.europe-west1.firebasedatabase.app/users";
    const PROMO_URL = "https://casbss-c75a0-default-rtdb.europe-west1.firebasedatabase.app/promos";
    
    let currentUser = localStorage.getItem('swarm_user');
    let userData = null;
    let betHistory = [];  // loaded per user in loginSuccess
    let audioReady = false;

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // DISCORD OAUTH2 SYSTEM
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    let DISCORD_CLIENT_ID = '1473435482590281862';
    let DISCORD_REDIRECT   = 'https://swarmbet.github.io/Home/';

    document.addEventListener('DOMContentLoaded', () => {
        const autoEl = document.getElementById('dc-auto-redirect');
        if(autoEl) autoEl.textContent = DISCORD_REDIRECT;
        if(document.getElementById('dc-client-id')) document.getElementById('dc-client-id').value = DISCORD_CLIENT_ID;
        if(document.getElementById('dc-redirect'))  document.getElementById('dc-redirect').value  = DISCORD_REDIRECT;
    });

    function discordLogin() {
        if(!DISCORD_CLIENT_ID) {
            const modal = document.getElementById('discord-config-modal');
            modal.style.display = 'flex';
            document.getElementById('dc-redirect').value = DISCORD_REDIRECT;
            document.getElementById('dc-auto-redirect').textContent = DISCORD_REDIRECT;
            return;
        }
        startDiscordOAuth();
    }

    function saveDiscordConfig() {
        const id  = document.getElementById('dc-client-id').value.trim();
        const red = document.getElementById('dc-redirect').value.trim();
        if(!id) { alert('Zadej Client ID!'); return; }
        if(!red) { alert('Zadej Redirect URI!'); return; }
        DISCORD_CLIENT_ID = id; DISCORD_REDIRECT = red;
        localStorage.setItem('swarm_dc_client_id', id);
        localStorage.setItem('swarm_dc_redirect', red);
        document.getElementById('discord-config-modal').style.display = 'none';
        startDiscordOAuth();
    }

    function startDiscordOAuth() {
        const state = Math.random().toString(36).substring(2, 15);
        localStorage.setItem('swarm_oauth_state', state);
        const params = new URLSearchParams({ client_id: DISCORD_CLIENT_ID, redirect_uri: DISCORD_REDIRECT, response_type: 'token', scope: 'identify', state });
        const statusEl = document.getElementById('discord-status');
        if(statusEl) statusEl.textContent = 'üîÑ P≈ôesmƒõrov√°n√≠ na Discord...';
        window.location.href = 'https://discord.com/oauth2/authorize?' + params.toString();
    }

    async function handleDiscordCallback() {
        const hash = window.location.hash.substring(1);
        if(!hash) return false;
        const params = new URLSearchParams(hash);
        const accessToken = params.get('access_token');
        const returnedState = params.get('state');
        const savedState = localStorage.getItem('swarm_oauth_state');
        if(!accessToken) return false;
        history.replaceState(null, '', window.location.pathname + window.location.search);
        if(returnedState && savedState && returnedState !== savedState) { alert('‚ùå OAuth state mismatch!'); return false; }
        localStorage.removeItem('swarm_oauth_state');
        const statusEl = document.getElementById('discord-status');
        if(statusEl) statusEl.textContent = '‚è≥ Z√≠sk√°v√°n√≠ Discord profilu...';
        try {
            const userRes = await fetch('https://discord.com/api/users/@me', { headers: { 'Authorization': 'Bearer ' + accessToken } });
            if(!userRes.ok) throw new Error('Discord API ' + userRes.status);
            const dcUser = await userRes.json();
            const discordUsername = 'discord_' + dcUser.id;
            const displayName = dcUser.username + (dcUser.discriminator && dcUser.discriminator !== '0' ? '#' + dcUser.discriminator : '');
            const avatarUrl = dcUser.avatar ? `https://cdn.discordapp.com/avatars/${dcUser.id}/${dcUser.avatar}.png` : `https://cdn.discordapp.com/embed/avatars/${parseInt(dcUser.id) % 6}.png`;
            const res = await fetch(`${DB_URL}/${discordUsername}.json`);
            let user = await res.json();
            if(!user) {
                user = { chips: 0, discord: true, displayName, avatarUrl };
                await fetch(`${DB_URL}/${discordUsername}.json`, { method: 'PUT', body: JSON.stringify(user) });
            } else { user.displayName = displayName; user.avatarUrl = avatarUrl; user.discord = true; }
            currentUser = discordUsername; userData = user;
            localStorage.setItem('swarm_user', discordUsername);
            loginSuccess();
            injectDiscordAvatar(displayName, avatarUrl);
            return true;
        } catch(e) {
            console.error('Discord OAuth error:', e);
            if(statusEl) statusEl.textContent = '‚ùå Chyba: ' + e.message;
            return false;
        }
    }

    function injectDiscordAvatar(displayName, avatarUrl) {
        const nameEl = document.getElementById('display-name');
        if(!nameEl) return;
        nameEl.innerHTML = `<img src="${avatarUrl}" style="width:28px;height:28px;border-radius:50%;border:2px solid #5865F2;vertical-align:middle;margin-right:8px;" onerror="this.style.display='none'"><span style="color:#5865F2;">${displayName}</span>`;
    }

    const sfx = {
        star:       "assets/asset_mp3_001.mp3",
        win:        "assets/asset_mp3_002.mp3",
        boom:       null,
        rSpin:      "assets/asset_mp3_003.mp3",
        card:       "assets/asset_mp3_004.mp3",
        admin_give: "https://www.myinstants.com/media/sounds/cash-register-sound-effect.mp3",
        admin_reset:"https://www.myinstants.com/media/sounds/vine-boom.mp3",
        error:      "https://www.myinstants.com/media/sounds/error.mp3"
    };

    function initAudio() { audioReady = true; }
    function play(name) {
        if(!audioReady || !sfx[name]) return;
        const a = new Audio(sfx[name]);
        a.volume = name === 'win' ? 0.2 : name === 'card' ? 0.5 : name === 'star' ? 0.8 : 0.4;
        a.play().catch(()=>{});
    }

    // --- AUTH & CORE ---
    async function auth(type) {
        const u = document.getElementById('user').value.trim(), p = document.getElementById('pass').value;
        if(!u || !p) return;
        const res = await fetch(DB_URL + ".json"), users = await res.json() || {};
        if(type === 'reg') {
            if(users[u]) return alert("Taken!");
            userData = { password: p, chips: 0 };
            await fetch(`${DB_URL}/${u}.json`, { method: 'PUT', body: JSON.stringify(userData) });
            alert("Registered!");
        } else {
            if(users[u] && users[u].password === p) { currentUser = u; userData = users[u]; localStorage.setItem('swarm_user', u); loginSuccess(); }
            else alert("Fail!");
        }
    }

    function loginSuccess() {
        // Load saved bet history for this user
        try {
            const saved = localStorage.getItem('swarm_history_' + currentUser);
            betHistory = saved ? JSON.parse(saved) : [];
        } catch(e) { betHistory = []; }
        document.getElementById('auth-screen').classList.add('hidden');
        document.getElementById('main-app').classList.remove('hidden');
        document.getElementById('display-name').innerText = currentUser;
        const admins = ["discord_595767263374737409", "discord_863482425417662475"];
        if(admins.includes(currentUser)) document.getElementById('link-admin').classList.remove('hidden');
        buildRoulette(); updateUI();
        document.getElementById('pf-float-btn').classList.remove('hidden');
        // Start anticheat after a brief delay (let updateUI settle)
        setTimeout(() => acInit(userData.chips), 1500);
        // Tower risk change ‚Üí rebuild board preview
        document.getElementById('t-risk')?.addEventListener('change', function() {
            if(!tActive) { tCurrentRisk = this.value; buildTowerBoard(); }
        });
    }

    function logout() { localStorage.removeItem('swarm_user'); betHistory = []; location.reload(); }

    function showPage(p) {
        document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
        document.getElementById('nav-'+p)?.classList.add('active');
        ['games', 'history', 'rakeback', 'admin'].forEach(id => document.getElementById('page-'+id).classList.add('hidden'));
        document.getElementById('page-' + p).classList.remove('hidden');
        if(p === 'history') renderHistory();
        if(p === 'games') backToMenu();
    }

    // Profit trackers per game session
    const sessionProfit = { mines:0, dice:0, coinflip:0, roulette:0, blackjack:0, baccarat:0, crash:0, tower:0, royaljelly:0, killabug:0 };
    function addProfit(game, amount) {
        if(!sessionProfit.hasOwnProperty(game)) return;
        sessionProfit[game] += amount;
        const map = { mines:'m-profit', dice:'d-profit', coinflip:'cf-profit', roulette:'r-profit', blackjack:'bj-profit', baccarat:'bac-profit', crash:'c-profit', tower:'t-profit', royaljelly:'rj-profit', killabug:'kab-profit' };
        const el = document.getElementById(map[game]);
        if(!el) return;
        const v = sessionProfit[game];
        el.textContent = (v >= 0 ? '+' : '') + Math.floor(v) + ' ‚≠ê';
        el.className = 'profit-val ' + (v > 0 ? 'pos' : v < 0 ? 'neg' : 'zero');
    }
    const MIN_BET = 50;
    const MAX_BET = 1000;
    function clampBet(v) { return Math.max(MIN_BET, Math.min(MAX_BET, parseInt(v) || MIN_BET)); }

    function updateUI() {
        if(!userData) return;
        const chips = Math.floor(userData.chips);
        const el = document.getElementById('display-chips');
        if(el && el.innerText !== String(chips)) {
            el.innerText = chips;
            el.classList.remove('bal-pulse');
            void el.offsetWidth; // reflow
            el.classList.add('bal-pulse');
        }
        // Sync anticheat snapshot on every legitimate updateUI call
        if(_acEnabled) acLegitChange(userData.chips);
        fetch(`${DB_URL}/${currentUser}.json`, { method: 'PUT', body: JSON.stringify(userData) });
    }

    // --- GAME ENGINE WRAPPERS ---
    function selectGame(g) {
        document.getElementById('selection-menu').classList.add('hidden');
        document.getElementById('game-active-page').classList.remove('hidden');
        ['mines','dice','roulette','blackjack','coinflip','crash','limbo','baccarat','tower','royaljelly','killabug'].forEach(id => {
            const el = document.getElementById('game-'+id);
            if(el) el.classList.add('hidden');
        });
        document.getElementById('game-'+g).classList.remove('hidden');
        if(g==='royaljelly') rjInit();
        if(g==='tower') buildTowerBoard();
        if(g==='killabug') kabInit();
    }

    function backToMenu() {
        if(crashActive) clearInterval(crashInterval);
        document.getElementById('selection-menu').classList.remove('hidden');
        document.getElementById('game-active-page').classList.add('hidden');
    }

    function showWinOverlay(mult, amount) {
        const div = document.createElement('div');
        div.className = 'win-announcement';
        div.innerHTML = `<p class="win-mult">${mult.toFixed(2)}x</p><p class="win-amt">+${Math.floor(amount)} ‚≠êÔ∏è</p>`;
        document.getElementById('win-container').appendChild(div);
        setTimeout(() => div.remove(), 3000);
    }

    const DISCORD_WEBHOOK_URL = "https://discord.com/api/webhooks/1474553214715170917/XnmolgPPEt7chlQfAJTSNDApElAx-l-yMmb7R84AwZ1QhUypZLWbnwTGDesVJLpdhI43";

    async function sendDiscordWebhook(game, bet, mult, win) {
        try {
            const isWin = win > 0;
            const playerName = userData?.displayName || currentUser || "Unknown";
            const payout = isWin ? Math.floor(win) : 0;
            const embed = {
                title: isWin ? ("WIN - " + game) : ("LOSS - " + game),
                color: isWin ? 0x27ae60 : 0xe74c3c,
                fields: [
                    { name: "Player", value: playerName, inline: true },
                    { name: "Bet", value: bet + " Stars", inline: true },
                    { name: "Multiplier", value: (mult.toFixed ? mult.toFixed(2) : mult) + "x", inline: true },
                    { name: isWin ? "Payout" : "Lost", value: isWin ? ("+" + payout + " Stars") : ("-" + bet + " Stars"), inline: true }
                ],
                footer: { text: "SwarmBet Live Games" },
                timestamp: new Date().toISOString()
            };
            await fetch(DISCORD_WEBHOOK_URL, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ embeds: [embed] })
            });
        } catch(e) {}
    }

    function addHistory(game, bet, mult, win) {
        betHistory.unshift({ game, bet, mult, win: Math.floor(win) });
        if(betHistory.length > 50) betHistory.pop();
        try { localStorage.setItem('swarm_history_' + currentUser, JSON.stringify(betHistory)); } catch(e) {}
        sendDiscordWebhook(game, bet, mult, win);
    }

    function renderHistory() {
        document.getElementById('history-body').innerHTML = betHistory.map(h => `
            <tr><td>${h.game}</td><td>${h.bet} ‚≠êÔ∏è</td><td>${h.mult.toFixed(2)}x</td><td class="${h.win > 0 ? 'status-win' : 'status-loss'}">${h.win > 0 ? '+' + h.win : h.win}</td></tr>
        `).join('');
    }

    // --- PROMO & ADMIN ---
    async function createPromo() {
        const code = document.getElementById('new-code').value.toUpperCase().trim(), val = parseInt(document.getElementById('code-val').value);
        if(!code || isNaN(val)) return;
        await fetch(`${PROMO_URL}/${code}.json`, { method: 'PUT', body: JSON.stringify({val}) });
        alert("Promo created!");
    }

    async function redeemCode() {
        const code = document.getElementById('promo-input').value.toUpperCase().trim();
        if(!code) return toast('Enter a code!', 'warn');
        // Check if this user already redeemed this code
        const usedKey = `${PROMO_URL}/used/${currentUser}_${code}.json`;
        const usedRes = await fetch(usedKey), usedData = await usedRes.json();
        if(usedData) return toast('You already redeemed this code!', 'error');
        const res = await fetch(`${PROMO_URL}/${code}.json`), data = await res.json();
        if(data && data.val) {
            // Mark as used
            await fetch(usedKey, { method: 'PUT', body: JSON.stringify({ by: currentUser, at: Date.now() }) });
            userData.chips += data.val; updateUI();
            toast('‚úÖ Code redeemed! +' + data.val + ' ‚≠ê', 'success');
        } else {
            toast('Invalid or expired code!', 'error');
        }
    }

    function admLog(msg) {
        const log = document.getElementById('adm-log');
        if(!log) return;
        const time = new Date().toLocaleTimeString();
        log.innerHTML += `<div>[${time}] ${msg}</div>`;
        log.scrollTop = log.scrollHeight;
    }

    async function adminGiveChips() {
        const raw = document.getElementById('adm-target').value.trim();
        const target = /^\d{17,20}$/.test(raw) ? 'discord_' + raw : raw;
        const amount = parseInt(document.getElementById('adm-amount').value);
        if(!target || isNaN(amount)) return alert('Zadej username/ID a amount!');
        const res = await fetch(`${DB_URL}/${target}.json`), tData = await res.json();
        if(!tData) { play('error'); return alert('Hr√°ƒç nenalezen!'); }
        tData.chips = (tData.chips || 0) + amount;
        await fetch(`${DB_URL}/${target}.json`, { method: 'PUT', body: JSON.stringify(tData) });
        if(target === currentUser) { userData.chips = tData.chips; updateUI(); }
        admLog(`‚úÖ Gave ${amount}‚≠ê to ${raw} (new bal: ${tData.chips})`); play('admin_give');
        alert(`Odesl√°no! ${raw} m√° teƒè ${tData.chips} ‚≠ê`);
    }

    async function adminResetChips() {
        const raw = document.getElementById('adm-reset-target').value.trim();
        const target = /^\d{17,20}$/.test(raw) ? 'discord_' + raw : raw;
        const newBal = parseInt(document.getElementById('adm-reset-amount').value) || 0;
        if(!target) return alert('Zadej username nebo Discord ID!');
        if(!confirm(`Opravdu resetovat balance hr√°ƒçe ${raw} na ${newBal} ‚≠ê?`)) return;
        const res = await fetch(`${DB_URL}/${target}.json`), tData = await res.json();
        if(!tData) { play('error'); return alert('Hr√°ƒç nenalezen!'); }
        const oldBal = tData.chips || 0;
        tData.chips = newBal;
        await fetch(`${DB_URL}/${target}.json`, { method: 'PUT', body: JSON.stringify(tData) });
        if(target === currentUser) { userData.chips = newBal; updateUI(); }
        admLog(`üîÑ Reset ${raw}: ${oldBal}‚≠ê ‚Üí ${newBal}‚≠ê`); play('admin_reset');
        alert(`Reset hotov! ${raw} m√° teƒè ${newBal} ‚≠ê`);
    }

    // --- GAMES LOGIC (COPY FROM SOURCE) ---
    // [cite: 153-264] - Tu vlo≈æena ve≈°ker√° p≈Øvodn√≠ logika pro Mines, Roulette, Blackjack atd.

    // MINES
    // MINES
    let mActive = false, mMult = 1, mBet = 0, mBombs = [], mGridSize = 25, mGemsFound = 0;
    const mRiskMines = {
        easy:   { 25:3,  36:5,  49:7,  64:9  },
        medium: { 25:5,  36:8,  49:12, 64:15 },
        hard:   { 25:8,  36:12, 49:17, 64:22 },
        expert: { 25:11, 36:16, 49:22, 64:28 },
        master: { 25:13, 36:19, 64:27, 49:35 }
    };
    const mMultStep = { easy:1.10, medium:1.18, hard:1.30, expert:1.50, master:1.75 };

    function setMGrid(n) {
        if(mActive) return; // block during active game
        mGridSize = n;
        [25,36,49,64].forEach(s => document.getElementById('mg-'+s)?.classList.remove('active'));
        document.getElementById('mg-'+n)?.classList.add('active');
        const board = document.getElementById('m-board');
        board.className = 'm-grid g'+n;
        updateMineInfo();
    }
    function updateMineInfo() {
        const risk = document.getElementById('m-risk').value;
        const bombs = mRiskMines[risk][mGridSize];
        document.getElementById('m-bomb-count').innerText = bombs;
        document.getElementById('m-gem-count').innerText = mGridSize - bombs;
    }
    document.getElementById('m-risk')?.addEventListener('change', () => {
        if(mActive) { // revert to previous value silently - we just prevent change visually
            updateMineInfo();
        } else {
            updateMineInfo();
        }
    });
    // Override risk select to block changes during game
    document.getElementById('m-risk')?.addEventListener('mousedown', function(e) {
        if(mActive) { e.preventDefault(); }
    });

    function startMines() {
        if(!acquireBetLock()) return;
        mBet = clampBet(document.getElementById('m-bet').value);
        document.getElementById('m-bet').value = mBet;
        if(mBet > userData.chips || mBet < MIN_BET) { toast('Not enough ‚≠ê! Min bet: ' + MIN_BET, 'error'); releaseBetLock(); return; }
        const risk = document.getElementById('m-risk').value;
        const bombCount = mRiskMines[risk][mGridSize];
        userData.chips -= mBet; mActive = true; mMult = 1; mBombs = []; mGemsFound = 0; updateUI();
        addProfit('mines', -mBet);
        releaseBetLock();
        document.getElementById('m-start').disabled = true;
        document.getElementById('m-bet').disabled = true;
        document.getElementById('m-risk').disabled = true;
        document.querySelectorAll('.m-grid-btn').forEach(b => b.style.opacity = '0.4');
        document.getElementById('m-mult-disp').innerText = '1.00√ó';
        const board = document.getElementById('m-board');
        board.innerHTML = '';
        board.className = 'm-grid g' + mGridSize;
        while(mBombs.length < bombCount) { let r = Math.floor(Math.random()*mGridSize); if(!mBombs.includes(r)) mBombs.push(r); }
        for(let i=0; i<mGridSize; i++) {
            let t = document.createElement('div'); t.className = 'tile';
            t.onclick = () => {
                if(!mActive || t.dataset.revealed) return;
                t.dataset.revealed = '1';
                if(mBombs.includes(i)) {
                    t.innerHTML='üí£'; t.classList.add('bomb'); play('boom'); mActive=false;
                    // Reveal all bombs
                    document.querySelectorAll('#m-board .tile').forEach((tile,idx) => { if(mBombs.includes(idx) && !tile.dataset.revealed) { tile.innerHTML='üí£'; tile.classList.add('bomb'); tile.dataset.revealed='1'; }});
                    document.getElementById('m-cash').classList.add('hidden');
                    document.getElementById('m-start').disabled=false;
                    document.getElementById('m-bet').disabled=false;
                    document.getElementById('m-risk').disabled=false;
                    document.querySelectorAll('.m-grid-btn').forEach(b => b.style.opacity = '1');
                    addHistory("Mines", mBet, 0, -mBet);
                } else {
                    t.innerHTML='üíé'; t.classList.add('gem');
                    play('star'); mGemsFound++;
                    mMult *= mMultStep[risk];
                    document.getElementById('m-mult-disp').innerText = mMult.toFixed(2) + '√ó';
                    document.getElementById('m-cash').classList.remove('hidden');
                }
            };
            board.appendChild(t);
        }
    }
    function cashoutMines() {
        if(!mActive) return;
        let win = Math.floor(mBet * mMult);
        userData.chips += win; play('win');
        showWinOverlay(mMult, win);
        addHistory("Mines", mBet, mMult, win);
        addProfit('mines', win);
        mActive = false; updateUI();
        document.getElementById('m-cash').classList.add('hidden');
        document.getElementById('m-start').disabled = false;
        document.getElementById('m-bet').disabled = false;
        document.getElementById('m-risk').disabled = false;
        document.querySelectorAll('.m-grid-btn').forEach(b => b.style.opacity = '1');
        document.getElementById('m-mult-disp').innerText = mMult.toFixed(2) + '√ó ‚úì';
    }

    // DICE
    function playDice() {
        if(!acquireBetLock()) return;
        let b = clampBet(document.getElementById('d-bet').value);
        document.getElementById('d-bet').value = b;
        let n = parseInt(document.getElementById('d-num').value);
        if(b > userData.chips) { toast('Not enough ‚≠ê!', 'error'); releaseBetLock(); return; }
        userData.chips -= b; addProfit('dice', -b); updateUI();
        const btn = document.querySelector('#game-dice .btn-play');
        if(btn) btn.disabled = true;
        setTimeout(() => {
            let r = Math.floor(Math.random()*6)+1;
            document.getElementById('d-res').innerText = r;
            if(r === n) {
                let win = b*6; userData.chips += win; play('win');
                showWinOverlay(6.00, win); addHistory("Dice", b, 6, win); addProfit('dice', win);
                toast('üé≤ Rolled ' + r + '! You win +' + win + ' ‚≠ê', 'success');
            } else {
                play('boom'); addHistory("Dice", b, 0, -b);
                toast('üé≤ Rolled ' + r + '. Better luck next time!', 'error');
            }
            if(btn) btn.disabled = false;
            releaseBetLock(); updateUI();
        }, 500);
    }

    // COINFLIP
    function playCoinFlip() {
        if(!acquireBetLock()) return;
        let b = clampBet(document.getElementById('cf-bet').value), choice = document.getElementById('cf-choice').value;
        document.getElementById('cf-bet').value = b;
        let btn = document.getElementById('cf-btn'), coin = document.getElementById('coin-obj');
        if(b > userData.chips || b < MIN_BET) { toast('Not enough ‚≠ê!', 'error'); releaseBetLock(); return; }
        userData.chips -= b; addProfit('coinflip', -b); updateUI(); btn.disabled = true; coin.classList.add('flipping');
        setTimeout(() => {
            coin.classList.remove('flipping');
            let res = Math.random() > 0.5 ? 'H' : 'T'; coin.innerText = (res === 'H') ? '‚≠ê' : 'üíé';
            if(res === choice) {
                let win = b*2; userData.chips += win; play('win');
                showWinOverlay(2.0, win); addHistory("CoinFlip", b, 2, win); addProfit('coinflip', win);
                toast((res==='H'?'‚≠ê Heads':'üíé Tails') + '! You win +' + win + ' ‚≠ê', 'success');
            } else {
                play('boom'); addHistory("CoinFlip", b, 0, -b);
                toast((res==='H'?'‚≠ê Heads':'üíé Tails') + ' ‚Äî you lose!', 'error');
            }
            btn.disabled = false; releaseBetLock(); updateUI();
        }, 1200);
    }

    // CRASH
    let crashActive = false, crashMult = 1.0, crashInterval, crashBet = 0;
    function startCrash() {
        if(!acquireBetLock()) return;
        crashBet = clampBet(document.getElementById('c-bet').value);
        document.getElementById('c-bet').value = crashBet;
        if (crashBet > userData.chips || crashBet < MIN_BET || crashActive) { releaseBetLock(); return; }
        userData.chips -= crashBet; addProfit('crash', -crashBet); updateUI(); crashActive = true; crashMult = 1.00;
        const display = document.getElementById('crash-display'); display.style.color = "white";
        document.getElementById('c-start').disabled = true; document.getElementById('c-cash').classList.remove('hidden');
        let crashPoint = (Math.random() < 0.05) ? 1.00 : (0.99 / (1 - Math.random()));
        releaseBetLock();
        crashInterval = setInterval(() => {
            crashMult += 0.01 + (crashMult * 0.005);
            display.innerText = crashMult.toFixed(2) + "x";
            if (crashMult >= crashPoint) {
                clearInterval(crashInterval); crashActive = false;
                display.style.color = "var(--red)"; play('boom');
                addHistory("Crash", crashBet, 0, -crashBet);
                toast('üí• Crashed at ' + crashMult.toFixed(2) + 'x!', 'error');
                document.getElementById('c-start').disabled = false; document.getElementById('c-cash').classList.add('hidden');
            }
        }, 100);
    }
    function cashoutCrash() {
        if (!crashActive) return;
        clearInterval(crashInterval); crashActive = false;
        let win = Math.floor(crashBet * crashMult); userData.chips += win;
        play('win'); showWinOverlay(crashMult, win); addHistory("Crash", crashBet, crashMult, win);
        addProfit('crash', win);
        toast('‚úàÔ∏è Cashed out at ' + crashMult.toFixed(2) + 'x! +' + win + ' ‚≠ê', 'success');
        updateUI();
        document.getElementById('c-start').disabled = false; document.getElementById('c-cash').classList.add('hidden');
    }


    // ROULETTE
    const rOrder = [0, 32, 15, 19, 4, 21, 2, 25, 17, 34, 6, 27, 13, 36, 11, 30, 8, 23, 10, 5, 24, 16, 33, 1, 20, 14, 31, 9, 22, 18, 29, 7, 28, 12, 35, 3, 26];
    const redNums = [1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36];
    let currentBets = {}, isRSpinning = false;
    function buildRoulette() {
        const slider = document.getElementById('r-slider'); let sH = "";
        for(let i=0; i<30; i++) rOrder.forEach(n => { let c = n===0?'var(--green)':(redNums.includes(n)?'var(--red)':'var(--black)'); sH += `<div class="r-num" style="background:${c}">${n}</div>`; });
        slider.innerHTML = sH;
        const b = document.getElementById('r-board'); let bH = `<div class="cell nula" onclick="handleRClick('n0', this)">0</div>`;
        for(let r=3; r>=1; r--) for(let i=1; i<=12; i++) { let n=(i-1)*3+r; let c=redNums.includes(n)?'red':'black'; bH+=`<div class="cell ${c}" onclick="handleRClick('n${n}', this)">${n}</div>`; }
        b.innerHTML = bH;
    }
    function handleRClick(val, el) { setExtraBet(val, el); }
    function setExtraBet(type, el) {
        if(isRSpinning) return; const amt = clampBet(document.getElementById('r-bet').value);
        document.getElementById('r-bet').value = amt;
        if(amt > userData.chips) return; if(!currentBets[type]) currentBets[type] = 0;
        currentBets[type] += amt; userData.chips -= amt; updateUI();
        let chip = el.querySelector('.chip-overlay'); if(!chip) { chip = document.createElement('div'); chip.className = 'chip-overlay'; el.appendChild(chip); }
        chip.innerText = currentBets[type]; el.classList.add('active');
    }
    function clearRouletteBets() {
        if(isRSpinning) return; let refund = 0; for(let key in currentBets) { refund += currentBets[key]; userData.chips += currentBets[key]; }
        // Don't call addProfit here ‚Äî we're just refunding chips, not a game outcome
        currentBets = {}; document.querySelectorAll('.cell, .btn-extra').forEach(el => { el.classList.remove('active'); const c = el.querySelector('.chip-overlay'); if(c) c.remove(); }); updateUI();
    }
    function spinRoulette() {
        if(isRSpinning || Object.keys(currentBets).length === 0) return;
        isRSpinning = true; document.getElementById('r-spin').disabled = true; play('rSpin');
        const slider = document.getElementById('r-slider');
        const wrap = document.getElementById('r-wrap');
        // Reset instantly
        slider.style.transition = 'none';
        slider.style.transform = 'translateX(0px)';
        slider.getBoundingClientRect(); // force reflow

        // Pick random target
        const winIndex = Math.floor(Math.random() * rOrder.length);
        const winNum = rOrder[winIndex];

        // Spin many loops + land on correct tile center under pointer
        const loops = 20;
        const tileWidth = 80;
        const wrapCenter = wrap.offsetWidth / 2;
        const targetTile = loops * rOrder.length + winIndex;
        const finalX = -(targetTile * tileWidth - wrapCenter + tileWidth / 2);

        slider.style.transition = "transform 5s cubic-bezier(0.05, 0, 0.1, 1)";
        slider.style.transform = `translateX(${finalX}px)`;

        setTimeout(() => {
            // Read actual number under pointer to confirm (source of truth)
            const pointerX = wrap.getBoundingClientRect().left + wrapCenter;
            const tiles = slider.querySelectorAll('.r-num');
            let actualNum = winNum;
            for(let tile of tiles) {
                const r = tile.getBoundingClientRect();
                if(pointerX >= r.left && pointerX <= r.right) {
                    actualNum = parseInt(tile.innerText);
                    break;
                }
            }

            let totalWin = 0, totalBet = 0;
            for(let b in currentBets) {
                let amt = currentBets[b]; totalBet += amt;
                if(b === 'n'+actualNum) totalWin += amt * 36;
                else if(b === 'red' && redNums.includes(actualNum)) totalWin += amt * 2;
                else if(b === 'black' && actualNum !== 0 && !redNums.includes(actualNum)) totalWin += amt * 2;
                else if(b === 'even' && actualNum !== 0 && actualNum % 2 === 0) totalWin += amt * 2;
                else if(b === 'odd' && actualNum % 2 === 1) totalWin += amt * 2;
                else if(b === '1-18' && actualNum >= 1 && actualNum <= 18) totalWin += amt * 2;
                else if(b === '19-36' && actualNum >= 19 && actualNum <= 36) totalWin += amt * 2;
                else if(b === '1st12' && actualNum >= 1 && actualNum <= 12) totalWin += amt * 3;
                else if(b === '2nd12' && actualNum >= 13 && actualNum <= 24) totalWin += amt * 3;
                else if(b === '3rd12' && actualNum >= 25 && actualNum <= 36) totalWin += amt * 3;
            }
            document.getElementById('r-status').innerText = `Landed: ${actualNum} ${redNums.includes(actualNum) ? 'üî¥' : actualNum === 0 ? 'üü¢' : '‚ö´'}`;
            if(totalWin > 0) { userData.chips += totalWin; play('win'); showWinOverlay(totalWin/totalBet, totalWin); addHistory("Roulette", totalBet, totalWin/totalBet, totalWin); addProfit('roulette', totalWin - totalBet); }
            else { play('boom'); addHistory("Roulette", totalBet, 0, -totalBet); addProfit('roulette', -totalBet); }
            currentBets = {}; document.querySelectorAll('.cell, .btn-extra').forEach(el => { el.classList.remove('active'); const c = el.querySelector('.chip-overlay'); if(c) c.remove(); });
            isRSpinning = false; document.getElementById('r-spin').disabled = false; updateUI();
        }, 5200);
    }

    // TOWER
    // TOWER
    function toggleRiskDropdown() {
        if(tActive) return;
        const dd = document.getElementById('tw-risk-dropdown');
        const arrow = document.getElementById('tw-risk-arrow');
        const open = dd.classList.toggle('open');
        arrow.textContent = open ? '‚ñ≤' : '‚ñº';
    }
    function selectRisk(value, label) {
        if(tActive) return;
        document.getElementById('t-risk').value = value;
        document.getElementById('tw-risk-label').textContent = label;
        document.querySelectorAll('.tw-risk-option').forEach(o => o.classList.remove('selected'));
        document.getElementById('tw-risk-dropdown').classList.remove('open');
        document.getElementById('tw-risk-arrow').textContent = '‚ñº';
        tCurrentRisk = value;
        buildTowerBoard();
    }
    document.addEventListener('click', function(e) {
        const wrap = document.getElementById('tw-risk-wrap');
        if(wrap && !wrap.contains(e.target)) {
            const dd = document.getElementById('tw-risk-dropdown');
            if(dd) { dd.classList.remove('open'); document.getElementById('tw-risk-arrow').textContent = '‚ñº'; }
        }
    });
    const tRiskConfig = {
        easy:   { bombs:1, cols:4, mults:[1.28,1.70,2.27,3.03,4.04,5.39,7.19,9.58,12.77] },
        medium: { bombs:1, cols:3, mults:[1.44,2.16,3.24,4.86,7.29,10.93,16.40,24.60,36.90] },
        hard:   { bombs:1, cols:2, mults:[1.92,3.84,7.68,15.36,30.72,61.44,122.88,245.76,491.52] },
        expert: { bombs:2, cols:3, mults:[2.88,8.64,25.92,77.76,233.28,699.84,2099.52,6298.56,18895.68] },
        master: { bombs:3, cols:4, mults:[3.84,15.36,61.44,245.76,983.04,3932.16,15728.64,62914.56,251658.24] }
    };
    let tActive = false, tLevel = 0, tBet = 0, tCurrentRisk = 'medium';
    const TOWER_ROWS = 9;
    let tBombs = [];

    function tGetCols() { return tRiskConfig[tCurrentRisk].cols; }

    function tGetMults() { return tRiskConfig[tCurrentRisk].mults; }
    function tGetBombs() { return tRiskConfig[tCurrentRisk].bombs; }

    function buildTowerBoard() {
        const board = document.getElementById('tower-board');
        board.innerHTML = '';
        const mults = tGetMults();
        for(let i = TOWER_ROWS - 1; i >= 0; i--) {
            const row = document.createElement('div');
            row.className = 'tw-row';
            row.id = `t-row-${i}`;
            for(let j = 0; j < tGetCols(); j++) {
                const tile = document.createElement('div');
                tile.className = 'tw-tile tw-inactive';
                tile.id = `t-tile-${i}-${j}`;
                // Badge inside the first tile of each row
                // mults[i] where i=0 is floor 1 (bottom, lowest mult), i=8 is top (highest mult)
                // Visual order: i=8 renders first (top of board), i=0 renders last (bottom)
                // So badge should show mults[i] ‚Äî floor i reached = mult mults[i]
                // multiplier badges hidden
                row.appendChild(tile);
            }
            board.appendChild(row);
        }
    }

    function startTower() {
        if(!acquireBetLock()) return;
        tBet = clampBet(document.getElementById('t-bet').value);
        document.getElementById('t-bet').value = tBet;
        if(tBet > userData.chips || tBet < MIN_BET) { toast('Not enough ‚≠ê!', 'error'); releaseBetLock(); return; }
        tCurrentRisk = document.getElementById('t-risk').value;
        userData.chips -= tBet; addProfit('tower', -tBet); updateUI();
        releaseBetLock();
        tActive = true; tLevel = 0;
        document.getElementById('t-start').disabled = true;
        document.getElementById('t-risk').disabled = true;
        document.getElementById('t-bet').disabled = true;
        document.getElementById('t-cash').classList.add('hidden');
        document.getElementById('t-mult-disp').textContent = '1.00√ó';
        document.getElementById('t-profit-disp').value = '0.00 ‚≠ê';
        document.getElementById('tower-status').textContent = 'Choose a tile!';

        buildTowerBoard();

        tBombs = [];
        const bombCount = tGetBombs();
        for(let i = 0; i < TOWER_ROWS; i++) {
            let bombs = new Set();
            while(bombs.size < bombCount) bombs.add(Math.floor(Math.random() * tGetCols()));
            tBombs.push(bombs);
        }
        tActivateRow(0);
    }

    function tActivateRow(rowIdx) {
        for(let j = 0; j < tGetCols(); j++) {
            const tile = document.getElementById(`t-tile-${rowIdx}-${j}`);
            if(!tile) return;
            tile.className = 'tw-tile tw-active';
            tile.onclick = () => tClickTile(rowIdx, j);
        }
    }

    function tClickTile(rowIdx, colIdx) {
        if(!tActive || rowIdx !== tLevel) return;
        const tile = document.getElementById(`t-tile-${rowIdx}-${colIdx}`);
        const mults = tGetMults();

        if(tBombs[rowIdx].has(colIdx)) {
            tile.innerHTML = 'üí•';
            tile.className = 'tw-tile tw-bomb';
            tile.onclick = null;
            for(let j = 0; j < tGetCols(); j++) {
                if(j !== colIdx) {
                    const t2 = document.getElementById(`t-tile-${rowIdx}-${j}`);
                    if(tBombs[rowIdx].has(j)) { t2.innerHTML = 'üí•'; t2.className = 'tw-tile tw-bomb'; }
                    else { t2.className = 'tw-tile tw-safe'; }
                    t2.onclick = null;
                }
            }
            play('boom'); tActive = false;
            document.getElementById('tower-status').textContent = 'üí• Boom! You lost!';
            document.getElementById('t-mult-disp').textContent = '0√ó';
            document.getElementById('t-profit-disp').value = `-${tBet} ‚≠ê`;
            document.getElementById('t-start').disabled = false;
            document.getElementById('t-risk').disabled = false;
            document.getElementById('t-bet').disabled = false;
            document.getElementById('t-cash').classList.add('hidden');
            addHistory("Tower", tBet, 0, -tBet);
        } else {
            tile.innerHTML = 'üíé';
            tile.className = 'tw-tile tw-gem';
            tile.onclick = null;
            for(let j = 0; j < tGetCols(); j++) {
                if(j !== colIdx) {
                    const t2 = document.getElementById(`t-tile-${rowIdx}-${j}`);
                    t2.className = 'tw-tile tw-safe';
                    t2.onclick = null;
                }
            }
            play('star'); tLevel++;
            const m = mults[rowIdx];
            const potentialWin = Math.floor(tBet * m);
            document.getElementById('t-mult-disp').textContent = m.toFixed(2) + '√ó';
            document.getElementById('t-profit-disp').value = `+${potentialWin} ‚≠ê`;
            if(tLevel === TOWER_ROWS) {
                cashoutTower();
            } else {
                document.getElementById('tower-status').textContent = `Floor ${tLevel}/${TOWER_ROWS} ‚Äî keep climbing!`;
                document.getElementById('t-cash').classList.remove('hidden');
                tActivateRow(tLevel);
            }
        }
    }

    function cashoutTower() {
        if(!tActive) return;
        const m = tGetMults()[tLevel - 1];
        const win = Math.floor(tBet * m);
        userData.chips += win; play('win');
        showWinOverlay(m, win);
        addHistory("Tower", tBet, m, win);
        addProfit('tower', win);
        tActive = false; updateUI();
        document.getElementById('t-start').disabled = false;
        document.getElementById('t-risk').disabled = false;
        document.getElementById('t-bet').disabled = false;
        document.getElementById('t-cash').classList.add('hidden');
        document.getElementById('tower-status').textContent = `‚úÖ Cashed out at ${m.toFixed(2)}√ó!`;
    }

    // BLACKJACK & BACCARAT (Simplified helper)
    let deck = [];
    function createDeck() {
        const suits = ['‚ô†', '‚ô£', '‚ô•', '‚ô¶'], vals = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
        deck = []; for(let s of suits) for(let v of vals) deck.push({v,s});
        for(let i=deck.length-1; i>0; i--) { const j = Math.floor(Math.random()*(i+1)); [deck[i], deck[j]] = [deck[j], deck[i]]; }
    }
    function renderCard(card, target, flip = false) {
        play('card');
        const container = document.getElementById(target);
        const cardIndex = container ? container.children.length : 0;
        const div = document.createElement('div');
        const animClass = flip ? 'card-flip-anim' : 'card-anim';
        div.className = `card-ui ${['‚ô•','‚ô¶'].includes(card.s)?'red':''} ${animClass}`;
        div.style.animationDelay = (cardIndex * 0.12) + 's';
        div.innerHTML = `<div>${card.v}</div><div style="font-size:12px">${card.s}</div>`;
        if(container) container.appendChild(div);
        // Remove animation class after it finishes so it doesn't replay
        setTimeout(() => div.classList.remove('dealing'), 500);
    }
    function getBJScore(hand) {
        let s = 0, a = 0; for(let c of hand) { if(c.v==='A') a++; else if(['J','Q','K','10'].includes(c.v)) s+=10; else s+=parseInt(c.v); }
        for(let i=0; i<a; i++) s += (s+11<=21)?11:1; return s;
    }

    let bjActive=false, bjHand=[], bjDealer=[], bjBet=0, bjWinAmount=0, bjGambleAmount=0;
    function bjUpdateCounters() {
        const pScore = getBJScore(bjHand);
        const dScore = bjDealer.length > 0 ? getBJScore([bjDealer[0]]) : 0;
        document.getElementById('bj-player-value').textContent = bjHand.length > 0 ? pScore : '‚Äî';
        document.getElementById('bj-dealer-value').textContent = bjDealer.length > 0 ? bjDealer[0].v : '‚Äî';
        document.getElementById('bj-deck-remaining').textContent = deck.length;
        document.getElementById('bj-player-count').textContent = bjHand.length > 0 ? `(${bjHand.length} cards)` : '';
        document.getElementById('bj-dealer-count').textContent = bjDealer.length > 0 ? `(${bjDealer.length} cards)` : '';
    }
    function startBlackjack() {
        if(!acquireBetLock()) return;
        bjBet = clampBet(document.getElementById('bj-bet').value);
        document.getElementById('bj-bet').value = bjBet;
        if(bjBet > userData.chips) { toast('Not enough ‚≠ê!', 'error'); releaseBetLock(); return; }
        userData.chips -= bjBet; addProfit('blackjack', -bjBet); updateUI(); bjActive=true; createDeck(); bjWinAmount=0; bjGambleAmount=0;
        releaseBetLock();
        document.getElementById('bj-gamble-area').classList.add('hidden');
        bjHand = [deck.pop(), deck.pop()]; bjDealer = [deck.pop(), deck.pop()];
        document.getElementById('bj-player-hand').innerHTML = ''; document.getElementById('bj-dealer-hand').innerHTML = '';
        bjHand.forEach(c => renderCard(c, 'bj-player-hand')); renderCard(bjDealer[0], 'bj-dealer-hand');
        document.getElementById('bj-player-score').textContent = 'Score: ' + getBJScore(bjHand);
        document.getElementById('bj-dealer-score').textContent = 'Shows: ' + bjDealer[0].v;
        document.getElementById('bj-deal-btn').classList.add('hidden');
        document.getElementById('bj-hit-btn').classList.remove('hidden');
        document.getElementById('bj-stand-btn').classList.remove('hidden');
        document.getElementById('bj-gamble-btn').classList.add('hidden');
        document.getElementById('bj-status').textContent = 'VS';
        bjUpdateCounters();
    }
    function bjHit() {
        if(!bjActive) return;
        let c = deck.pop(); bjHand.push(c); renderCard(c, 'bj-player-hand');
        document.getElementById('bj-player-score').textContent = 'Score: ' + getBJScore(bjHand);
        bjUpdateCounters();
        if(getBJScore(bjHand)>21) bjStand();
    }
    function bjStand() {
        bjActive=false;
        renderCard(bjDealer[1], 'bj-dealer-hand');
        let ds = getBJScore(bjDealer), ps = getBJScore(bjHand);
        while(ds < 17) { let c = deck.pop(); bjDealer.push(c); renderCard(c, 'bj-dealer-hand', false); ds = getBJScore(bjDealer); }
        document.getElementById('bj-dealer-score').textContent = 'Score: ' + ds;
        document.getElementById('bj-player-score').textContent = 'Score: ' + ps;
        bjUpdateCounters();
        if(ps <= 21 && (ds > 21 || ps > ds)) {
            bjWinAmount = bjBet*2;
            userData.chips += bjWinAmount; play('win'); showWinOverlay(2, bjWinAmount);
            document.querySelector('.bj-area')?.classList.remove('lose-shake'); document.querySelector('.bj-area')?.classList.add('win-glow');
            addHistory("Blackjack", bjBet, 2, bjWinAmount); addProfit('blackjack', bjWinAmount);
            document.getElementById('bj-status').textContent = 'üèÜ YOU WIN!';
            bjGambleAmount = bjWinAmount;
            document.getElementById('bj-gamble-btn').classList.remove('hidden');
        } else if(ps > 21) {
            play('boom'); addHistory("Blackjack", bjBet, 0, -bjBet);
            document.getElementById('bj-status').textContent = 'üí• BUST!';
            document.querySelector('.bj-area')?.classList.remove('win-glow'); document.querySelector('.bj-area')?.classList.add('lose-shake');
        } else if(ps === ds) {
            userData.chips += bjBet; addProfit('blackjack', bjBet);
            addHistory("Blackjack", bjBet, 1, bjBet);
            document.getElementById('bj-status').textContent = 'ü§ù TIE ‚Äî Bet Returned';
            updateUI();
        } else {
            play('boom'); addHistory("Blackjack", bjBet, 0, -bjBet);
            document.getElementById('bj-status').textContent = 'üòû DEALER WINS';
            document.querySelector('.bj-area')?.classList.remove('win-glow'); document.querySelector('.bj-area')?.classList.add('lose-shake');
        }
        document.getElementById('bj-deal-btn').classList.remove('hidden');
        document.getElementById('bj-hit-btn').classList.add('hidden');
        document.getElementById('bj-stand-btn').classList.add('hidden');
        updateUI();
    }
    function bjGamble() {
        if(bjGambleAmount <= 0) return;
        document.getElementById('bj-gamble-area').classList.remove('hidden');
        document.getElementById('bj-gamble-status').textContent = 'Gamble ' + bjGambleAmount + ' ‚≠ê ‚Äî pick a color!';
        document.getElementById('bj-gamble-btn').classList.add('hidden');
    }
    function bjGambleColor(color) {
        const card = deck.length > 0 ? deck.pop() : {v:'5', s:'‚ô•'};
        const isRed = ['‚ô•','‚ô¶'].includes(card.s);
        const win = (color === 'red' && isRed) || (color === 'black' && !isRed);
        const cardStr = card.v + card.s;
        if(win) {
            const gain = bjGambleAmount; userData.chips += gain; play('win');
            bjGambleAmount *= 2;
            document.getElementById('bj-gamble-status').innerHTML = `‚úÖ Card was <strong>${cardStr}</strong> ‚Äî WIN! Now: ${bjGambleAmount} ‚≠ê ‚Äî gamble again or collect!`;
            addProfit('blackjack', gain);
        } else {
            userData.chips -= bjGambleAmount; play('boom');
            document.getElementById('bj-gamble-status').innerHTML = `‚ùå Card was <strong>${cardStr}</strong> ‚Äî LOST the gamble!`;
            bjGambleAmount = 0;
            document.getElementById('bj-gamble-area').classList.add('hidden');
        }
        updateUI();
    }
    function bjGambleCollect() {
        document.getElementById('bj-gamble-area').classList.add('hidden');
        document.getElementById('bj-gamble-status').textContent = '';
        bjGambleAmount = 0;
    }

    // BACCARAT
    let bacGambleAmt = 0;
    function getBacScore(hand) {
        let s = 0;
        for(let c of hand) {
            if(['J','Q','K','10'].includes(c.v)) s += 0;
            else if(c.v === 'A') s += 1;
            else s += parseInt(c.v);
        }
        return s % 10;
    }
    function playBaccarat(side) {
        if(!acquireBetLock()) return;
        const bet = clampBet(document.getElementById('bac-bet').value);
        document.getElementById('bac-bet').value = bet;
        if(bet > userData.chips || bet < MIN_BET) { toast('Not enough ‚≠ê!', 'error'); releaseBetLock(); return; }
        userData.chips -= bet; addProfit('baccarat', -bet); updateUI();
        releaseBetLock();
        createDeck();
        document.getElementById('bac-player-hand').innerHTML = '';
        document.getElementById('bac-banker-hand').innerHTML = '';
        document.getElementById('bac-player-score').innerText = '';
        document.getElementById('bac-banker-score').innerText = '';
        document.getElementById('bac-status').innerText = '...';
        document.getElementById('bac-gamble-area').classList.add('hidden');
        document.querySelectorAll('#bac-controls button').forEach(b => b.disabled = true);
        document.getElementById('bac-deck-remaining').textContent = deck.length;
        document.getElementById('bac-pval').textContent = '‚Äî';
        document.getElementById('bac-bval').textContent = '‚Äî';

        let pHand = [], bHand = [];
        const delay = 500;

        setTimeout(() => { let c = deck.pop(); pHand.push(c); renderCard(c, 'bac-player-hand'); document.getElementById('bac-deck-remaining').textContent = deck.length; document.getElementById('bac-player-count').textContent = `(${pHand.length} cards)`; }, delay * 1);
        setTimeout(() => { let c = deck.pop(); bHand.push(c); renderCard(c, 'bac-banker-hand'); document.getElementById('bac-deck-remaining').textContent = deck.length; document.getElementById('bac-banker-count').textContent = `(${bHand.length} cards)`; }, delay * 2);
        setTimeout(() => { let c = deck.pop(); pHand.push(c); renderCard(c, 'bac-player-hand'); document.getElementById('bac-deck-remaining').textContent = deck.length; document.getElementById('bac-player-count').textContent = `(${pHand.length} cards)`; document.getElementById('bac-pval').textContent = getBacScore(pHand); }, delay * 3);
        setTimeout(() => { let c = deck.pop(); bHand.push(c); renderCard(c, 'bac-banker-hand'); document.getElementById('bac-deck-remaining').textContent = deck.length; document.getElementById('bac-banker-count').textContent = `(${bHand.length} cards)`; document.getElementById('bac-bval').textContent = getBacScore(bHand); }, delay * 4);

        setTimeout(() => {
            let ps = getBacScore(pHand), bs = getBacScore(bHand);
            let nextStep = delay * 5;

            if(ps <= 5) {
                setTimeout(() => { let c = deck.pop(); pHand.push(c); renderCard(c, 'bac-player-hand'); ps = getBacScore(pHand); document.getElementById('bac-deck-remaining').textContent = deck.length; document.getElementById('bac-player-count').textContent = `(${pHand.length} cards)`; document.getElementById('bac-pval').textContent = ps; }, nextStep);
                nextStep += delay;
            }
            setTimeout(() => {
                bs = getBacScore(bHand);
                if(bs <= 5) {
                    let c = deck.pop(); bHand.push(c); renderCard(c, 'bac-banker-hand'); bs = getBacScore(bHand);
                    document.getElementById('bac-deck-remaining').textContent = deck.length;
                    document.getElementById('bac-banker-count').textContent = `(${bHand.length} cards)`;
                    document.getElementById('bac-bval').textContent = bs;
                }
            }, nextStep);
            nextStep += delay;

            setTimeout(() => {
                ps = getBacScore(pHand); bs = getBacScore(bHand);
                document.getElementById('bac-player-score').innerText = `Score: ${ps}`;
                document.getElementById('bac-banker-score').innerText = `Score: ${bs}`;
                document.getElementById('bac-pval').textContent = ps;
                document.getElementById('bac-bval').textContent = bs;
                let result = ps > bs ? 'P' : bs > ps ? 'B' : 'T';
                let win = 0; bacGambleAmt = 0;
                if(side === result) {
                    if(result === 'P') win = bet * 2;
                    else if(result === 'B') win = Math.floor(bet * 1.95);
                    else win = bet * 9;
                    userData.chips += win; play('win'); showWinOverlay(win/bet, win); document.querySelector('.bac-table')?.classList.remove('lose-shake'); document.querySelector('.bac-table')?.classList.add('win-glow');
                    addHistory("Baccarat", bet, win/bet, win); addProfit('baccarat', win);
                    document.getElementById('bac-status').innerText = `${result === 'P' ? 'PLAYER' : result === 'B' ? 'BANKER' : 'TIE'} WINS! +${win} ‚≠ê`;
                    bacGambleAmt = win;
                    document.getElementById('bac-gamble-area').classList.remove('hidden');
                    document.getElementById('bac-gamble-status').textContent = `Gamble ${win} ‚≠ê ‚Äî pick a color!`;
                } else {
                    play('boom'); document.querySelector('.bac-table')?.classList.remove('win-glow'); document.querySelector('.bac-table')?.classList.add('lose-shake');
                    addHistory("Baccarat", bet, 0, -bet);
                    document.getElementById('bac-status').innerText = `${result === 'P' ? 'PLAYER' : result === 'B' ? 'BANKER' : 'TIE'} WINS - You Lose`;
                }
                document.querySelectorAll('#bac-controls button').forEach(b => b.disabled = false);
                updateUI();
            }, nextStep);

        }, delay * 4 + 100);
    }
    function bacGambleColor(color) {
        if(bacGambleAmt <= 0) return;
        const card = deck.length > 0 ? deck.pop() : {v:'5', s:'‚ô•'};
        const isRed = ['‚ô•','‚ô¶'].includes(card.s);
        const win = (color === 'red' && isRed) || (color === 'black' && !isRed);
        const cardStr = card.v + card.s;
        if(win) {
            const gain = bacGambleAmt; userData.chips += gain; play('win');
            bacGambleAmt *= 2;
            document.getElementById('bac-gamble-status').innerHTML = `‚úÖ Card: <strong>${cardStr}</strong> ‚Äî WIN! Now: ${bacGambleAmt} ‚≠ê`;
            addProfit('baccarat', gain);
        } else {
            userData.chips -= bacGambleAmt; play('boom');
            document.getElementById('bac-gamble-status').innerHTML = `‚ùå Card: <strong>${cardStr}</strong> ‚Äî Gamble LOST!`;
            bacGambleAmt = 0;
            document.getElementById('bac-gamble-area').classList.add('hidden');
        }
        updateUI();
    }
    function bacGambleCollect() {
        document.getElementById('bac-gamble-area').classList.add('hidden');
        bacGambleAmt = 0;
    }

    const BEE_IMAGES = {
        'Bomber_Bee': 'assets/asset_svg_001.svg',
        'Brave_Bee': 'assets/asset_svg_002.svg',
        'Bumble_Bee': 'assets/asset_svg_003.svg',
        'Cool_Bee': 'assets/asset_svg_004.svg',
        'Hasty_Bee': 'assets/asset_svg_005.svg',
        'Looker_Bee': 'assets/asset_svg_006.svg',
        'Rad_Bee': 'assets/asset_svg_007.svg',
        'Rascal_Bee': 'assets/asset_svg_008.svg',
        'Stubborn_Bee': 'assets/asset_svg_009.svg',
        'Bubble_Bee': 'assets/asset_svg_010.svg',
        'Bucko_Bee': 'assets/asset_svg_011.svg',
        'Commander_Bee': 'assets/asset_svg_012.svg',
        'Demo_Bee': 'assets/asset_svg_013.svg',
        'Exhausted_Bee': 'assets/asset_svg_014.svg',
        'Fire_Bee': 'assets/asset_svg_015.svg',
        'Frosty_Bee': 'assets/asset_svg_016.svg',
        'Honey_Bee': 'assets/asset_svg_017.svg',
        'Rage_Bee': 'assets/asset_svg_018.svg',
        'Riley_Bee': 'assets/asset_svg_019.svg',
        'Shocked_Bee': 'assets/asset_svg_020.svg',
        'Baby_Bee': 'assets/asset_svg_021.svg',
        'Carpenter_Bee': 'assets/asset_svg_022.svg',
        'Demon_Bee': 'assets/asset_svg_023.svg',
        'Diamond_Bee': 'assets/asset_svg_024.svg',
        'Lion_Bee': 'assets/asset_svg_025.svg',
        'Music_Bee': 'assets/asset_svg_026.svg',
        'Ninja_Bee': 'assets/asset_svg_027.svg',
        'Shy_Bee': 'assets/asset_svg_028.svg',
        'Buoyant_Bee': 'assets/asset_svg_029.svg',
        'Fuzzy_Bee': 'assets/asset_svg_030.svg',
        'Precise_Bee': 'assets/asset_svg_031.svg',
        'Spicy_Bee': 'assets/asset_svg_032.svg',
        'Tadpole_Bee': 'assets/asset_svg_033.svg',
        'Vector_Bee': 'assets/asset_svg_034.svg',
        'placeholder': 'assets/asset_svg_035.svg'
    };

    // ROYAL JELLY
    const RJ_BEES = {
        rare: [
            { name:'Bomber Bee', coins:80, icon: BEE_IMAGES['Bomber_Bee'] },
            { name:'Brave Bee', coins:85, icon: BEE_IMAGES['Brave_Bee'] },
            { name:'Bumble Bee', coins:85, icon: BEE_IMAGES['Bumble_Bee'] },
            { name:'Cool Bee', coins:90, icon: BEE_IMAGES['Cool_Bee'] },
            { name:'Hasty Bee', coins:75, icon: BEE_IMAGES['Hasty_Bee'] },
            { name:'Looker Bee', coins:80, icon: BEE_IMAGES['Looker_Bee'] },
            { name:'Rad Bee', coins:85, icon: BEE_IMAGES['Rad_Bee'] },
            { name:'Rascal Bee', coins:80, icon: BEE_IMAGES['Rascal_Bee'] },
            { name:'Stubborn Bee', coins:85, icon: BEE_IMAGES['Stubborn_Bee'] }
        ],
        epic: [
            { name:'Bubble Bee', coins:120, icon: BEE_IMAGES['Bubble_Bee'] },
            { name:'Bucko Bee', coins:130, icon: BEE_IMAGES['Bucko_Bee'] },
            { name:'Commander Bee', coins:140, icon: BEE_IMAGES['Commander_Bee'] },
            { name:'Demo Bee', coins:125, icon: BEE_IMAGES['Demo_Bee'] },
            { name:'Exhausted Bee', coins:115, icon: BEE_IMAGES['Exhausted_Bee'] },
            { name:'Fire Bee', coins:135, icon: BEE_IMAGES['Fire_Bee'] },
            { name:'Frosty Bee', coins:130, icon: BEE_IMAGES['Frosty_Bee'] },
            { name:'Honey Bee', coins:140, icon: BEE_IMAGES['Honey_Bee'] },
            { name:'Rage Bee', coins:125, icon: BEE_IMAGES['Rage_Bee'] },
            { name:'Riley Bee', coins:125, icon: BEE_IMAGES['Riley_Bee'] },
            { name:'Shocked Bee', coins:120, icon: BEE_IMAGES['Shocked_Bee'] }
        ],
        legendary: [
            { name:'Baby Bee', coins:200, icon: BEE_IMAGES['Baby_Bee'] },
            { name:'Carpenter Bee', coins:220, icon: BEE_IMAGES['Carpenter_Bee'] },
            { name:'Demon Bee', coins:210, icon: BEE_IMAGES['Demon_Bee'] },
            { name:'Diamond Bee', coins:240, icon: BEE_IMAGES['Diamond_Bee'] },
            { name:'Lion Bee', coins:230, icon: BEE_IMAGES['Lion_Bee'] },
            { name:'Music Bee', coins:220, icon: BEE_IMAGES['Music_Bee'] },
            { name:'Ninja Bee', coins:210, icon: BEE_IMAGES['Ninja_Bee'] },
            { name:'Shy Bee', coins:200, icon: BEE_IMAGES['Shy_Bee'] }
        ],
        mythic: [
            { name:'Buoyant Bee', coins:400, icon: BEE_IMAGES['Buoyant_Bee'] },
            { name:'Fuzzy Bee', coins:450, icon: BEE_IMAGES['Fuzzy_Bee-0'] },
            { name:'Precise Bee', coins:420, icon: BEE_IMAGES['Precise_Bee'] },
            { name:'Spicy Bee', coins:430, icon: BEE_IMAGES['Spicy_Bee'] },
            { name:'Tadpole Bee', coins:400, icon: BEE_IMAGES['Tadpole_Bee'] },
            { name:'Vector Bee', coins:460, icon: BEE_IMAGES['Vector_Bee'] }
        ]
    };
    const RJ_RARITY_COLORS = { rare:'#3498db', epic:'#9b59b6', legendary:'#f1c40f', mythic:'#e91e8c' };

    function rjRollBee(isPlayer) {
        const r = Math.random() * 100;
        let rarity;
        // Player has slightly reduced luck ‚Äî bot gets better rare chances
        if(isPlayer) {
            // Player: rare threshold raised (harder to get good bee)
            if(r < 0.05) rarity = 'mythic';
            else if(r < 3.05) rarity = 'legendary';
            else if(r < 10.05) rarity = 'epic';
            else rarity = 'rare';
        } else {
            // Bot: slightly better luck
            if(r < 0.10) rarity = 'mythic';
            else if(r < 4.10) rarity = 'legendary';
            else if(r < 13.10) rarity = 'epic';
            else rarity = 'rare';
        }
        const pool = RJ_BEES[rarity];
        const bee = pool[Math.floor(Math.random() * pool.length)];
        return { ...bee, rarity };
    }

    function rjInit() { /* reset display */
        document.getElementById('rj-p-icon').innerHTML = '<img src="' + BEE_IMAGES['placeholder'] + '" style="opacity:0.3;filter:grayscale(1)" alt="?">';
        document.getElementById('rj-p-name').textContent = '???';
        document.getElementById('rj-p-rarity').textContent = '‚Äî';
        document.getElementById('rj-p-coins').textContent = '‚Äî coins';
        document.getElementById('rj-b-icon').innerHTML = '<img src="' + BEE_IMAGES['placeholder'] + '" style="opacity:0.3;filter:grayscale(1)" alt="?">';
        document.getElementById('rj-b-name').textContent = '???';
        document.getElementById('rj-b-rarity').textContent = '‚Äî';
        document.getElementById('rj-b-coins').textContent = '‚Äî coins';
        document.getElementById('rj-result').style.display = 'none';
    }

    function playRoyalJelly() {
        const bet = clampBet(document.getElementById('rj-bet').value);
        document.getElementById('rj-bet').value = bet;
        if(bet > userData.chips || bet < MIN_BET) { alert('Not enough ‚≠ê!'); return; }
        userData.chips -= bet; addProfit('royaljelly', -bet); updateUI();

        const btn = document.getElementById('rj-spin-btn');
        btn.disabled = true;
        document.getElementById('rj-result').style.display = 'none';

        // Animate ‚Äî spinning effect
        const pCard = document.getElementById('rj-player-card');
        const bCard = document.getElementById('rj-bot-card');
        pCard.classList.add('spinning'); bCard.classList.add('spinning');
        document.getElementById('rj-p-icon').innerHTML = '<img src="' + BEE_IMAGES['placeholder'] + '" style="opacity:0.4;filter:grayscale(1)" alt="...">';
        document.getElementById('rj-b-icon').innerHTML = '<img src="' + BEE_IMAGES['placeholder'] + '" style="opacity:0.4;filter:grayscale(1)" alt="...">';
        document.getElementById('rj-p-name').textContent = '...';
        document.getElementById('rj-b-name').textContent = '...';

        setTimeout(() => {
            pCard.classList.remove('spinning'); bCard.classList.remove('spinning');
            const playerBee = rjRollBee(true);
            const botBee = rjRollBee(false);

            // Show player bee
            document.getElementById('rj-p-icon').innerHTML = `<img src="${playerBee.icon}" alt="${playerBee.name}">`;
            document.getElementById('rj-p-name').textContent = playerBee.name;
            document.getElementById('rj-p-rarity').innerHTML = `<span style="color:${RJ_RARITY_COLORS[playerBee.rarity]}">${playerBee.rarity.toUpperCase()}</span>`;
            document.getElementById('rj-p-coins').textContent = playerBee.coins + ' coins';
            document.getElementById('rj-player-card').style.borderColor = RJ_RARITY_COLORS[playerBee.rarity];

            // Show bot bee
            document.getElementById('rj-b-icon').innerHTML = `<img src="${botBee.icon}" alt="${botBee.name}">`;
            document.getElementById('rj-b-name').textContent = botBee.name;
            document.getElementById('rj-b-rarity').innerHTML = `<span style="color:${RJ_RARITY_COLORS[botBee.rarity]}">${botBee.rarity.toUpperCase()}</span>`;
            document.getElementById('rj-b-coins').textContent = botBee.coins + ' coins';
            document.getElementById('rj-bot-card').style.borderColor = RJ_RARITY_COLORS[botBee.rarity];

            const resultEl = document.getElementById('rj-result');
            resultEl.style.display = 'block';

            if(playerBee.coins > botBee.coins) {
                const mult = playerBee.coins * 0.02;
                const win = Math.floor(bet * mult);
                userData.chips += win; play('win');
                showWinOverlay(mult, win);
                addHistory("Royal Jelly", bet, mult, win);
                addProfit('royaljelly', win);
                resultEl.className = 'rj-result win';
                resultEl.innerHTML = `üåπ YOUR BEE WINS! +${win} ‚≠ê <span style="color:#aaa;font-size:13px;">(bet √ó ${playerBee.coins} coins √ó 0.02 = ${mult.toFixed(2)}√ó)</span><br><small>${playerBee.name} (${playerBee.coins}) beats ${botBee.name} (${botBee.coins})</small>`;
            } else if(playerBee.coins === botBee.coins) {
                const halfBet = Math.floor(bet / 2);
                userData.chips += halfBet; addProfit('royaljelly', halfBet);
                resultEl.className = 'rj-result';
                resultEl.style.background = '#1a1a00'; resultEl.style.border = '2px solid #f1c40f';
                resultEl.innerHTML = `ü§ù TIE! Half bet returned: +${halfBet} ‚≠ê<br><small>${playerBee.name} = ${botBee.name} (${playerBee.coins} coins each)</small>`;
            } else {
                play('boom');
                addHistory("Royal Jelly", bet, 0, -bet);
                resultEl.className = 'rj-result lose';
                resultEl.innerHTML = `üíî BOT WINS! No reward.<br><small>${botBee.name} (${botBee.coins}) beats ${playerBee.name} (${playerBee.coins})</small>`;
            }

            updateUI();
            btn.disabled = false;
        }, 900);
    }
    // BEEQUIP WAXING
    const BEEQUIPS = [
        { id:'toyDrum', name:'Toy Drum', img:'assets/asset_png_012.png', cost:300, color:'#f39c12', desc:'Classic bee equipment. Level 7, limit 2.',
          baseStats: () => {
            const stats = [];
            stats.push({ label:'Gather Amount', val: rng(10,20), type:'pos', mult: 0 });
            stats.push({ label:'Bee Attack', val: rng(1,5), type:'pos', mult: 0 });
            stats.push({ label:'Energy', val: -rng(10,20), type:'neg', mult: 0 });
            if(Math.random()<0.5) stats.push({ label:'Critical Chance', val: rng(1,5), type:'pos', mult: 0 });
            if(Math.random()<0.6) stats.push({ label:'Ability: Haste', val: null, type:'special', mult: 0 });
            return stats;
          }
        },
        { id:'pinkShades', name:'Pink Shades', img:'assets/asset_png_013.png', cost:300, color:'#e91e8c', desc:'Exclusive beequip. Level 10, limit 1, Gifted only.',
          baseStats: () => {
            const stats = [];
            stats.push({ label:'Ability Pollen', val: rng(15,65), type:'pos', mult: 0 });
            stats.push({ label:'Critical Power', val: rng(25,50), type:'pos', mult: 0 });
            stats.push({ label:'Critical Chance', val: rng(20,68), type:'pos', mult: 0 });
            stats.push({ label:'Super-Crit Chance', val: rng(10,55), type:'pos', mult: 0 });
            if(Math.random()<0.5) stats.push({ label:'Ability: Focus', val: null, type:'special', mult: 0 });
            return stats;
          }
        },
        { id:'poinsettia', name:'Poinsettia', img:'assets/asset_png_014.png', cost:300, color:'#e74c3c', desc:'Red hive beequip. Level 6, limit 2.',
          baseStats: () => {
            const stats = [];
            stats.push({ label:'Red Gather Amount', val: rng(10,20), type:'pos', mult: 0 });
            stats.push({ label:'Pollination Chance', val: rng(10,20), type:'pos', mult: 0 });
            return stats;
          }
        },
        { id:'smiley', name:'Smiley Sticker', img:'assets/asset_png_015.png', cost:100, color:'#f1c40f', desc:'Gifted only beequip. Level 7, limit 2.',
          baseStats: () => {
            const stats = [];
            stats.push({ label:'Energy', val: rng(15,25), type:'pos', mult: 0 });
            stats.push({ label:'Bomb Pollen', val: rng(10,20), type:'pos', mult: 0 });
            stats.push({ label:'Mark Duration', val: rng(5,10), type:'pos', mult: 0 });
            return stats;
          }
        },
        { id:'reindeer', name:'Reindeer Antlers', img:'assets/asset_png_016.png', cost:300, color:'#27ae60', desc:'Beesmas beequip. Limit 1, Puppy Bee.',
          baseStats: () => {
            const stats = [];
            stats.push({ label:'Convert Amount', val: rng(10,15), type:'pos', mult: 0 });
            stats.push({ label:'Ability Pollen', val: rng(10,15), type:'pos', mult: 0 });
            stats.push({ label:'Move Speed', val: rng(2,8), type:'pos', mult: 0 });
            if(Math.random()<0.5) stats.push({ label:'Ability: Focus', val: null, type:'special', mult: 0 });
            if(Math.random()<0.5) stats.push({ label:'Ability: Reindeer Fetch', val: null, type:'special', mult: 0 });
            return stats;
          }
        }
    ];
    function rng(min,max){ return Math.floor(Math.random()*(max-min+1))+min; }

    let bwState = {
        beequip: null, stats: [], waxesUsed: [], potential: 0,
        destroyed: false
    };

    function bwInit() {
        const grid = document.getElementById('bq-shop-grid');
        grid.innerHTML = '';
        BEEQUIPS.forEach(bq => {
            const card = document.createElement('div');
            card.className = 'bq-card';
            const iconHtml = bq.img
                ? `<img src="${bq.img}" style="width:36px;height:36px;object-fit:contain;border-radius:6px;" />`
                : `<div class="bq-icon">${bq.icon}</div>`;
            card.innerHTML = `${iconHtml}<div class="bq-name">${bq.name}</div><div class="bq-cost">Cost: ${bq.cost} ‚≠ê</div>`;
            card.onclick = () => bwBuyBeequip(bq);
            grid.appendChild(card);
        });
        // Also add free play option
        const free = document.createElement('div');
        free.className = 'bq-card';
        free.innerHTML = `<div class="bq-icon">üéÅ</div><div class="bq-name">Free Play</div><div class="bq-cost" style="color:#27ae60">Random ¬∑ Free</div>`;
        free.onclick = () => bwBuyBeequip(BEEQUIPS[Math.floor(Math.random()*BEEQUIPS.length)], true);
        grid.appendChild(free);
    }

    function bwBuyBeequip(bq, free=false) {
        if(!free) {
            if(userData.chips < bq.cost) { bwLog('Not enough ‚≠ê Stars!', 'bad'); return; }
            userData.chips -= bq.cost; updateUI();
        }
        bwState.beequip = bq;
        bwState.stats = bq.baseStats();
        bwState.waxesUsed = [];
        bwState.potential = 0;
        bwState.destroyed = false;
        document.getElementById('bw-shop').classList.add('hidden');
        document.getElementById('bw-main').classList.remove('hidden');
        bwRender();
        bwLog(free ? 'Free Play Beequip minted! Stats generated.' : `Bought ${bq.name} for ${bq.cost} ‚≠ê. Stats generated.`, 'info');
    }

    function bwBack() {
        document.getElementById('bw-shop').classList.remove('hidden');
        document.getElementById('bw-main').classList.add('hidden');
    }

    function bwRender() {
        const bq = bwState.beequip;
        if(bq.img) {
            document.getElementById('bq-disp-icon').innerHTML = `<img src="${bq.img}" style="width:40px;height:40px;object-fit:contain;border-radius:6px;" />`;
        } else {
            document.getElementById('bq-disp-icon').innerText = bq.icon;
        }
        document.getElementById('bq-disp-name').innerText = bq.name;
        document.getElementById('bq-disp-pot').innerText = `‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ ¬∑ Potential: ${bwState.potential}/10`;
        // Show sell preview
        if(!bwState.destroyed) {
            const preview = bwGetReward();
            const modeStr = preview.mode ? ` ¬∑ Mode: ${preview.mode}` : '';
            const scpStr = preview.scp !== null ? ` ¬∑ SCP: ${preview.scp}` : '';
            document.getElementById('bq-hive-bonus').innerText = `üí∞ Est. Sell: ~${preview.reward} ‚≠ê${modeStr}${scpStr}`;
        } else {
            document.getElementById('bq-hive-bonus').innerText = `üí• DESTROYED`;
        }
        document.getElementById('bq-wax-count').innerText = bwState.waxesUsed.length;
        // Slots
        const slots = document.getElementById('bq-slots');
        slots.innerHTML = '';
        for(let i=0;i<5;i++){
            const s=document.createElement('div'); s.className='bq-slot';
            if(bwState.waxesUsed[i]){
                const w=bwState.waxesUsed[i];
                s.classList.add('used-'+w);
                s.innerText = w==='soft'?'üü°':w==='hard'?'üîµ':w==='caustic'?'üü¢':'üü£';
            }
            slots.appendChild(s);
        }
        // Stats
        const statsDiv = document.getElementById('bq-stats-display');
        statsDiv.innerHTML = bwState.stats.map(st => {
            const cls = st.type==='pos'?'bq-stat-pos':st.type==='neg'?'bq-stat-neg':st.type==='hive'?'bq-stat-neutral':'bq-stat-neutral';
            const isHive = st.type==='hive';
            const pct = ['Chance','Power','Pollen','Amount','Rate','Gather','Love','Bond','Convert','Token','Crit','Speed','Duration'].some(k=>st.label.includes(k));
            const val = st.val===null ? '' : (st.type==='neg'?`${st.val}%`:`+${st.val}${pct?'%':''}`);
            const prefix = isHive ? '[Hive Bonus] +' : '';
            return `<div class="${cls}">${st.val===null?`+Ability: <b>${st.label.replace('Ability: ','')}</b>`:`${prefix}${st.label} (${val})`}</div>`;
        }).join('');

        // Destroyed state
        if(bwState.destroyed) document.getElementById('bq-active-card').classList.add('bq-destroyed');
        else document.getElementById('bq-active-card').classList.remove('bq-destroyed');
    }

    function bwLog(msg, type='info') {
        const log = document.getElementById('bw-log');
        const div = document.createElement('div');
        div.className = 'log-'+type;
        div.innerText = msg;
        log.appendChild(div);
        log.scrollTop = log.scrollHeight;
    }

    function applyWax(type) {
        if(bwState.destroyed){ bwLog('Beequip is destroyed! Go back and buy a new one.', 'bad'); return; }
        if(bwState.waxesUsed.length >= 5){ bwLog('Max 5 waxes reached! Sell this beequip or go back.', 'bad'); return; }
        const inv = bwState.inv;
        // Check inventory / cost
        if(type==='soft'){ /* always free */ }
        else if(type==='hard'){
            if(userData.chips < 2){ bwLog('Not enough ‚≠ê for Hard Wax (costs 2 ‚≠ê)!','bad'); return; }
            userData.chips -= 2; updateUI();
        }
        else if(type==='caustic'){
            if(userData.chips < 20){ bwLog('Not enough ‚≠ê for Caustic Wax (costs 20 ‚≠ê)!','bad'); return; }
            userData.chips -= 20; updateUI();
        } else if(type==='swirled'){
            if(userData.chips < 20){ bwLog('Not enough ‚≠ê for Swirled Wax (costs 20 ‚≠ê)!','bad'); return; }
            userData.chips -= 20; updateUI();
        }

        if(type==='swirled'){
            const hadCaustic = bwState.waxesUsed.includes('caustic');
            if(!hadCaustic) {
                bwLog('‚ö†Ô∏è Swirled Wax only works after Caustic Wax!', 'bad');
                // Refund
                userData.chips += 20; updateUI();
                return;
            }
            // Reroll only the hive bonus stat, keep everything else
            const hivePools = {
                toyDrum:    [{ label:'Hive: Bee Ability Pollen', type:'hive', mult:0.8 }],
                pinkShades: [{ label:'Hive: Super-Crit Chance', type:'hive', mult:0.85 },
                             { label:'Hive: Super-Crit Power', type:'hive', mult:0.9 }],
                poinsettia: [{ label:'Hive: Bee Gather Pollen', type:'hive', mult:0.75 },
                             { label:'Hive: Red Pollen', type:'hive', mult:0.8 }],
                smiley:     [{ label:'Hive: Bee Ability Pollen', type:'hive', mult:0.75 },
                             { label:'Hive: Convert Rate', type:'hive', mult:0.8 }],
                reindeer:   [{ label:'Hive: Baby Love', type:'hive', mult:0.75 }]
            };
            const pool = hivePools[bwState.beequip.id] || [];
            const hasHive = bwState.stats.some(s => s.type==='hive');
            if(pool.length > 0) {
                // Remove old hive stats
                bwState.stats = bwState.stats.filter(s => s.type !== 'hive');
                // Pick new random hive stat from pool
                const pick = pool[Math.floor(Math.random()*pool.length)];
                bwState.stats.push({ ...pick, val: rng(1, 8) });
                bwLog('üü£ Swirled Wax rerolled the Hive Bonus!', 'purple');
            } else {
                bwLog('üü£ Swirled Wax used but no Hive Bonus available for this beequip.', 'info');
            }
            bwState.waxesUsed.push('swirled');
            bwRender(); return;
        }

        const roll = Math.random();
        let success = false;
        let potGain = 0;
        if(type==='soft'){ success=true; potGain=1; }
        else if(type==='hard'){ success=roll<0.30; potGain=2; }
        else if(type==='caustic'){
            if(roll<0.20){ success=true; potGain=4; }
            else {
                bwState.waxesUsed.push('caustic');
                bwState.destroyed=true;
                bwLog('üü¢ Caustic Wax used... üí• THE WAX DESTROYED THE BEEQUIP!', 'bad');
                play('boom');
                bwRender(); return;
            }
        }

        if(success){
            bwState.potential += potGain;
            bwState.waxesUsed.push(type);
            // Improve stats (only val, not mult ‚Äî mult is exclusive to hive bonuses)
            bwState.stats = bwState.stats.map(st => {
                if(st.val!==null && st.type !== 'hive'){
                    const boost = Math.ceil(potGain * (1+Math.random()));
                    st.val = st.type==='neg' ? st.val + Math.floor(boost/2) : st.val + boost;
                    // mult stays 0 for non-hive stats
                }
                return st;
            });
            // Caustic wax success: chance to add a Hive Bonus stat
            if(type==='caustic') {
                const hivePools = {
                    toyDrum:    [{ label:'Hive: Bee Ability Pollen', val: rng(1,5), type:'hive', mult:0.8 }],
                    pinkShades: [{ label:'Hive: Super-Crit Chance', val: rng(1,5), type:'hive', mult:0.85 },
                                 { label:'Hive: Super-Crit Power', val: rng(1,5), type:'hive', mult:0.9 }],
                    poinsettia: [{ label:'Hive: Bee Gather Pollen', val: rng(1,5), type:'hive', mult:0.75 },
                                 { label:'Hive: Red Pollen', val: rng(1,5), type:'hive', mult:0.8 }],
                    smiley:     [{ label:'Hive: Bee Ability Pollen', val: rng(1,5), type:'hive', mult:0.75 },
                                 { label:'Hive: Convert Rate', val: rng(1,5), type:'hive', mult:0.8 }],
                    reindeer:   [{ label:'Hive: Baby Love', val: rng(1,5), type:'hive', mult:0.75 }]
                };
                const pool = hivePools[bwState.beequip.id] || [];
                const alreadyHasHive = bwState.stats.some(s => s.type==='hive');
                if(pool.length > 0 && !alreadyHasHive) {
                    const pick = pool[Math.floor(Math.random()*pool.length)];
                    bwState.stats.push({...pick, val: rng(1,5)});
                    bwLog('üü¢ Caustic Wax unlocked a Hive Bonus stat!', 'purple');
                } else if(alreadyHasHive) {
                    // Boost existing hive stat
                    bwState.stats = bwState.stats.map(st => {
                        if(st.type==='hive') { st.val += rng(1,3); st.mult = Math.min(2.5, (st.mult||1)+0.1); }
                        return st;
                    });
                    bwLog('üü¢ Caustic Wax boosted the Hive Bonus!', 'purple');
                }
            }
            const waxName = type==='soft'?'Soft':type==='hard'?'Hard':'Caustic';
            bwLog(`‚úÖ ${waxName} Wax improved the Beequip! +${potGain} potential.`, 'good');
        } else {
            bwState.waxesUsed.push(type);
            bwLog(`‚ùå Hard Wax failed to improve the Beequip. No change.`, 'bad');
        }
        bwRender();
    }

    function bwGetReward() {
        const bq = bwState.beequip;
        const stats = bwState.stats;

        if(bq.id === 'pinkShades') {
            // SCP = Hive: Super-Crit Power value (from hive bonus only)
            const hiveSCPStat = stats.find(s => s.label === 'Hive: Super-Crit Power' && s.type === 'hive');
            const hiveSCCStat = stats.find(s => s.label === 'Hive: Super-Crit Chance' && s.type === 'hive');
            const scp = hiveSCPStat ? hiveSCPStat.val : 0;
            const hasFocus = stats.some(s => s.label === 'Ability: Focus' && s.val === null);
            const hasSCC = !!hiveSCCStat;
            // Reward tables (max 12000)
            const tables = {
                'NONE':       {0:67,2:67,3:67,4:67,5:67,6:105,7:180,8:285,9:360,10:690,11:1080,12:1875,13:2400,14:3150,15:4800},
                'FOCUS':      {0:67,2:67,3:67,4:67,5:67,6:112,7:195,8:300,9:390,10:735,11:1125,12:2100,13:2850,14:3750,15:5700},
                'SCC':        {0:67,2:165,3:270,4:465,5:795,6:1350,7:2100,8:3000,9:4500,10:6000,11:7500,12:7500,13:7500,14:7500,15:7500},
                'FOCUS+SCC':  {0:90,2:195,3:330,4:525,5:870,6:1470,7:2325,8:3300,9:4950,10:6000,11:7500,12:6750,13:7500,14:7500,15:7500}
            };
            let mode = 'NONE';
            if(hasFocus && hasSCC) mode = 'FOCUS+SCC';
            else if(hasFocus) mode = 'FOCUS';
            else if(hasSCC) mode = 'SCC';
            const table = tables[mode];
            // Find closest SCP tier (SCP = Hive: Super-Crit Power value)
            const tiers = Object.keys(table).map(Number).sort((a,b)=>a-b);
            let tier = tiers[0];
            for(let t of tiers) { if(scp >= t) tier = t; }
            const base = table[tier];
            const reward = Math.min(12000, Math.floor(base * (1 + bwState.potential * 0.05)));
            return { reward, mode, scp, tier };
        }

        // Generic reward for other beequips based on potential and hive bonuses only
        const pot = bwState.potential;
        const hiveMult = stats.filter(s => s.type==='hive').reduce((acc, st) => acc * (st.mult||1), 1);
        const reward = Math.floor((10 + pot * 15 + Math.random()*10*pot) * Math.max(1, hiveMult));
        return { reward, mode: null, scp: null, tier: null };
    }

    function bwSellBeequip() {
        if(!bwState.beequip) return;
        if(bwState.destroyed) { bwLog('Destroyed beequip has no sell value.', 'bad'); setTimeout(()=>bwBack(), 1000); return; }
        const { reward, mode, scp, tier } = bwGetReward();
        if(reward > 0) {
            userData.chips += reward;
            play('win');
            showWinOverlay(reward/bwState.beequip.cost, reward);
            addHistory("Beequip Waxing", bwState.beequip.cost, reward/bwState.beequip.cost, reward);
            const modeStr = mode ? ` [${mode}, ${scp} SCP]` : '';
            bwLog(`üí∞ Sold ${bwState.beequip.name} for ${reward} ‚≠ê!${modeStr}`, 'good');
        } else {
            bwLog('No reward ‚Äî try waxing first!', 'bad');
        }
        updateUI();
        setTimeout(()=>bwBack(), 1200);
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // TOAST NOTIFICATION SYSTEM
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    function toast(msg, type = 'info', duration = 3000) {
        const icons = { success:'‚úÖ', error:'‚ùå', warn:'‚ö†Ô∏è', info:'‚ÑπÔ∏è' };
        const container = document.getElementById('toast-container');
        const el = document.createElement('div');
        el.className = `toast toast-${type}`;
        el.innerHTML = `<span>${icons[type]||''}</span><span>${msg}</span>`;
        container.appendChild(el);
        setTimeout(() => {
            el.classList.add('toast-exit');
            setTimeout(() => el.remove(), 320);
        }, duration);
    }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // BET LOCK ‚Äî prevents double-click chip drain
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    let _betLocked = false;
    let _lastBetTime = 0;
    const BET_COOLDOWN_MS = 600;

    function acquireBetLock() {
        const now = Date.now();
        if(_betLocked) { toast('Please wait‚Ä¶', 'warn', 1200); return false; }
        if(now - _lastBetTime < BET_COOLDOWN_MS) { toast('Slow down!', 'warn', 1200); return false; }
        _betLocked = true;
        _lastBetTime = now;
        return true;
    }
    function releaseBetLock() { _betLocked = false; }

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // ANTICHEAT ENGINE
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    let _acChipsSnapshot = 0;
    let _acEnabled = false;
    let _acCheckInterval = null;
    const _acAllowedSources = new Set(); // timestamps of legitimate chip changes

    function acInit(chips) {
        _acChipsSnapshot = chips;
        _acEnabled = true;
        // Check every 2s if chips match our snapshot
        _acCheckInterval = setInterval(acCheck, 2000);
        // DevTools size detection
        setInterval(acDevToolsCheck, 1500);
    }

    function acLegitChange(newChips) {
        _acChipsSnapshot = newChips;
        _acAllowedSources.add(Date.now());
    }

    function acCheck() {
        if(!_acEnabled || !userData) return;
        const actual = Math.floor(userData.chips);
        const snap = Math.floor(_acChipsSnapshot);
        // Allow small floating point differences
        if(Math.abs(actual - snap) > 1 && !_acPendingLegit()) {
            acTrigger('Chip value tampered: expected ' + snap + ' got ' + actual);
        }
    }

    function _acPendingLegit() {
        const now = Date.now();
        for(let ts of _acAllowedSources) {
            if(now - ts < 4000) return true;
        }
        // Cleanup old entries
        _acAllowedSources.forEach(ts => { if(now - ts > 4000) _acAllowedSources.delete(ts); });
        return false;
    }

    let _devToolsOpen = false;
    function acDevToolsCheck() {
        const threshold = 160;
        const widthDiff = window.outerWidth - window.innerWidth;
        const heightDiff = window.outerHeight - window.innerHeight;
        if((widthDiff > threshold || heightDiff > threshold) && !_devToolsOpen) {
            _devToolsOpen = true;
            toast('‚ö†Ô∏è DevTools detected ‚Äî cheating is not allowed!', 'warn', 5000);
        } else if(widthDiff <= threshold && heightDiff <= threshold) {
            _devToolsOpen = false;
        }
    }

    function acTrigger(reason) {
        _acEnabled = false;
        clearInterval(_acCheckInterval);
        console.warn('[AC]', reason);
        document.getElementById('ac-warning').classList.add('show');
        // Reset to snapshot value and save
        if(userData) {
            userData.chips = _acChipsSnapshot;
            fetch(`${DB_URL}/${currentUser}.json`, { method: 'PUT', body: JSON.stringify(userData) });
        }
    }

    // Wrap updateUI to track chip snapshots
    const _origUpdateUI = updateUI;
    // We'll patch updateUI after defining it ‚Äî see below

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    // PROVABLY FAIR ENGINE
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    const pfState = {
        serverSeed: '',
        serverSeedHash: '',
        prevServerSeed: null,
        clientSeed: 'client-seed-' + Math.random().toString(36).slice(2,8),
        nonce: 0,
        history: [],
        copied: null,
        activeTab: 'seeds'
    };

    function pfBytesToHex(bytes) {
        return Array.from(bytes).map(b => b.toString(16).padStart(2,'0')).join('');
    }
    function pfHexToBytes(hex) {
        const a = new Uint8Array(hex.length/2);
        for(let i=0;i<hex.length;i+=2) a[i/2]=parseInt(hex.slice(i,i+2),16);
        return a;
    }
    function pfRandomHex(len=64){
        const a=new Uint8Array(len/2); crypto.getRandomValues(a); return pfBytesToHex(a);
    }
    async function pfSha256(hex){
        const h=await crypto.subtle.digest('SHA-256', pfHexToBytes(hex));
        return pfBytesToHex(new Uint8Array(h));
    }
    async function pfHmac(key, msg){
        const enc=new TextEncoder();
        const ck=await crypto.subtle.importKey('raw',enc.encode(key),{name:'HMAC',hash:'SHA-256'},false,['sign']);
        const sig=await crypto.subtle.sign('HMAC',ck,enc.encode(msg));
        return pfBytesToHex(new Uint8Array(sig));
    }
    function pfHmacToFloat(hmac){ return parseInt(hmac.slice(0,8),16)/0x100000000; }

    // Public: call this instead of Math.random() from game code
    async function pfRoll(){
        const msg = `${pfState.clientSeed}:${pfState.nonce}`;
        const hmac = await pfHmac(pfState.serverSeed, msg);
        const float = pfHmacToFloat(hmac);
        const roll = Math.floor(float*10000)/100;
        const entry = {
            serverSeedHash: pfState.serverSeedHash,
            clientSeed: pfState.clientSeed,
            nonce: pfState.nonce,
            hmac, float, roll,
            ts: new Date().toLocaleTimeString()
        };
        pfState.history.unshift(entry);
        if(pfState.history.length>30) pfState.history.pop();
        pfState.nonce++;
        pfRenderNonce();
        pfRenderResult(entry);
        pfRenderHistory();
        return float; // [0,1)
    }

    async function pfInit(){
        const seed = pfRandomHex(64);
        const hash = await pfSha256(seed);
        pfState.serverSeed = seed;
        pfState.serverSeedHash = hash;
        pfState.nonce = 0;
        document.getElementById('pf-hash-display').textContent = hash.slice(0,28)+'‚Ä¶';
        document.getElementById('pf-client-input').value = pfState.clientSeed;
        pfRenderNonce();
    }

    function pfRenderNonce(){
        document.getElementById('pf-nonce-display').textContent = pfState.nonce;
    }

    function pfRenderResult(e){
        document.getElementById('pf-result-area').innerHTML = `
            <div class="pf-result-box">
                <div class="pf-result-header">
                    <span class="pf-result-title">Last Roll</span>
                    <span class="pf-roll-badge">${e.roll.toFixed(2)}</span>
                </div>
                <div class="pf-row"><span class="pf-rl">HMAC</span><span class="pf-rv">${e.hmac.slice(0,26)}‚Ä¶ <button class="pf-copy-btn" onclick="pfCopy('${e.hmac}','lhmac')">‚ßâ</button></span></div>
                <div class="pf-row"><span class="pf-rl">Nonce</span><span class="pf-rv">${e.nonce}</span></div>
                <div class="pf-row"><span class="pf-rl">Float</span><span class="pf-rv">${e.float.toFixed(8)}</span></div>
            </div>`;
    }

    function pfRenderHistory(){
        const el = document.getElementById('pf-history-list');
        if(!pfState.history.length){ el.innerHTML='<p class="pf-hint">No rolls yet.</p>'; return; }
        el.innerHTML = pfState.history.map((h,i)=>`
            <div class="pf-history-row">
                <div style="display:flex;align-items:center;gap:10px;">
                    <span class="pf-roll-badge">${h.roll.toFixed(2)}</span>
                    <div>
                        <div style="font-size:11px;color:#9ca3af;">Nonce ${h.nonce} ¬∑ ${h.ts}</div>
                        <div style="font-size:11px;color:#6b7280;">${h.hmac.slice(0,22)}‚Ä¶</div>
                    </div>
                </div>
                <button class="pf-copy-btn" onclick="pfCopy(JSON.stringify(pfState.history[${i}],null,2),'hist${i}')">‚ßâ</button>
            </div>`).join('');
    }

    async function pfRotate(){
        const btn = document.getElementById('pf-rotate-btn');
        btn.textContent='Rotating‚Ä¶'; btn.disabled=true;
        pfState.prevServerSeed = { seed: pfState.serverSeed, hash: pfState.serverSeedHash, clientSeed: pfState.clientSeed, nonce: pfState.nonce };
        const seed = pfRandomHex(64);
        const hash = await pfSha256(seed);
        pfState.serverSeed = seed;
        pfState.serverSeedHash = hash;
        pfState.nonce = 0;
        document.getElementById('pf-hash-display').textContent = hash.slice(0,28)+'‚Ä¶';
        pfRenderNonce();
        // show revealed seed
        const prev = pfState.prevServerSeed;
        document.getElementById('pf-reveal-area').innerHTML = `
            <div class="pf-reveal-box">
                <span style="display:block;font-size:13px;font-weight:700;color:#60a5fa;margin-bottom:8px;">üîì Previous Seed Revealed</span>
                <div class="pf-row"><span class="pf-rl">Seed</span><span class="pf-rv">${prev.seed.slice(0,24)}‚Ä¶ <button class="pf-copy-btn" onclick="pfCopy('${prev.seed}','prev')">‚ßâ</button></span></div>
                <div class="pf-row"><span class="pf-rl">Hash</span><span class="pf-rv">${prev.hash.slice(0,24)}‚Ä¶</span></div>
                <p class="pf-hint" style="margin-top:6px;">SHA256(revealed seed) = hash you saw before ‚Äî verify it independently!</p>
            </div>`;
        btn.textContent='‚ü≥ Rotate Server Seed'; btn.disabled=false;
    }

    function pfUpdateClient(){
        const v = document.getElementById('pf-client-input').value.trim();
        if(v) { pfState.clientSeed = v; pfState.nonce = 0; pfRenderNonce(); }
    }
    function pfRandomizeClient(){
        const v = 'client-'+pfRandomHex(8);
        document.getElementById('pf-client-input').value = v;
        pfState.clientSeed = v; pfState.nonce = 0; pfRenderNonce();
    }

    async function pfVerify(){
        const seed = document.getElementById('pfv-seed').value.trim();
        const client = document.getElementById('pfv-client').value.trim();
        const nonce = parseInt(document.getElementById('pfv-nonce').value)||0;
        if(!seed||!client){ document.getElementById('pfv-result').innerHTML='<p style="color:#ef4444;">Fill in all fields.</p>'; return; }
        try {
            const hmac = await pfHmac(seed, `${client}:${nonce}`);
            const float = pfHmacToFloat(hmac);
            const roll = Math.floor(float*10000)/100;
            const hash = await pfSha256(seed);
            document.getElementById('pfv-result').innerHTML = `
                <div class="pf-result-box" style="margin-top:14px;">
                    <div class="pf-result-header"><span class="pf-result-title">‚úì Verified</span><span class="pf-roll-badge">${roll.toFixed(2)}</span></div>
                    <div class="pf-row"><span class="pf-rl">HMAC</span><span class="pf-rv">${hmac.slice(0,28)}‚Ä¶</span></div>
                    <div class="pf-row"><span class="pf-rl">Hash</span><span class="pf-rv">${hash.slice(0,28)}‚Ä¶</span></div>
                    <div class="pf-row"><span class="pf-rl">Float</span><span class="pf-rv">${float.toFixed(8)}</span></div>
                </div>`;
        } catch(e) {
            document.getElementById('pfv-result').innerHTML='<p style="color:#ef4444;">Verification failed.</p>';
        }
    }

    function pfCopy(text, key){
        navigator.clipboard.writeText(text);
        // flash feedback via alert-less approach
        const prev = pfState.copied;
        pfState.copied = key;
        setTimeout(()=>{ if(pfState.copied===key) pfState.copied=null; },1500);
    }

    function pfTab(t){
        pfState.activeTab = t;
        ['seeds','verify','history'].forEach(n=>{
            document.getElementById('pftab-'+n).classList.toggle('active', n===t);
            document.getElementById('pfpanel-'+n).style.display = n===t ? '' : 'none';
        });
        if(t==='history') pfRenderHistory();
    }

    function pfOpen(){ document.getElementById('pf-overlay').classList.add('open'); }
    function pfClose(){ document.getElementById('pf-overlay').classList.remove('open'); }
    function pfOverlayClick(e){ if(e.target===document.getElementById('pf-overlay')) pfClose(); }

    window.onload = async () => {
        pfInit();
        if(window.location.hash && window.location.hash.includes('access_token')) {
            const handled = await handleDiscordCallback();
            if(handled) return;
        }
        if(currentUser) {
            const r = await fetch(`${DB_URL}/${currentUser}.json`);
            userData = await r.json();
            if(userData) {
                loginSuccess();
                if(userData.discord && userData.displayName && userData.avatarUrl) {
                    injectDiscordAvatar(userData.displayName, userData.avatarUrl);
                }
            }
        }
    };

    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    //  KILL A BUG GAME
    // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    const KAB_IMG_LADYBUG = 'assets/asset_png_017.png';
    const KAB_IMG_SPIDER = 'assets/asset_png_018.png';
    const KAB_IMG_BEETLE = 'assets/asset_png_019.png';
    const KAB_BUGS = {
        ladybug: { emoji:'üêû', name:'LADYBUG', label:'Ladybug', tokens:5, minBet:50, color:'#e74c3c', elimChance:0.20, imgSrc: "data:image/png;base64,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",
            weights:[{mult:0,prob:5},{mult:0.1,prob:36.1},{mult:0.2,prob:26.6},{mult:0.3,prob:13.3},{mult:0.4,prob:8.55},{mult:0.5,prob:4.75},{mult:0.6,prob:2.85},{mult:1,prob:1.9},{mult:2,prob:0.665},{mult:5,prob:0.266},{mult:10,prob:0.019}] },
        spider: { emoji:'üï∑Ô∏è', name:'SPIDER', label:'Spider', tokens:7, minBet:100, color:'#9b59b6', elimChance:0.40, imgSrc: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAHSUlEQVR4nO3dP3IbNxTH8XUmKawmRdQ6VSamy7j2JXIH5Q45Qu4Q3SGXUO2Ukj2p4lYp0tCFMqMUHox2oAUWfx6wDw/fT6OxRZHAA34ESO4ulwUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKC3q9PF49FtwLyk59/Xknfm+I28vju/aPE4o/vl7bfJg/n7+3+p4YbWT8jiRU9p8MyByQlFyMxh6T2/mheawMRD8eN3+4v4x3/+C/7OeliOnj/di3t0h3vzw5ESiD1+YCyFRNv8OLyw2goipUUwfBaCon381RVUe8FSrMPRIhi+dVC0h2S08VXTkJBRCvrX5btn7fzjp9tuj//zn2+e/d8P9zeH12WU8QtR27AQbQXfCoavZVC2guHrGRRt41NrmIaGHDkgKeFwWoQkJRxOq5BYC4Rv2IaH9BqwnHA4kiHJCYcjERLrgfCZ6UhIiwEtCYcjEZKScDi5IZktEL72b7EczB+8rQHn0JgnswfCN01HQ3InRM3q4dSsIjWrh7NeRQhE3LQdD0mZML/ev616jCMD8tvl+93bzBwIn/ktVq6ULZk/yWoD0xKBqENAdowWGAIhi4Bk8if/1oTsGZiUQPiPf73ctGqOOTyTFIi9UE+ZsK9fvSx+7A+fPu/eJhZIDYefjIRiFch5J6s2MLWB8BGQPBSrUOkn6SkTfs/rVy8P+yR9NhSsgsSxWCmBCa0wGo7Fso6iVZI+mvfDp89Zr1G0Hc1rDYUTwvkgNlFAQe5Mwh5nEYa4swu1n1k4CooorPfpts5Ip92O5KujG2DNenLGLtcjiXC0QzEb4aomNlDQxrgu1tgobAdcWXFcycW9Ol08chRoPa7Nq0PqfM4KSMrtCFG6d9+nX5n85m/qmkpyroq/cuQUzricUIT+buaw9P7+GdFCSzbeUohioXhz+c3u39/ePwR/ZyksGuePyqu7p9Ieoq1gpARiz1ZgtAdl1HFXWdRRi7nmh0MiGD4/KEeFxMJ4hahqTA6tg9IjGL6WQdFa516Ga3CO3oO7DkePYPjWQUkJyeyTP4XJTuWQnCR35y8/jwiH40JyupC7T6uTP8W0Hc8hGaIXF/XheTyH39XKNfPkT0FxKrltleQzthS3oml/h0szClfBhSN1SyX5zJ+6ErktFyEpQ9EK5YYj1eP5QWQbtkZIynHCVIHSw0VSSIdjrWW7rSIgFY58tyrHKO3UiIBkarW1as21l1UkDwHJYGVyWelHDwSkwGirhzNqu49EQBKNurXysdXKQ0CACAKSwMrq4bCKpCMgQAQBASIIyA5r2yuHbVYaAgJEEBAggoBEWN1eOWyz9hEQIIKAABEEBIggIAHWX384vA6JIyBABAEBIggIEEFAgAgCAkQQECCCgAARBASIICBABAFRRvIC16gn/jXQyOeHYv3vltfqxT4CcqCU1cLdhqAcg8vhR7Q4YDEUiq0A5Ny2FF+NEMcK0kFspYhNdvc7tmDHISANSa0A69uHwkJQ2iAgwlpvi0JhYVVpg33njpTXIaVbKCmlj8/rj32sIBV6vIhOwRasHQKSSUsoQtiCyWJpTXB1Cp+vPcJki23Bru/YXsVQnIhQMEYIRUgoLARlG0XxhEJxd7Z1hZPb+4fldLH9O8LyhEIs8S2UmyyWLgPkv3uV0v9ZTf0iPTQxZpsU6/76NXH/nq0mznSdrgmFhVUk57MPnkAmCYjUFmJ99cERQ+LCsSx5Hw7OvAUz3bkWz4AjryISn5zPtqqY61SPARwxJC0OK5khLCY60nsLMNpWq3RrlcryFmzoxh/5DNZqFXk8P4h/ENnzoERrq8pwjdY0AFIhaXk08JFH7Goaq1JDNFTzEl4akpKrl+SGRcvh7JrHb4/qxo3yDJQaktyVomZl0RIO3yhj6qhr1GgFdEIv3KW2T6n30/oFuaQRxlpFQ0ZegtdcSEIHAS6LzJHAsbDcnb/81B6ONc3jr3JvenRRShx1zoi1cz20zQne2agQC4V7JndafF6y3k4tS3zlslTfnn3p8kCal9BcOX3Z+uZYiaD4wViW51uqWWsuremda3gGkFA7QLGvWE4JzFYgnJqjcpfFzli06ke3ww6sDMSyyBzsWKPFwYbLYmeMJPvRPCAjFf3IY7r2cAxVWMs516ToIxd3baR+1LJSB+n5N0zHJVmZDK1QnyfTdJZBLzN73Ux3cPbBlTZjPc11asZBPMIsdTbRkVkGSyvL9R+28ZYHZWTWxmWoBlsrvnUWxkt9Iy0UGeOOo8qGjVpMpBlpfNU0ZqSiQY72cVd5wtSy6CgO+tI4H9ScMLUshAJPtMwTTpiCeiZPmCIUaKH3vBK9Q0KBnnrMt+o7IRTQoNU8LPpDQgHNJOcn3zIE02rnbfGXeBIKjCD2BaWimt450BnzGQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAbf8DrAxhwmv7OAcAAAAASUVORK5CYII=",
            weights:[{mult:0,prob:10},{mult:0.1,prob:30.6},{mult:0.2,prob:23.4},{mult:0.3,prob:13.5},{mult:0.4,prob:9},{mult:0.5,prob:6.3},{mult:0.6,prob:3.6},{mult:1,prob:2.25},{mult:2,prob:0.9},{mult:5,prob:0.432},{mult:10,prob:0.018}] },
        beetle: { emoji:'ü™≤', name:'KING BEETLE', label:'King Beetle', tokens:10, minBet:300, color:'#f39c12', elimChance:0.60, imgSrc: "data:image/png;base64,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",
            weights:[{mult:0,prob:15},{mult:0.1,prob:25.5},{mult:0.2,prob:20.4},{mult:0.3,prob:13.6},{mult:0.4,prob:9.35},{mult:0.5,prob:6.8},{mult:0.6,prob:4.25},{mult:1,prob:2.975},{mult:2,prob:1.53},{mult:5,prob:0.578},{mult:10,prob:0.017}] }
    };
    let kabSelectedBug = null;
    let kabAnimating = false;
    let kabHistoryRows = [];

    function kabInit() {
        kabSelectedBug = null;
        kabAnimating = false;
        document.querySelectorAll('.kab-bug-card').forEach(c => c.classList.remove('kab-active'));
        document.getElementById('kabArenaIdle').classList.remove('hidden');
        document.getElementById('kabArenaLive').classList.add('hidden');
        document.getElementById('kabArenaKill').classList.add('hidden');
        document.getElementById('kabArenaElim').classList.add('hidden');
        document.getElementById('kabTokensArea').classList.add('hidden');
        document.getElementById('kabKillBtn').disabled = true;
        const arena = document.getElementById('kabArena');
        arena.style.borderColor = '';
        arena.style.boxShadow = '';
    }

    function kabSelectBug(bugKey) {
        if (kabAnimating) return;
        kabSelectedBug = bugKey;
        const bug = KAB_BUGS[bugKey];
        document.querySelectorAll('.kab-bug-card').forEach(c => c.classList.remove('kab-active'));
        document.querySelector(`.kab-bug-card[data-bug="${bugKey}"]`).classList.add('kab-active');
        document.getElementById('kabArenaIdle').classList.add('hidden');
        document.getElementById('kabArenaKill').classList.add('hidden');
        document.getElementById('kabArenaLive').classList.remove('hidden');
        document.getElementById('kabArenaBug').innerHTML = `<img src="${bug.imgSrc}" style="width:72px;height:72px;object-fit:contain;">`;
        document.getElementById('kabArenaBugName').textContent = bug.name;
        document.getElementById('kabArenaBugName').style.color = bug.color;
        const arena = document.getElementById('kabArena');
        arena.style.borderColor = bug.color + '44';
        arena.style.boxShadow = `0 0 24px ${bug.color}15`;
        document.getElementById('kabMinBet').innerHTML = `Min: <span>${bug.minBet}</span> ‚≠ê`;
        const betVal = parseFloat(document.getElementById('kabBetInput').value);
        if (betVal < bug.minBet) document.getElementById('kabBetInput').value = bug.minBet;
        document.getElementById('kabKillBtn').disabled = false;
        document.getElementById('kabTokensArea').classList.add('hidden');
        document.getElementById('kabError').classList.remove('visible');
    }

    function kabMultBet(f) {
        const inp = document.getElementById('kabBetInput');
        let v = Math.round((parseFloat(inp.value) || 0) * f);
        if (v < 1) v = 1;
        if (v > userData.chips) v = userData.chips;
        inp.value = v;
    }

    function kabMaxBet() { document.getElementById('kabBetInput').value = userData.chips; }

    function kabWeightedRandom(weights) {
        const total = weights.reduce((s,w) => s+w.prob, 0);
        let r = Math.random() * total;
        for (const w of weights) { r -= w.prob; if (r <= 0) return w.mult; }
        return weights[weights.length-1].mult;
    }

    function kabTokenColor(m) {
        if (m === 0)  return '#2c2c2c';  // dark grey - dead token
        if (m >= 10) return '#f1c40f';   // gold - ultra rare
        if (m >= 5)  return '#e67e22';   // deep orange - rare
        if (m >= 2)  return '#ff9900';   // orange - uncommon
        if (m >= 1)  return '#ff9900';   // orange
        return '#cc6600';                // dark orange - most common losses
    }

    async function kabKill() {
        if (!kabSelectedBug || kabAnimating) return;
        const bug = KAB_BUGS[kabSelectedBug];
        const betRaw = parseFloat(document.getElementById('kabBetInput').value);
        const errEl = document.getElementById('kabError');
        errEl.classList.remove('visible');
        if (isNaN(betRaw) || betRaw < bug.minBet) {
            errEl.textContent = `Minimum bet for ${bug.label} is ${bug.minBet} ‚≠ê`;
            errEl.classList.add('visible'); return;
        }
        if (betRaw > userData.chips) {
            errEl.textContent = `Not enough chips.`;
            errEl.classList.add('visible'); return;
        }
        const bet = Math.floor(betRaw);
        kabAnimating = true;
        document.getElementById('kabKillBtn').disabled = true;
        document.getElementById('kabTokensArea').classList.add('hidden');

        // Deduct bet immediately
        userData.chips -= bet;
        addProfit('killabug', -bet);
        updateUI();

        // Hide live, show suspense pause
        document.getElementById('kabArenaLive').classList.add('hidden');
        document.getElementById('kabArenaIdle').classList.add('hidden');
        document.getElementById('kabArenaElim').classList.add('hidden');

        // ‚îÄ‚îÄ ELIMINATION CHECK ‚îÄ‚îÄ
        const gotEliminated = Math.random() < bug.elimChance;

        if (gotEliminated) {
            // Show the bug striking back
            document.getElementById('kabArenaElim').classList.remove('hidden');
            document.getElementById('kabElimEmoji').innerHTML = `<img src="${bug.imgSrc}" style="width:64px;height:64px;object-fit:contain;">`;
            document.getElementById('kabElimSub').textContent = `${bug.label} fought back ‚Äî bet lost!`;

            // Flash arena red
            const arena = document.getElementById('kabArena');
            arena.style.borderColor = '#e74c3c';
            arena.style.boxShadow = '0 0 30px rgba(231,76,60,0.4)';

            // Show loss result banner
            await new Promise(r => setTimeout(r, 900));
            const area = document.getElementById('kabTokensArea');
            area.classList.remove('hidden');
            document.getElementById('kabTokensGrid').innerHTML = `<div style="color:#e74c3c;font-size:13px;letter-spacing:2px;padding:8px 0;">‚ö†Ô∏è THE BUG ELIMINATED YOU ‚Äî NO TOKENS</div>`;
            document.getElementById('kabTokensTotal').innerHTML = `Total multiplier: <span style="color:#e74c3c">0√ó</span>`;
            const banner = document.getElementById('kabResultBanner');
            banner.className = 'kab-result-banner kab-loss';
            document.getElementById('kabResultLabel').textContent = '‚ò†Ô∏è ELIMINATED';
            document.getElementById('kabResultAmount').textContent = `-${bet.toLocaleString()}`;
            document.getElementById('kabResultMult').innerHTML = `<span>${bug.label}</span> eliminated you ‚Äî full bet lost`;
            document.getElementById('kabNewBalance').textContent = userData.chips.toLocaleString();

            // History row
            kabHistoryRows.unshift({bug, bet, totalMult: 0, reward: 0, bal: userData.chips, isWin: false, eliminated: true});
            if (kabHistoryRows.length > 20) kabHistoryRows.pop();
            document.getElementById('kabHistoryBody').innerHTML = kabHistoryRows.map(row =>
                `<tr><td><img src="${row.bug.imgSrc}" style="width:28px;height:28px;object-fit:contain;">${row.eliminated ? '‚öîÔ∏è' : ''}</td><td style="font-family:monospace;font-size:12px">${row.bet.toLocaleString()}</td><td class="kab-col-mult">${row.totalMult.toFixed(2)}√ó</td><td class="${row.isWin?'kab-col-win':'kab-col-loss'}">${row.eliminated ? '‚ò†Ô∏è ELIM' : '+'+row.reward.toLocaleString()}</td><td style="font-family:monospace;font-size:12px;color:#555">${row.bal.toLocaleString()}</td></tr>`
            ).join('');

            await new Promise(r => setTimeout(r, 700));
            document.getElementById('kabKillBtn').disabled = false;
            kabAnimating = false;
            // Reset arena border to bug color
            arena.style.borderColor = bug.color + '44';
            arena.style.boxShadow = `0 0 24px ${bug.color}15`;
            document.getElementById('kabArenaElim').classList.add('hidden');
            document.getElementById('kabArenaLive').classList.remove('hidden');
            return;
        }

        // ‚îÄ‚îÄ NORMAL KILL FLOW ‚îÄ‚îÄ
        document.getElementById('kabArenaKill').classList.remove('hidden');
        await new Promise(r => setTimeout(r, 700));

        const tokens = [];
        for (let i = 0; i < bug.tokens; i++) tokens.push(kabWeightedRandom(bug.weights));
        const totalMult = tokens.reduce((s,m) => s+m, 0);
        const reward = parseFloat((totalMult * bet).toFixed(2));
        const isWin = reward >= bet;
        const area = document.getElementById('kabTokensArea');
        const grid = document.getElementById('kabTokensGrid');
        area.classList.remove('hidden');
        grid.innerHTML = '';
        for (let i = 0; i < tokens.length; i++) {
            await new Promise(r => setTimeout(r, 80));
            const m = tokens[i];
            const color = kabTokenColor(m);
            const tok = document.createElement('div');
            tok.className = 'kab-token';
            tok.style.setProperty('--kab-tok-color', color);
            tok.innerHTML = `<div class="tok-mult">${m}√ó</div><div class="tok-label">TOKEN</div>`;
            grid.appendChild(tok);
        }
        await new Promise(r => setTimeout(r, 200));
        document.getElementById('kabTokensTotal').innerHTML = `Total multiplier: <span>${totalMult.toFixed(2)}√ó</span>`;
        const banner = document.getElementById('kabResultBanner');
        banner.className = `kab-result-banner ${isWin ? 'kab-win' : 'kab-loss'}`;
        document.getElementById('kabResultLabel').textContent = isWin ? 'üéâ REWARD' : 'üí∏ REWARD';
        document.getElementById('kabResultAmount').textContent = `+${reward.toLocaleString()}`;
        document.getElementById('kabResultMult').innerHTML = `<span>${totalMult.toFixed(2)}√ó</span> on <span>${bet.toLocaleString()}</span> bet`;
        userData.chips += reward;
        addProfit('killabug', reward);
        updateUI();
        document.getElementById('kabNewBalance').textContent = userData.chips.toLocaleString();

        // History
        kabHistoryRows.unshift({bug, bet, totalMult, reward, bal: userData.chips, isWin, eliminated: false});
        if (kabHistoryRows.length > 20) kabHistoryRows.pop();
        document.getElementById('kabHistoryBody').innerHTML = kabHistoryRows.map(row =>
            `<tr><td><img src="${row.bug.imgSrc}" style="width:28px;height:28px;object-fit:contain;">${row.eliminated ? '‚öîÔ∏è' : ''}</td><td style="font-family:monospace;font-size:12px">${row.bet.toLocaleString()}</td><td class="kab-col-mult">${row.totalMult.toFixed(2)}√ó</td><td class="${row.isWin?'kab-col-win':'kab-col-loss'}">${row.eliminated ? '‚ò†Ô∏è ELIM' : '+'+row.reward.toLocaleString()}</td><td style="font-family:monospace;font-size:12px;color:#555">${row.bal.toLocaleString()}</td></tr>`
        ).join('');

        await new Promise(r => setTimeout(r, 600));
        document.getElementById('kabKillBtn').disabled = false;
        kabAnimating = false;
        document.getElementById('kabArenaKill').classList.add('hidden');
        document.getElementById('kabArenaLive').classList.remove('hidden');
    }</script>

    <!-- KILL A BUG GAME WITH CUSTOM IMAGES -->
    <script>
    const bugTargets = {
        ladybug: { name: 'Ladybug', imageBase64: "data:image/png;base64,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", difficulty: 'EASY', tokens: 5, minBet: 50, elimChance: 0.20, zeroTokenChance: 0.05, color: '#ff6b6b' },
        spider: { name: 'Spider', imageBase64: "data:image/png;base64,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", difficulty: 'MEDIUM', tokens: 7, minBet: 100, elimChance: 0.40, zeroTokenChance: 0.10, color: '#9d7fff' },
        kingBeetle: { name: 'King Beetle', imageBase64: "data:image/png;base64,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", difficulty: 'HARD', tokens: 10, minBet: 300, elimChance: 0.60, zeroTokenChance: 0.15, color: '#ffa500' }
    };

    let bugGameState = {
        selectedTarget: null,
        isPlaying: false,
        bugWillAppear: true,
        clickCount: 0,
        bugClicked: false
    };

    function bugShowTargetSelect() {
        document.getElementById('main-content').innerHTML = `
            <div style="padding: 40px; max-width: 1200px; margin: 0 auto;">
                <button onclick="navHome()" style="background: #333; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-bottom: 30px; font-weight: bold;">‚Üê Back</button>
                
                <h1 style="color: white; font-size: 32px; margin-bottom: 40px; text-align: center;">CHOOSE YOUR TARGET</h1>
                
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin-bottom: 40px;">
                    <!-- LADYBUG -->
                    <div style="background: #1a1a1a; border: 2px solid #333; border-radius: 20px; padding: 30px; text-align: center; cursor: pointer; transition: 0.3s;" 
                         onmouseover="this.style.borderColor='#ff6b6b'; this.style.transform='translateY(-5px)';" 
                         onmouseout="this.style.borderColor='#333'; this.style.transform='translateY(0)';"
                         onclick="bugStartGame('ladybug')">
                        <svg width="80" height="80" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" style="margin-bottom:15px;">
                            <ellipse cx="50" cy="60" rx="25" ry="30" fill="#ff6b6b" opacity="0.8"/>
                            <circle cx="50" cy="40" r="15" fill="#ff6b6b"/>
                            <circle cx="42" cy="37" r="3" fill="black"/>
                            <circle cx="58" cy="37" r="3" fill="black"/>
                            <path d="M45 50 Q50 55 55 50" stroke="black" stroke-width="1.5" fill="none"/>
                            <ellipse cx="30" cy="65" rx="6" ry="10" fill="#ff6b6b"/>
                            <ellipse cx="70" cy="65" rx="6" ry="10" fill="#ff6b6b"/>
                            <path d="M35 50 L25 48" stroke="#ff6b6b" stroke-width="2"/>
                            <path d="M65 50 L75 48" stroke="#ff6b6b" stroke-width="2"/>
                        </svg>
                        <div style="background: #ff6b6b; color: black; padding: 6px 14px; border-radius: 5px; display: inline-block; font-weight: bold; margin-bottom: 15px; font-size: 12px;">EASY</div>
                        <h2 style="color: #ff6b6b; font-size: 28px; margin: 10px 0;">Ladybug</h2>
                        <p style="color: white; font-size: 16px; margin: 10px 0;"><strong>5</strong> tokens/kill</p>
                        <p style="color: #aaa; font-size: 14px;">Min bet: <strong>50</strong> ‚≠ê</p>
                        <p style="color: #ff6b6b; font-size: 13px; margin-top: 15px;"><strong>20%</strong> elim ‚Ä¢ <strong>5%</strong> zero token</p>
                    </div>

                    <!-- SPIDER -->
                    <div style="background: #1a1a1a; border: 2px solid #333; border-radius: 20px; padding: 30px; text-align: center; cursor: pointer; transition: 0.3s;" 
                         onmouseover="this.style.borderColor='#9d7fff'; this.style.transform='translateY(-5px)';" 
                         onmouseout="this.style.borderColor='#333'; this.style.transform='translateY(0)';"
                         onclick="bugStartGame('spider')">
                        <svg width="80" height="80" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" style="margin-bottom:15px;">
                            <ellipse cx="50" cy="50" rx="16" ry="20" fill="#9d7fff" opacity="0.8"/>
                            <circle cx="50" cy="35" r="10" fill="#9d7fff"/>
                            <circle cx="46" cy="33" r="2" fill="black"/>
                            <circle cx="54" cy="33" r="2" fill="black"/>
                            <line x1="25" y1="45" x2="10" y2="30" stroke="#9d7fff" stroke-width="2.5"/>
                            <line x1="25" y1="55" x2="10" y2="70" stroke="#9d7fff" stroke-width="2.5"/>
                            <line x1="75" y1="45" x2="90" y2="30" stroke="#9d7fff" stroke-width="2.5"/>
                            <line x1="75" y1="55" x2="90" y2="70" stroke="#9d7fff" stroke-width="2.5"/>
                            <line x1="30" y1="68" x2="20" y2="85" stroke="#9d7fff" stroke-width="2"/>
                            <line x1="70" y1="68" x2="80" y2="85" stroke="#9d7fff" stroke-width="2"/>
                            <circle cx="10" cy="30" r="2.5" fill="#9d7fff"/>
                            <circle cx="90" cy="30" r="2.5" fill="#9d7fff"/>
                        </svg>
                        <div style="background: #9d7fff; color: black; padding: 6px 14px; border-radius: 5px; display: inline-block; font-weight: bold; margin-bottom: 15px; font-size: 12px;">MEDIUM</div>
                        <h2 style="color: #9d7fff; font-size: 28px; margin: 10px 0;">Spider</h2>
                        <p style="color: white; font-size: 16px; margin: 10px 0;"><strong>7</strong> tokens/kill</p>
                        <p style="color: #aaa; font-size: 14px;">Min bet: <strong>100</strong> ‚≠ê</p>
                        <p style="color: #9d7fff; font-size: 13px; margin-top: 15px;"><strong>40%</strong> elim ‚Ä¢ <strong>10%</strong> zero token</p>
                    </div>

                    <!-- KING BEETLE -->
                    <div style="background: #1a1a1a; border: 2px solid #333; border-radius: 20px; padding: 30px; text-align: center; cursor: pointer; transition: 0.3s;" 
                         onmouseover="this.style.borderColor='#ffa500'; this.style.transform='translateY(-5px)';" 
                         onmouseout="this.style.borderColor='#333'; this.style.transform='translateY(0)';"
                         onclick="bugStartGame('kingBeetle')">
                        <svg width="80" height="80" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" style="margin-bottom:15px;">
                            <ellipse cx="50" cy="65" rx="28" ry="22" fill="#ffa500" opacity="0.8"/>
                            <ellipse cx="50" cy="40" rx="18" ry="20" fill="#ffa500"/>
                            <circle cx="50" cy="25" r="12" fill="#ff8c00"/>
                            <circle cx="45" cy="23" r="2.5" fill="black"/>
                            <circle cx="55" cy="23" r="2.5" fill="black"/>
                            <path d="M40 35 L30 28 M60 35 L70 28" stroke="#ffa500" stroke-width="3" stroke-linecap="round"/>
                            <path d="M35 55 L20 60 M65 55 L80 60" stroke="#ffa500" stroke-width="2.5"/>
                            <path d="M38 75 L32 88 M62 75 L68 88" stroke="#ffa500" stroke-width="2.5"/>
                            <circle cx="50" cy="50" r="5" fill="#ff8c00"/>
                        </svg>
                        <div style="background: #ffa500; color: black; padding: 6px 14px; border-radius: 5px; display: inline-block; font-weight: bold; margin-bottom: 15px; font-size: 12px;">HARD</div>
                        <h2 style="color: #ffa500; font-size: 28px; margin: 10px 0;">King Beetle</h2>
                        <p style="color: white; font-size: 16px; margin: 10px 0;"><strong>10</strong> tokens/kill</p>
                        <p style="color: #aaa; font-size: 14px;">Min bet: <strong>300</strong> ‚≠ê</p>
                        <p style="color: #ffa500; font-size: 13px; margin-top: 15px;"><strong>60%</strong> elim ‚Ä¢ <strong>15%</strong> zero token</p>
                    </div>
                </div>
            </div>
        `;
    }

    function bugStartGame(targetKey) {
        bugGameState.selectedTarget = bugTargets[targetKey];
        bugGameState.isPlaying = true;
        bugGameState.clickCount = 0;
        bugGameState.bugClicked = false;
        
        bugGameState.bugWillAppear = Math.random() > bugGameState.selectedTarget.elimChance;
        
        document.getElementById('main-content').innerHTML = `
            <div style="padding: 40px; max-width: 900px; margin: 0 auto; text-align: center;">
                <button onclick="bugShowTargetSelect()" style="background: #333; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-bottom: 30px; font-weight: bold;">‚Üê Back</button>
                
                <div style="background: #1a1a1a; border: 2px solid ${bugGameState.selectedTarget.color}; border-radius: 15px; padding: 40px; margin-bottom: 30px;">
                    <h2 style="color: ${bugGameState.selectedTarget.color}; font-size: 24px; margin-bottom: 20px;">${bugGameState.selectedTarget.name.toUpperCase()}</h2>
                    <p style="color: #aaa; font-size: 14px; margin-bottom: 15px;">Reward: <strong style="color: white;">${bugGameState.selectedTarget.tokens} tokens</strong></p>
                    <p style="color: #aaa; font-size: 14px;">Elimination chance: <strong style="color: white;">${(bugGameState.selectedTarget.elimChance * 100).toFixed(0)}%</strong></p>
                </div>

                <div id="bugArena" style="background: #0a0a0a; border: 3px solid ${bugGameState.selectedTarget.color}; border-radius: 20px; height: 400px; position: relative; margin-bottom: 30px; display: flex; align-items: center; justify-content: center; overflow: hidden;">
                    ${bugGameState.bugWillAppear ? `
                        <img id="bugElement" src="${bugGameState.selectedTarget.imageBase64}" style="width:120px; height:120px; cursor: pointer; position: absolute; user-select: none; animation: bugFloat 3s ease-in-out infinite; object-fit:contain;" 
                             onclick="bugClick(event)">
                    ` : `
                        <div style="color: #666; font-size: 24px;">Bug eliminated... ‚úó</div>
                    `}
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                    <div style="background: #1a1a1a; border: 1px solid #333; border-radius: 10px; padding: 20px;">
                        <p style="color: #aaa; font-size: 12px;">Clicks</p>
                        <p style="color: white; font-size: 28px; font-weight: bold;" id="bugClickCount">0</p>
                    </div>
                    <div style="background: #1a1a1a; border: 1px solid #333; border-radius: 10px; padding: 20px;">
                        <p style="color: #aaa; font-size: 12px;">Status</p>
                        <p style="color: ${bugGameState.bugWillAppear ? 'var(--orange)' : '#ff6b6b'}; font-size: 16px; font-weight: bold;" id="bugStatus">${bugGameState.bugWillAppear ? 'üéØ ALIVE' : 'üíÄ ELIMINATED'}</p>
                    </div>
                </div>

                <button onclick="bugFinishGame()" style="background: var(--orange); color: black; border: none; padding: 12px 30px; border-radius: 8px; font-weight: 900; cursor: pointer; font-size: 16px;">Finish Game</button>
            </div>

            <style>
                @keyframes bugFloat {
                    0%, 100% { transform: translateY(0px) translateX(0px); }
                    25% { transform: translateY(-20px) translateX(10px); }
                    50% { transform: translateY(-30px) translateX(-15px); }
                    75% { transform: translateY(-10px) translateX(20px); }
                }
            </style>
        `;
    }

    function bugClick(event) {
        if (!bugGameState.isPlaying) return;
        
        bugGameState.clickCount++;
        document.getElementById('bugClickCount').textContent = bugGameState.clickCount;
        
        if (bugGameState.bugWillAppear) {
            bugGameState.bugClicked = true;
            document.getElementById('bugElement').style.animation = 'none';
            document.getElementById('bugElement').style.opacity = '0.5';
            document.getElementById('bugStatus').textContent = '‚úì KILLED';
            document.getElementById('bugStatus').style.color = 'var(--orange)';
        }
        
        event.stopPropagation();
    }

    function bugFinishGame() {
        bugGameState.isPlaying = false;
        
        const target = bugGameState.selectedTarget;
        let reward = 0;
        let result = '';
        
        if (!bugGameState.bugWillAppear) {
            reward = 0;
            result = 'üíÄ Bug was eliminated. No reward.';
        } else if (bugGameState.bugClicked) {
            if (Math.random() < target.zeroTokenChance) {
                reward = 0;
                result = '‚úì Bug killed! But... 0 tokens (unlucky)';
            } else {
                reward = target.tokens;
                result = `‚úì Bug killed! +${reward} tokens`;
            }
        } else {
            reward = 0;
            result = '‚úó Bug escaped. No reward.';
        }
        
        document.getElementById('main-content').innerHTML = `
            <div style="padding: 40px; max-width: 600px; margin: 0 auto; text-align: center;">
                <button onclick="bugShowTargetSelect()" style="background: #333; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-bottom: 30px; font-weight: bold;">‚Üê Back</button>
                
                <div style="background: #1a1a1a; border: 2px solid ${target.color}; border-radius: 20px; padding: 50px 30px; margin-bottom: 30px;">
                    <h2 style="color: ${target.color}; font-size: 32px; margin-bottom: 20px;">GAME OVER</h2>
                    <img src="${target.imageBase64}" style="width:70px; height:70px; object-fit:contain; margin: 20px 0;">
                    <p style="color: white; font-size: 20px; margin: 20px 0;">${result}</p>
                    <p style="color: #aaa; font-size: 14px;">Total clicks: ${bugGameState.clickCount}</p>
                </div>

                <div style="background: #1a1a1a; border: 1px solid #333; border-radius: 15px; padding: 30px; margin-bottom: 30px;">
                    <p style="color: #aaa; font-size: 12px; margin-bottom: 10px;">REWARD</p>
                    <p style="color: var(--orange); font-size: 36px; font-weight: bold;">${reward > 0 ? '+' : ''}${reward} ü™ô</p>
                </div>

                <button onclick="bugShowTargetSelect()" style="background: var(--orange); color: black; border: none; padding: 12px 30px; border-radius: 8px; font-weight: 900; cursor: pointer; font-size: 16px; margin-right: 10px;">Play Again</button>
                <button onclick="navHome()" style="background: #333; color: white; border: none; padding: 12px 30px; border-radius: 8px; font-weight: 900; cursor: pointer; font-size: 16px;">Home</button>
            </div>
        `;
    }
    </script>

    <!-- SVG Icon Generators -->
    <script>
        // SVG Icons for games
        const svgIcons = {
            mines: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="45" fill="none" stroke="#ff9900" stroke-width="2"/>
                <circle cx="30" cy="35" r="8" fill="#ff9900"/>
                <circle cx="50" cy="25" r="8" fill="#ff9900"/>
                <circle cx="70" cy="35" r="8" fill="#ff9900"/>
                <circle cx="35" cy="60" r="8" fill="#27ae60"/>
                <circle cx="65" cy="60" r="8" fill="#27ae60"/>
                <circle cx="50" cy="75" r="8" fill="#e74c3c"/>
                <line x1="50" y1="30" x2="50" y2="70" stroke="#888" stroke-width="1" stroke-dasharray="2,2"/>
                <line x1="20" y1="50" x2="80" y2="50" stroke="#888" stroke-width="1" stroke-dasharray="2,2"/>
            </svg>`,
            crash: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <path d="M 10 80 Q 30 20, 50 30 T 90 80" fill="none" stroke="#ff9900" stroke-width="3" stroke-linecap="round"/>
                <circle cx="50" cy="30" r="6" fill="#ff9900"/>
                <polygon points="60,75 65,85 70,75" fill="#e74c3c"/>
                <line x1="10" y1="85" x2="90" y2="85" stroke="#666" stroke-width="2"/>
                <text x="50" y="50" font-size="20" fill="#888" text-anchor="middle">üìà</text>
            </svg>`,
            plinko: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <rect x="15" y="10" width="70" height="75" fill="none" stroke="#ff9900" stroke-width="2" rx="5"/>
                <circle cx="30" cy="30" r="4" fill="#666"/>
                <circle cx="50" cy="30" r="4" fill="#666"/>
                <circle cx="70" cy="30" r="4" fill="#666"/>
                <circle cx="20" cy="50" r="4" fill="#666"/>
                <circle cx="40" cy="50" r="4" fill="#666"/>
                <circle cx="60" cy="50" r="4" fill="#666"/>
                <circle cx="80" cy="50" r="4" fill="#666"/>
                <circle cx="50" cy="15" r="5" fill="#ff9900"/>
                <path d="M 30 75 L 40 85" stroke="#27ae60" stroke-width="2"/>
                <path d="M 50 75 L 50 85" stroke="#27ae60" stroke-width="2"/>
                <path d="M 70 75 L 60 85" stroke="#27ae60" stroke-width="2"/>
            </svg>`,
            dragon: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <ellipse cx="50" cy="50" rx="35" ry="40" fill="none" stroke="#ff9900" stroke-width="2"/>
                <circle cx="35" cy="40" r="5" fill="#ff9900"/>
                <circle cx="65" cy="40" r="5" fill="#ff9900"/>
                <path d="M 50 55 L 45 65 L 50 68 L 55 65 Z" fill="#ff9900"/>
                <path d="M 30 50 L 20 45 L 25 50 L 20 55 Z" fill="#f1c40f"/>
                <path d="M 70 50 L 80 45 L 75 50 L 80 55 Z" fill="#f1c40f"/>
                <line x1="45" y1="35" x2="40" y2="25" stroke="#ff9900" stroke-width="2"/>
                <line x1="55" y1="35" x2="60" y2="25" stroke="#ff9900" stroke-width="2"/>
            </svg>`,
            dice: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <rect x="20" y="20" width="60" height="60" fill="none" stroke="#ff9900" stroke-width="2" rx="4"/>
                <circle cx="35" cy="35" r="3" fill="#ff9900"/>
                <circle cx="50" cy="50" r="3" fill="#ff9900"/>
                <circle cx="65" cy="65" r="3" fill="#ff9900"/>
                <circle cx="35" cy="65" r="3" fill="#ff9900"/>
                <circle cx="65" cy="35" r="3" fill="#ff9900"/>
                <path d="M 20 20 L 35 35" stroke="#666" stroke-width="1" stroke-dasharray="2,2"/>
                <path d="M 80 80 L 65 65" stroke="#666" stroke-width="1" stroke-dasharray="2,2"/>
            </svg>`,
            limbo: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <path d="M 10 60 Q 30 30, 50 40 T 90 60" fill="none" stroke="#ff9900" stroke-width="3" stroke-linecap="round"/>
                <circle cx="50" cy="40" r="6" fill="#f1c40f"/>
                <line x1="50" y1="40" x2="50" y2="60" stroke="#888" stroke-width="1" stroke-dasharray="2,2"/>
                <rect x="10" y="60" width="80" height="3" fill="#666"/>
                <text x="50" y="85" font-size="14" fill="#888" text-anchor="middle">HOW LOW</text>
            </svg>`,
            wheel: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="40" fill="none" stroke="#ff9900" stroke-width="2"/>
                <circle cx="50" cy="50" r="35" fill="none" stroke="#ff9900" stroke-width="1" stroke-dasharray="3,2"/>
                <line x1="50" y1="50" x2="50" y2="12" stroke="#ff9900" stroke-width="2"/>
                <line x1="50" y1="50" x2="82" y2="68" stroke="#27ae60" stroke-width="2"/>
                <line x1="50" y1="50" x2="30" y2="75" stroke="#e74c3c" stroke-width="2"/>
                <circle cx="50" cy="50" r="4" fill="#ff9900"/>
                <polygon points="50,8 47,15 53,15" fill="#ff9900"/>
            </svg>`,
            roulette: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="42" fill="none" stroke="#ff9900" stroke-width="2"/>
                <circle cx="50" cy="50" r="38" fill="none" stroke="#ff9900" stroke-width="1"/>
                <circle cx="50" cy="50" r="8" fill="#ff9900"/>
                <circle cx="50" cy="15" r="4" fill="#e74c3c"/>
                <circle cx="78" cy="50" r="4" fill="#27ae60"/>
                <circle cx="50" cy="85" r="4" fill="#e74c3c"/>
                <circle cx="22" cy="50" r="4" fill="#27ae60"/>
                <line x1="50" y1="50" x2="50" y2="15" stroke="#666" stroke-width="1"/>
            </svg>`,
            tower: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <rect x="25" y="15" width="50" height="70" fill="none" stroke="#ff9900" stroke-width="2" rx="3"/>
                <line x1="30" y1="30" x2="70" y2="30" stroke="#888" stroke-width="1"/>
                <line x1="30" y1="45" x2="70" y2="45" stroke="#888" stroke-width="1"/>
                <line x1="30" y1="60" x2="70" y2="60" stroke="#888" stroke-width="1"/>
                <line x1="30" y1="75" x2="70" y2="75" stroke="#888" stroke-width="1"/>
                <circle cx="50" cy="22" r="5" fill="#f1c40f"/>
                <polygon points="45,80 50,88 55,80" fill="#ff9900"/>
            </svg>`,
            bug: `<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <ellipse cx="50" cy="55" rx="20" ry="25" fill="none" stroke="#e74c3c" stroke-width="2"/>
                <circle cx="50" cy="35" r="12" fill="none" stroke="#e74c3c" stroke-width="2"/>
                <circle cx="45" cy="32" r="3" fill="#e74c3c"/>
                <circle cx="55" cy="32" r="3" fill="#e74c3c"/>
                <line x1="30" y1="50" x2="15" y2="40" stroke="#e74c3c" stroke-width="2"/>
                <line x1="70" y1="50" x2="85" y2="40" stroke="#e74c3c" stroke-width="2"/>
                <line x1="30" y1="55" x2="10" y2="55" stroke="#e74c3c" stroke-width="2"/>
                <line x1="70" y1="55" x2="90" y2="55" stroke="#e74c3c" stroke-width="2"/>
                <line x1="30" y1="60" x2="15" y2="70" stroke="#e74c3c" stroke-width="2"/>
                <line x1="70" y1="60" x2="85" y2="70" stroke="#e74c3c" stroke-width="2"/>
            </svg>`
        };

        // Function to render SVG icon
        function getSvgIcon(gameName) {
            return svgIcons[gameName] || svgIcons.dice;
        }
    </script>

    <div id="tc-modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.88); z-index:9999; justify-content:center; align-items:center;"> style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.88); z-index:9999; justify-content:center; align-items:center;">
        <div style="background:#1a1a1a; border:1px solid #2a2a2a; border-radius:10px; width:90vw; max-width:860px; height:85vh; display:flex; flex-direction:column; overflow:hidden; box-shadow:0 8px 40px rgba(0,0,0,0.8);">
            <div style="display:flex; justify-content:space-between; align-items:center; padding:14px 20px; border-bottom:1px solid #2a2a2a;">
                <span style="color:#888; font-weight:600; font-size:14px;">Terms &amp; Conditions</span>
                <button onclick="document.getElementById('tc-modal').style.display='none'" style="background:none; border:none; color:#555; font-size:20px; cursor:pointer; line-height:1; padding:0 4px;">&#x2715;</button>
            </div>
            <iframe src="assets/asset_pdf_001.pdf" style="flex:1; border:none; width:100%; background:#fff;" type="application/pdf"></iframe>
        </div>
    </div>
<!-- Toast container -->
<div id="toast-container"></div>

<!-- Anticheat warning -->
<div id="ac-warning">
    <h1>‚ö†Ô∏è Cheat Detected</h1>
    <p>Unauthorized modification of game data was detected. Your session has been locked.<br><br>If you believe this is a mistake, please reload the page.</p>
    <button onclick="location.reload()" style="margin-top:24px;background:#e74c3c;border:none;color:white;padding:12px 28px;border-radius:8px;font-size:15px;font-weight:900;cursor:pointer;">Reload</button>
</div>

<!-- Floating Provably Fair Button -->
<div class="pf-float-btn hidden" id="pf-float-btn" onclick="pfOpen()">
    <span class="pf-float-dot"></span>
    <span class="pf-float-shield">‚¨°</span>
    <span class="pf-float-label">Provably Fair</span>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PROVABLY FAIR MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="pf-overlay" class="pf-overlay" onclick="pfOverlayClick(event)">
  <div class="pf-modal">
    <div class="pf-header">
      <span class="pf-shield">‚¨°</span>
      <span class="pf-title">Provably Fair</span>
      <button class="pf-close" onclick="pfClose()">‚úï</button>
    </div>
    <div class="pf-tabs">
      <button class="pf-tab active" id="pftab-seeds" onclick="pfTab('seeds')">Seeds</button>
      <button class="pf-tab" id="pftab-verify" onclick="pfTab('verify')">Verify</button>
      <button class="pf-tab" id="pftab-history" onclick="pfTab('history')">History</button>
    </div>

    <!-- SEEDS -->
    <div id="pfpanel-seeds" class="pf-panel">
      <div class="pf-section">
        <span class="pf-label">Server Seed (Hashed)</span>
        <p class="pf-hint">The server seed is hidden until you rotate. Only the SHA-256 hash is shown to you.</p>
        <div class="pf-hash-box">
          <span class="pf-hash-text" id="pf-hash-display">Generating‚Ä¶</span>
          <button class="pf-copy-btn" onclick="pfCopy(pfState.serverSeedHash,'hash')">‚ßâ</button>
        </div>
        <div class="pf-nonce-row">
          <span class="pf-nonce-label">Active Nonce</span>
          <span class="pf-nonce-badge" id="pf-nonce-display">0</span>
        </div>
        <button class="pf-btn" id="pf-rotate-btn" onclick="pfRotate()">‚ü≥ Rotate Server Seed</button>
      </div>
      <div class="pf-divider"></div>
      <div class="pf-section">
        <span class="pf-label">Client Seed</span>
        <p class="pf-hint">You control this seed. Change it any time before playing.</p>
        <div class="pf-input-row">
          <input class="pf-input" id="pf-client-input" placeholder="client seed‚Ä¶" />
          <button class="pf-icon-btn" onclick="pfRandomizeClient()" title="Randomize">‚ü≥</button>
        </div>
        <button class="pf-btn-green" onclick="pfUpdateClient()">‚úì Update Client Seed</button>
      </div>
      <div id="pf-result-area"></div>
      <div id="pf-reveal-area"></div>
    </div>

    <!-- VERIFY -->
    <div id="pfpanel-verify" class="pf-panel" style="display:none">
      <div class="pf-section">
        <span class="pf-label">Verify a Past Result</span>
        <p class="pf-hint">After rotating seeds the old server seed is revealed. Enter it along with the client seed and nonce to reproduce any bet.</p>
        <span class="pf-label" style="font-size:10px;">Revealed Server Seed</span>
        <input class="pf-input" id="pfv-seed" placeholder="Enter revealed server seed‚Ä¶"/>
        <span class="pf-label" style="font-size:10px;">Client Seed</span>
        <input class="pf-input" id="pfv-client" placeholder="Enter client seed‚Ä¶"/>
        <span class="pf-label" style="font-size:10px;">Nonce</span>
        <input class="pf-input" id="pfv-nonce" placeholder="0" type="number"/>
        <button class="pf-btn-green" onclick="pfVerify()">‚úì Verify</button>
        <div id="pfv-result"></div>
      </div>
    </div>

    <!-- HISTORY -->
    <div id="pfpanel-history" class="pf-panel" style="display:none">
      <span class="pf-label">Roll History (last 30)</span>
      <div id="pf-history-list" style="max-height:380px;overflow-y:auto;"></div>
    </div>

    <div class="pf-footer">
      <span class="pf-footer-code">HMAC_SHA256(server_seed, client_seed:nonce)</span>
    </div>
  </div>
</div>

</body>
</html>
